============================= test session starts =============================
platform win32 -- Python 3.11.13, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\ASUS\anaconda3\envs\emailops\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\ASUS\Downloads\emailops_vertex_ai
configfile: pytest.ini
plugins: anyio-4.11.0, cov-7.0.0
collecting ... collected 517 items

tests/integration/test_core_workflows.py::TestDocumentProcessingWorkflow::test_configuration_workflow PASSED [  0%]
tests/integration/test_core_workflows.py::TestDocumentProcessingWorkflow::test_document_processing_workflow FAILED [  0%]
tests/integration/test_core_workflows.py::TestDocumentProcessingWorkflow::test_error_recovery_workflow FAILED [  0%]
tests/integration/test_core_workflows.py::TestEmbeddingWorkflow::test_embedding_batch_processing FAILED [  0%]
tests/integration/test_core_workflows.py::TestEmbeddingWorkflow::test_embedding_error_handling FAILED [  0%]
tests/integration/test_core_workflows.py::TestEmbeddingWorkflow::test_embedding_pipeline_openai FAILED [  1%]
tests/integration/test_core_workflows.py::TestEmbeddingWorkflow::test_embedding_pipeline_vertex FAILED [  1%]
tests/integration/test_core_workflows.py::TestSecurityWorkflow::test_command_validation_workflow FAILED [  1%]
tests/integration/test_core_workflows.py::TestSecurityWorkflow::test_environment_variable_workflow FAILED [  1%]
tests/integration/test_core_workflows.py::TestSecurityWorkflow::test_path_validation_workflow FAILED [  1%]
tests/integration/test_core_workflows.py::TestIndexWorkflow::test_index_creation_workflow FAILED [  2%]
tests/integration/test_core_workflows.py::TestIndexWorkflow::test_index_repair_workflow FAILED [  2%]
tests/integration/test_core_workflows.py::TestMonitoringWorkflow::test_diagnostics_workflow FAILED [  2%]
tests/integration/test_core_workflows.py::TestMonitoringWorkflow::test_index_monitoring_workflow FAILED [  2%]
tests/integration/test_core_workflows.py::TestMonitoringWorkflow::test_statistics_workflow FAILED [  2%]
tests/integration/test_core_workflows.py::TestEmailProcessingWorkflow::test_conversation_loading_workflow FAILED [  3%]
tests/integration/test_core_workflows.py::TestEmailProcessingWorkflow::test_email_parsing_workflow PASSED [  3%]
tests/integration/test_core_workflows.py::TestEndToEndWorkflow::test_complete_pipeline FAILED [  3%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingGeneration::test_embed_texts_with_mock_provider PASSED [  3%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingGeneration::test_embed_empty_list_returns_empty_array PASSED [  3%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingGeneration::test_embed_single_text_returns_single_embedding PASSED [  4%]
tests/integration/test_embedding_pipeline.py::TestBatchProcessing::test_batch_processing_maintains_order PASSED [  4%]
tests/integration/test_embedding_pipeline.py::TestBatchProcessing::test_large_batch_processing PASSED [  4%]
tests/integration/test_embedding_pipeline.py::TestBatchProcessing::test_batch_processing_with_various_lengths PASSED [  4%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingQuality::test_embeddings_are_deterministic_with_same_input PASSED [  4%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingQuality::test_embeddings_have_no_nan_or_inf PASSED [  5%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingQuality::test_embedding_vectors_are_not_zero PASSED [  5%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingErrorHandling::test_handles_special_characters PASSED [  5%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingErrorHandling::test_handles_very_long_text PASSED [  5%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingErrorHandling::test_handles_empty_strings PASSED [  5%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingIndexIntegration::test_embeddings_align_with_chunks PASSED [  5%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingIndexIntegration::test_embedding_dimensions_match_metadata PASSED [  6%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingPerformance::test_process_many_texts_efficiently PASSED [  6%]
tests/integration/test_embedding_pipeline.py::TestProviderBehavior::test_vertex_provider_initialization PASSED [  6%]
tests/integration/test_embedding_pipeline.py::TestProviderBehavior::test_provider_fallback_behavior PASSED [  6%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingDataFlow::test_complete_data_flow_chunks_to_embeddings PASSED [  6%]
tests/integration/test_embedding_pipeline.py::TestEmbeddingDataFlow::test_embedding_metadata_consistency PASSED [  7%]
tests/integration/test_index_workflow.py::TestIndexCreationWorkflow::test_create_index_from_documents_to_final_index PASSED [  7%]
tests/integration/test_index_workflow.py::TestIndexCreationWorkflow::test_index_alignment_verification_workflow PASSED [  7%]
tests/integration/test_index_workflow.py::TestIndexCreationWorkflow::test_index_recovery_from_partial_state PASSED [  7%]
tests/integration/test_index_workflow.py::TestMultiDocumentIndexing::test_index_multiple_documents_maintains_consistency PASSED [  7%]
tests/integration/test_index_workflow.py::TestMultiDocumentIndexing::test_index_with_attachments_and_conversations PASSED [  8%]
tests/integration/test_index_workflow.py::TestIndexUpdateAndRepair::test_append_new_documents_to_existing_index PASSED [  8%]
tests/integration/test_index_workflow.py::TestIndexUpdateAndRepair::test_repair_corrupted_embeddings PASSED [  8%]
tests/integration/test_index_workflow.py::TestIndexPerformance::test_index_with_large_number_of_documents PASSED [  8%]
tests/integration/test_index_workflow.py::TestIndexErrorRecovery::test_recovery_from_incomplete_indexing PASSED [  8%]
tests/integration/test_index_workflow.py::TestIndexErrorRecovery::test_recovery_from_dimension_mismatch PASSED [  9%]
tests/integration/test_security_integration.py::TestEndToEndPathValidation::test_malicious_path_workflow PASSED [  9%]
tests/integration/test_security_integration.py::TestEndToEndPathValidation::test_safe_path_workflow PASSED [  9%]
tests/integration/test_security_integration.py::TestEndToEndPathValidation::test_symlink_security_workflow PASSED [  9%]
tests/integration/test_security_integration.py::TestEndToEndPathValidation::test_unicode_attack_prevention PASSED [  9%]
tests/integration/test_security_integration.py::TestCommandExecutionSecurity::test_command_injection_prevention_workflow PASSED [ 10%]
tests/integration/test_security_integration.py::TestCommandExecutionSecurity::test_whitelist_enforcement PASSED [ 10%]
tests/integration/test_security_integration.py::TestCommandExecutionSecurity::test_safe_command_execution PASSED [ 10%]
tests/integration/test_security_integration.py::TestCommandExecutionSecurity::test_environment_variable_injection_prevention PASSED [ 10%]
tests/integration/test_security_integration.py::TestConfigurationSecurity::test_credential_loading_security PASSED [ 10%]
tests/integration/test_security_integration.py::TestConfigurationSecurity::test_no_sensitive_data_in_logs PASSED [ 11%]
tests/integration/test_security_integration.py::TestConfigurationSecurity::test_secure_defaults PASSED [ 11%]
tests/integration/test_security_integration.py::TestConfigurationSecurity::test_environment_variable_precedence PASSED [ 11%]
tests/integration/test_security_integration.py::TestConfigurationSecurity::test_project_id_validation_integration PASSED [ 11%]
tests/integration/test_security_integration.py::TestSecurityWorkflowIntegration::test_file_processing_security_workflow PASSED [ 11%]
tests/integration/test_security_integration.py::TestSecurityWorkflowIntegration::test_configuration_initialization_security PASSED [ 11%]
tests/integration/test_security_integration.py::TestSecurityWorkflowIntegration::test_complete_security_validation_pipeline PASSED [ 12%]
tests/integration/test_security_integration.py::TestSecurityMonitoring::test_attack_pattern_detection PASSED [ 12%]
tests/integration/test_security_integration.py::TestSecurityMonitoring::test_logging_safety PASSED [ 12%]
tests/test_all_accounts_live.py::test_parallel_calls SKIPPED (GCP
credentials not available for testing)                                   [ 12%]
tests/unit/test_config.py::TestEmailOpsConfig::test_load_from_environment PASSED [ 12%]
tests/unit/test_config.py::TestEmailOpsConfig::test_default_values PASSED [ 13%]
tests/unit/test_config.py::TestEmailOpsConfig::test_invalid_type_conversions PASSED [ 13%]
tests/unit/test_config.py::TestEmailOpsConfig::test_valid_type_conversions PASSED [ 13%]
tests/unit/test_config.py::TestEmailOpsConfig::test_get_secrets_dir_absolute_path PASSED [ 13%]
tests/unit/test_config.py::TestEmailOpsConfig::test_get_secrets_dir_relative_to_cwd PASSED [ 13%]
tests/unit/test_config.py::TestEmailOpsConfig::test_get_secrets_dir_relative_to_package PASSED [ 14%]
tests/unit/test_config.py::TestEmailOpsConfig::test_get_secrets_dir_nonexistent PASSED [ 14%]
tests/unit/test_config.py::TestEmailOpsConfig::test_get_credential_file_from_env PASSED [ 14%]
tests/unit/test_config.py::TestEmailOpsConfig::test_get_credential_file_from_priority_list PASSED [ 14%]
tests/unit/test_config.py::TestEmailOpsConfig::test_get_credential_file_invalid_json PASSED [ 14%]
tests/unit/test_config.py::TestEmailOpsConfig::test_get_credential_file_missing_required_fields PASSED [ 15%]
tests/unit/test_config.py::TestEmailOpsConfig::test_get_credential_file_no_secrets_dir PASSED [ 15%]
tests/unit/test_config.py::TestEmailOpsConfig::test_credential_priority_order PASSED [ 15%]
tests/unit/test_config.py::TestEmailOpsConfig::test_update_environment PASSED [ 15%]
tests/unit/test_config.py::TestEmailOpsConfig::test_update_environment_no_gcp_project PASSED [ 15%]
tests/unit/test_config.py::TestEmailOpsConfig::test_update_environment_no_credentials PASSED [ 16%]
tests/unit/test_config.py::TestEmailOpsConfig::test_to_dict PASSED       [ 16%]
tests/unit/test_config.py::TestEmailOpsConfig::test_to_dict_with_none_values PASSED [ 16%]
tests/unit/test_config.py::TestEmailOpsConfig::test_allowed_file_patterns_default PASSED [ 16%]
tests/unit/test_config.py::TestEmailOpsConfig::test_credential_files_priority_default PASSED [ 16%]
tests/unit/test_config.py::TestSingletonPattern::test_get_config_returns_same_instance PASSED [ 17%]
tests/unit/test_config.py::TestSingletonPattern::test_reset_config_clears_singleton PASSED [ 17%]
tests/unit/test_config.py::TestSingletonPattern::test_singleton_preserves_initial_values PASSED [ 17%]
tests/unit/test_config.py::TestSingletonPattern::test_concurrent_access PASSED [ 17%]
tests/unit/test_config.py::TestEdgeCases::test_zero_workers PASSED       [ 17%]
tests/unit/test_config.py::TestEdgeCases::test_zero_chunk_size PASSED    [ 17%]
tests/unit/test_config.py::TestEdgeCases::test_negative_chunk_overlap PASSED [ 18%]
tests/unit/test_config.py::TestEdgeCases::test_empty_log_level PASSED    [ 18%]
tests/unit/test_config.py::TestEdgeCases::test_very_long_paths PASSED    [ 18%]
tests/unit/test_config.py::TestEdgeCases::test_special_characters_in_paths PASSED [ 18%]
tests/unit/test_config.py::TestIntegration::test_complete_configuration_workflow PASSED [ 18%]
tests/unit/test_config.py::TestIntegration::test_config_with_missing_dependencies PASSED [ 19%]
tests/unit/test_diagnostics.py::test_account <- diagnostics\diagnostics.py ERROR [ 19%]
tests/unit/test_diagnostics.py::TestAccountTesting::test_account_with_missing_credentials_returns_failure PASSED [ 19%]
tests/unit/test_diagnostics.py::TestAccountTesting::test_account_with_valid_setup_returns_success PASSED [ 19%]
tests/unit/test_diagnostics.py::TestAccountTesting::test_account_with_init_failure_returns_error PASSED [ 19%]
tests/unit/test_diagnostics.py::TestAccountTesting::test_account_with_embedding_failure_returns_error PASSED [ 20%]
tests/unit/test_diagnostics.py::TestAccountTesting::test_account_with_empty_embeddings_returns_failure PASSED [ 20%]
tests/unit/test_diagnostics.py::TestVerifyIndexAlignment::test_verify_with_missing_index_dir_exits PASSED [ 20%]
tests/unit/test_diagnostics.py::TestVerifyIndexAlignment::test_verify_with_missing_mapping_exits PASSED [ 20%]
tests/unit/test_diagnostics.py::TestVerifyIndexAlignment::test_verify_with_valid_index_succeeds PASSED [ 20%]
tests/unit/test_diagnostics.py::TestVerifyIndexAlignment::test_verify_with_mismatched_counts_exits PASSED [ 21%]
tests/unit/test_diagnostics.py::TestVerifyIndexAlignment::test_verify_with_missing_required_field_exits PASSED [ 21%]
tests/unit/test_diagnostics.py::TestVerifyIndexAlignment::test_verify_with_duplicate_ids_exits PASSED [ 21%]
tests/unit/test_diagnostics.py::TestVerifyIndexAlignment::test_verify_with_invalid_doctype_exits PASSED [ 21%]
tests/unit/test_diagnostics.py::TestCheckIndexConsistency::test_check_with_missing_index_returns_error PASSED [ 21%]
tests/unit/test_diagnostics.py::TestCheckIndexConsistency::test_check_with_valid_index_returns_healthy PASSED [ 22%]
tests/unit/test_diagnostics.py::TestCheckIndexConsistency::test_check_with_missing_mapping_returns_errors PASSED [ 22%]
tests/unit/test_diagnostics.py::TestCheckIndexConsistency::test_check_with_mismatched_counts_returns_critical PASSED [ 22%]
tests/unit/test_diagnostics.py::TestCheckIndexConsistency::test_check_with_duplicate_ids_returns_error PASSED [ 22%]
tests/unit/test_diagnostics.py::TestCheckIndexConsistency::test_check_includes_timestamp PASSED [ 22%]
tests/unit/test_diagnostics.py::TestCheckIndexConsistency::test_check_includes_recommendations_for_errors PASSED [ 23%]
tests/unit/test_diagnostics.py::TestCheckIndexConsistency::test_check_validates_meta_dimensions PASSED [ 23%]
tests/unit/test_diagnostics.py::TestFieldValidation::test_required_fields_constant_is_complete PASSED [ 23%]
tests/unit/test_diagnostics.py::TestFieldValidation::test_valid_doctypes_constant_is_correct PASSED [ 23%]
tests/unit/test_diagnostics.py::TestFieldValidation::test_mapping_entry_with_all_fields_is_valid PASSED [ 23%]
tests/unit/test_diagnostics.py::TestFieldValidation::test_mapping_entry_doctype_validation PASSED [ 23%]
tests/unit/test_diagnostics.py::TestDiagnosticsEdgeCases::test_check_with_empty_mapping_returns_healthy PASSED [ 24%]
tests/unit/test_diagnostics.py::TestDiagnosticsEdgeCases::test_check_with_corrupted_json_returns_error PASSED [ 24%]
tests/unit/test_diagnostics.py::TestDiagnosticsEdgeCases::test_verify_with_non_string_snippet_exits PASSED [ 24%]
tests/unit/test_emailops_utils.py::TestStripControlChars::test_strip_control_chars_empty_string PASSED [ 24%]
tests/unit/test_emailops_utils.py::TestStripControlChars::test_strip_control_chars_none PASSED [ 24%]
tests/unit/test_emailops_utils.py::TestStripControlChars::test_strip_control_chars_normalizes_line_endings PASSED [ 25%]
tests/unit/test_emailops_utils.py::TestStripControlChars::test_strip_control_chars_preserves_tab_and_newline PASSED [ 25%]
tests/unit/test_emailops_utils.py::TestStripControlChars::test_strip_control_chars_removes_control_chars PASSED [ 25%]
tests/unit/test_emailops_utils.py::TestStripControlChars::test_strip_control_chars_with_unicode PASSED [ 25%]
tests/unit/test_emailops_utils.py::TestReadTextFile::test_read_text_file_nonexistent PASSED [ 25%]
tests/unit/test_emailops_utils.py::TestReadTextFile::test_read_text_file_utf16 PASSED [ 26%]
tests/unit/test_emailops_utils.py::TestReadTextFile::test_read_text_file_utf8 PASSED [ 26%]
tests/unit/test_emailops_utils.py::TestReadTextFile::test_read_text_file_utf8_with_bom PASSED [ 26%]
tests/unit/test_emailops_utils.py::TestReadTextFile::test_read_text_file_with_control_chars PASSED [ 26%]
tests/unit/test_emailops_utils.py::TestReadTextFile::test_read_text_file_with_max_chars PASSED [ 26%]
tests/unit/test_emailops_utils.py::TestHtmlToText::test_html_to_text_complex PASSED [ 27%]
tests/unit/test_emailops_utils.py::TestHtmlToText::test_html_to_text_empty PASSED [ 27%]
tests/unit/test_emailops_utils.py::TestHtmlToText::test_html_to_text_simple PASSED [ 27%]
tests/unit/test_emailops_utils.py::TestHtmlToText::test_html_to_text_with_scripts PASSED [ 27%]
tests/unit/test_emailops_utils.py::TestHtmlToText::test_html_to_text_with_styles PASSED [ 27%]
tests/unit/test_emailops_utils.py::TestHtmlToText::test_html_to_text_without_beautifulsoup FAILED [ 28%]
tests/unit/test_emailops_utils.py::TestExtractText::test_extract_text_docx_file FAILED [ 28%]
tests/unit/test_emailops_utils.py::TestExtractText::test_extract_text_html_file PASSED [ 28%]
tests/unit/test_emailops_utils.py::TestExtractText::test_extract_text_json_file PASSED [ 28%]
tests/unit/test_emailops_utils.py::TestExtractText::test_extract_text_pdf_file FAILED [ 28%]
tests/unit/test_emailops_utils.py::TestExtractText::test_extract_text_txt_file PASSED [ 29%]
tests/unit/test_emailops_utils.py::TestExtractText::test_extract_text_unsupported_format PASSED [ 29%]
tests/unit/test_emailops_utils.py::TestExtractText::test_extract_text_with_max_chars PASSED [ 29%]
tests/unit/test_emailops_utils.py::TestCleanEmailText::test_clean_email_text_empty PASSED [ 29%]
tests/unit/test_emailops_utils.py::TestCleanEmailText::test_clean_email_text_normalizes_whitespace PASSED [ 29%]
tests/unit/test_emailops_utils.py::TestCleanEmailText::test_clean_email_text_redacts_emails PASSED [ 29%]
tests/unit/test_emailops_utils.py::TestCleanEmailText::test_clean_email_text_redacts_urls PASSED [ 30%]
tests/unit/test_emailops_utils.py::TestCleanEmailText::test_clean_email_text_removes_headers PASSED [ 30%]
tests/unit/test_emailops_utils.py::TestCleanEmailText::test_clean_email_text_removes_quoted_text PASSED [ 30%]
tests/unit/test_emailops_utils.py::TestCleanEmailText::test_clean_email_text_removes_signatures PASSED [ 30%]
tests/unit/test_emailops_utils.py::TestCleanEmailText::test_clean_email_text_with_bom PASSED [ 30%]
tests/unit/test_emailops_utils.py::TestExtractEmailMetadata::test_extract_email_metadata_case_insensitive PASSED [ 31%]
tests/unit/test_emailops_utils.py::TestExtractEmailMetadata::test_extract_email_metadata_empty PASSED [ 31%]
tests/unit/test_emailops_utils.py::TestExtractEmailMetadata::test_extract_email_metadata_full_headers PASSED [ 31%]
tests/unit/test_emailops_utils.py::TestExtractEmailMetadata::test_extract_email_metadata_partial_headers PASSED [ 31%]
tests/unit/test_emailops_utils.py::TestSplitEmailThread::test_split_email_thread_empty PASSED [ 31%]
tests/unit/test_emailops_utils.py::TestSplitEmailThread::test_split_email_thread_single_message PASSED [ 32%]
tests/unit/test_emailops_utils.py::TestSplitEmailThread::test_split_email_thread_with_dates FAILED [ 32%]
tests/unit/test_emailops_utils.py::TestSplitEmailThread::test_split_email_thread_with_forwarded_message PASSED [ 32%]
tests/unit/test_emailops_utils.py::TestSplitEmailThread::test_split_email_thread_with_on_wrote PASSED [ 32%]
tests/unit/test_emailops_utils.py::TestSplitEmailThread::test_split_email_thread_with_original_message PASSED [ 32%]
tests/unit/test_emailops_utils.py::TestFindConversationDirs::test_find_conversation_dirs_empty PASSED [ 33%]
tests/unit/test_emailops_utils.py::TestFindConversationDirs::test_find_conversation_dirs_multiple PASSED [ 33%]
tests/unit/test_emailops_utils.py::TestFindConversationDirs::test_find_conversation_dirs_single PASSED [ 33%]
tests/unit/test_emailops_utils.py::TestLoadConversation::test_load_conversation_empty_dir PASSED [ 33%]
tests/unit/test_emailops_utils.py::TestLoadConversation::test_load_conversation_with_attachments PASSED [ 33%]
tests/unit/test_emailops_utils.py::TestLoadConversation::test_load_conversation_with_bom_in_files PASSED [ 34%]
tests/unit/test_emailops_utils.py::TestLoadConversation::test_load_conversation_with_manifest PASSED [ 34%]
tests/unit/test_emailops_utils.py::TestLoadConversation::test_load_conversation_with_summary PASSED [ 34%]
tests/unit/test_emailops_utils.py::TestLoadConversation::test_load_conversation_with_text PASSED [ 34%]
tests/unit/test_emailops_utils.py::TestEnsureDir::test_ensure_dir_creates_directory PASSED [ 34%]
tests/unit/test_emailops_utils.py::TestEnsureDir::test_ensure_dir_creates_nested_directories PASSED [ 35%]
tests/unit/test_emailops_utils.py::TestEnsureDir::test_ensure_dir_idempotent PASSED [ 35%]
tests/unit/test_emailops_utils.py::TestPerson::test_person_age_before_birthday PASSED [ 35%]
tests/unit/test_emailops_utils.py::TestPerson::test_person_age_calculation PASSED [ 35%]
tests/unit/test_emailops_utils.py::TestPerson::test_person_age_empty_birthdate PASSED [ 35%]
tests/unit/test_emailops_utils.py::TestPerson::test_person_age_invalid_birthdate PASSED [ 35%]
tests/unit/test_emailops_utils.py::TestPerson::test_person_getAge_method PASSED [ 36%]
tests/unit/test_emailops_utils.py::TestPerson::test_person_initialization PASSED [ 36%]
tests/unit/test_emailops_utils.py::TestFileExtensions::test_docx_extensions PASSED [ 36%]
tests/unit/test_emailops_utils.py::TestFileExtensions::test_email_extensions PASSED [ 36%]
tests/unit/test_emailops_utils.py::TestFileExtensions::test_excel_extensions PASSED [ 36%]
tests/unit/test_emailops_utils.py::TestFileExtensions::test_pdf_extensions PASSED [ 37%]
tests/unit/test_emailops_utils.py::TestFileExtensions::test_ppt_extensions PASSED [ 37%]
tests/unit/test_emailops_utils.py::TestFileExtensions::test_rtf_extensions PASSED [ 37%]
tests/unit/test_emailops_utils.py::TestFileExtensions::test_text_extensions PASSED [ 37%]
tests/unit/test_emailops_utils.py::TestEmailParsing::test_extract_eml_success FAILED [ 37%]
tests/unit/test_emailops_utils.py::TestEmailParsing::test_extract_msg_success FAILED [ 38%]
tests/unit/test_env_utils.py::TestEnvUtils::test_all_exported_symbols_exist PASSED [ 38%]
tests/unit/test_env_utils.py::TestEnvUtils::test_all_exports_list PASSED [ 38%]
tests/unit/test_env_utils.py::TestEnvUtils::test_default_accounts_exported FAILED [ 38%]
tests/unit/test_env_utils.py::TestEnvUtils::test_exception_inheritance PASSED [ 38%]
tests/unit/test_env_utils.py::TestEnvUtils::test_function_forwarding_with_args_and_kwargs FAILED [ 39%]
tests/unit/test_env_utils.py::TestEnvUtils::test_init_vertex_exported FAILED [ 39%]
tests/unit/test_env_utils.py::TestEnvUtils::test_llmerror_exported FAILED [ 39%]
tests/unit/test_env_utils.py::TestEnvUtils::test_load_validated_accounts_exported FAILED [ 39%]
tests/unit/test_env_utils.py::TestEnvUtils::test_module_does_not_mutate_runtime PASSED [ 39%]
tests/unit/test_env_utils.py::TestEnvUtils::test_no_additional_symbols_exported FAILED [ 40%]
tests/unit/test_env_utils.py::TestEnvUtils::test_reset_vertex_init_exported FAILED [ 40%]
tests/unit/test_env_utils.py::TestEnvUtils::test_save_validated_accounts_exported FAILED [ 40%]
tests/unit/test_env_utils.py::TestEnvUtils::test_validate_account_exported FAILED [ 40%]
tests/unit/test_env_utils.py::TestEnvUtils::test_vertex_account_exported FAILED [ 40%]
tests/unit/test_env_utils.py::TestEnvUtilsErrorHandling::test_missing_runtime_attribute FAILED [ 41%]
tests/unit/test_env_utils.py::TestEnvUtilsErrorHandling::test_runtime_function_raises_error FAILED [ 41%]
tests/unit/test_env_utils.py::TestEnvUtilsErrorHandling::test_runtime_module_import_error FAILED [ 41%]
tests/unit/test_env_utils.py::TestEnvUtilsIntegration::test_chained_function_calls FAILED [ 41%]
tests/unit/test_env_utils.py::TestEnvUtilsIntegration::test_default_accounts_modification FAILED [ 41%]
tests/unit/test_env_utils.py::TestEnvUtilsIntegration::test_vertex_account_instantiation FAILED [ 41%]
tests/unit/test_llm_client.py::TestLLMClient::test_complete_alias FAILED [ 42%]
tests/unit/test_llm_client.py::TestLLMClient::test_complete_json FAILED  [ 42%]
tests/unit/test_llm_client.py::TestLLMClient::test_complete_text FAILED  [ 42%]
tests/unit/test_llm_client.py::TestLLMClient::test_dir_removes_duplicates PASSED [ 42%]
tests/unit/test_llm_client.py::TestLLMClient::test_dir_returns_sorted_all FAILED [ 42%]
tests/unit/test_llm_client.py::TestLLMClient::test_embed_texts FAILED    [ 43%]
tests/unit/test_llm_client.py::TestLLMClient::test_embed_with_bytearray_raises PASSED [ 43%]
tests/unit/test_llm_client.py::TestLLMClient::test_embed_with_bytes_raises PASSED [ 43%]
tests/unit/test_llm_client.py::TestLLMClient::test_embed_with_generator FAILED [ 43%]
tests/unit/test_llm_client.py::TestLLMClient::test_embed_with_list FAILED [ 43%]
tests/unit/test_llm_client.py::TestLLMClient::test_embed_with_memoryview_raises PASSED [ 44%]
tests/unit/test_llm_client.py::TestLLMClient::test_embed_with_mixed_types_raises PASSED [ 44%]
tests/unit/test_llm_client.py::TestLLMClient::test_embed_with_non_string_elements_raises PASSED [ 44%]
tests/unit/test_llm_client.py::TestLLMClient::test_embed_with_single_string_raises PASSED [ 44%]
tests/unit/test_llm_client.py::TestLLMClient::test_embed_with_tuple FAILED [ 44%]
tests/unit/test_llm_client.py::TestLLMClient::test_getattr_all_deduplicates FAILED [ 45%]
tests/unit/test_llm_client.py::TestLLMClient::test_getattr_all_with_llmerror FAILED [ 45%]
tests/unit/test_llm_client.py::TestLLMClient::test_getattr_all_without_llmerror FAILED [ 45%]
tests/unit/test_llm_client.py::TestLLMClient::test_getattr_forwards_to_runtime FAILED [ 45%]
tests/unit/test_llm_client.py::TestLLMClient::test_getattr_llmerror FAILED [ 45%]
tests/unit/test_llm_client.py::TestLLMClient::test_getattr_missing_attribute PASSED [ 46%]
tests/unit/test_llm_client.py::TestLLMClient::test_json_complete_alias FAILED [ 46%]
tests/unit/test_llm_client.py::TestLLMClient::test_rt_attr_missing PASSED [ 46%]
tests/unit/test_llm_client.py::TestLLMClient::test_rt_attr_success FAILED [ 46%]
tests/unit/test_llm_client.py::TestLLMClient::test_runtime_exports_filters_non_strings FAILED [ 46%]
tests/unit/test_llm_client.py::TestLLMClient::test_runtime_exports_invalid_all PASSED [ 47%]
tests/unit/test_llm_client.py::TestLLMClient::test_runtime_exports_no_all_attribute PASSED [ 47%]
tests/unit/test_llm_client.py::TestLLMClient::test_runtime_exports_with_iterable FAILED [ 47%]
tests/unit/test_llm_client.py::TestLLMClient::test_runtime_exports_with_list FAILED [ 47%]
tests/unit/test_llm_client.py::TestLLMClient::test_runtime_exports_with_tuple FAILED [ 47%]
tests/unit/test_llm_client.py::TestLLMClientIntegration::test_complete_text_error_handling FAILED [ 47%]
tests/unit/test_llm_client.py::TestLLMClientIntegration::test_embed_empty_list FAILED [ 48%]
tests/unit/test_llm_client.py::TestLLMClientIntegration::test_multiple_kwargs_forwarding FAILED [ 48%]
tests/unit/test_llm_client.py::TestLLMClientIntegration::test_runtime_attribute_caching_not_performed FAILED [ 48%]
tests/unit/test_llm_client.py::TestLLMClientEdgeCases::test_embed_with_empty_generator FAILED [ 48%]
tests/unit/test_llm_client.py::TestLLMClientEdgeCases::test_runtime_exports_import_error PASSED [ 48%]
tests/unit/test_llm_client.py::TestLLMClientEdgeCases::test_type_checking_imports PASSED [ 49%]
tests/unit/test_monitor.py::TestColorUtilities::test_supports_color_returns_boolean PASSED [ 49%]
tests/unit/test_monitor.py::TestColorUtilities::test_supports_color_with_no_color_env_returns_false PASSED [ 49%]
tests/unit/test_monitor.py::TestColorUtilities::test_colored_with_color_support_adds_codes PASSED [ 49%]
tests/unit/test_monitor.py::TestColorUtilities::test_colored_without_color_support_returns_plain PASSED [ 49%]
tests/unit/test_monitor.py::TestIndexStatus::test_index_status_initialization PASSED [ 50%]
tests/unit/test_monitor.py::TestIndexStatus::test_index_status_to_dict_returns_dict PASSED [ 50%]
tests/unit/test_monitor.py::TestProcessInfo::test_process_info_initialization PASSED [ 50%]
tests/unit/test_monitor.py::TestProcessInfo::test_process_info_to_dict_returns_dict PASSED [ 50%]
tests/unit/test_monitor.py::TestIndexMonitorInit::test_index_monitor_with_default_params PASSED [ 50%]
tests/unit/test_monitor.py::TestIndexMonitorInit::test_index_monitor_with_custom_index_dirname PASSED [ 51%]
tests/unit/test_monitor.py::TestIndexMonitorInit::test_index_monitor_with_custom_active_window PASSED [ 51%]
tests/unit/test_monitor.py::TestIndexMonitorInit::test_index_monitor_without_root_uses_cwd PASSED [ 51%]
tests/unit/test_monitor.py::TestIndexMonitorInit::test_index_monitor_expands_user_path PASSED [ 51%]
tests/unit/test_monitor.py::TestCheckStatus::test_check_status_with_missing_index_returns_not_exists PASSED [ 51%]
tests/unit/test_monitor.py::TestCheckStatus::test_check_status_with_valid_index_returns_status PASSED [ 52%]
tests/unit/test_monitor.py::TestCheckStatus::test_check_status_counts_documents_from_mapping PASSED [ 52%]
tests/unit/test_monitor.py::TestCheckStatus::test_check_status_detects_active_indexing PASSED [ 52%]
tests/unit/test_monitor.py::TestCheckStatus::test_check_status_detects_inactive_indexing PASSED [ 52%]
tests/unit/test_monitor.py::TestCheckStatus::test_check_status_finds_index_file PASSED [ 52%]
tests/unit/test_monitor.py::TestCheckStatus::test_check_status_calculates_progress PASSED [ 52%]
tests/unit/test_monitor.py::TestCheckStatus::test_check_status_loads_metadata PASSED [ 53%]
tests/unit/test_monitor.py::TestAnalyzeRate::test_analyze_rate_with_no_documents_returns_empty PASSED [ 53%]
tests/unit/test_monitor.py::TestAnalyzeRate::test_analyze_rate_with_valid_index_calculates_rate PASSED [ 53%]
tests/unit/test_monitor.py::TestAnalyzeRate::test_analyze_rate_estimates_completion_time PASSED [ 53%]
tests/unit/test_monitor.py::TestAnalyzeRate::test_analyze_rate_without_created_time_returns_empty PASSED [ 53%]
tests/unit/test_monitor.py::TestFindProcesses::test_find_processes_returns_list PASSED [ 54%]
tests/unit/test_monitor.py::TestFindProcesses::test_find_processes_without_psutil_returns_empty PASSED [ 54%]
tests/unit/test_monitor.py::TestFindProcesses::test_find_processes_filters_python_processes PASSED [ 54%]
tests/unit/test_monitor.py::TestCheckProcess::test_check_process_without_psutil_returns_none PASSED [ 54%]
tests/unit/test_monitor.py::TestCheckProcess::test_check_process_with_nonexistent_pid_returns_none PASSED [ 54%]
tests/unit/test_monitor.py::TestHelperMethods::test_load_mapping_with_valid_file PASSED [ 55%]
tests/unit/test_monitor.py::TestHelperMethods::test_load_mapping_with_missing_file PASSED [ 55%]
tests/unit/test_monitor.py::TestHelperMethods::test_count_conversations_with_conversation_dirs PASSED [ 55%]
tests/unit/test_monitor.py::TestHelperMethods::test_estimate_conversations_indexed PASSED [ 55%]
tests/unit/test_monitor.py::TestHelperMethods::test_get_created_time_from_meta PASSED [ 55%]
tests/unit/test_monitor.py::TestHelperMethods::test_get_created_time_with_missing_meta PASSED [ 56%]
tests/unit/test_monitor.py::TestHelperMethods::test_find_newest_artifact_finds_recent_file PASSED [ 56%]
tests/unit/test_monitor.py::TestMonitorEdgeCases::test_check_status_with_empty_mapping PASSED [ 56%]
tests/unit/test_monitor.py::TestMonitorEdgeCases::test_check_status_with_corrupted_mapping PASSED [ 56%]
tests/unit/test_monitor.py::TestMonitorEdgeCases::test_analyze_rate_with_zero_elapsed_time PASSED [ 56%]
tests/unit/test_monitor.py::TestMonitorEdgeCases::test_progress_calculation_with_zero_total PASSED [ 57%]
tests/unit/test_monitor.py::TestMonitorEdgeCases::test_check_status_with_very_large_index PASSED [ 57%]
tests/unit/test_processor.py::TestDataClasses::test_chunk_job_default_priority PASSED [ 57%]
tests/unit/test_processor.py::TestDataClasses::test_chunk_job_initialization PASSED [ 57%]
tests/unit/test_processor.py::TestDataClasses::test_processing_stats_estimated_time_remaining PASSED [ 57%]
tests/unit/test_processor.py::TestDataClasses::test_processing_stats_progress_percent PASSED [ 58%]
tests/unit/test_processor.py::TestDataClasses::test_processing_stats_progress_percent_zero_total PASSED [ 58%]
tests/unit/test_processor.py::TestDataClasses::test_worker_config_initialization PASSED [ 58%]
tests/unit/test_processor.py::TestDataClasses::test_worker_stats_estimated_time_remaining PASSED [ 58%]
tests/unit/test_processor.py::TestDataClasses::test_worker_stats_no_eta_when_no_progress PASSED [ 58%]
tests/unit/test_processor.py::TestDataClasses::test_worker_stats_progress_percent PASSED [ 58%]
tests/unit/test_processor.py::TestDataClasses::test_worker_stats_progress_percent_zero_total PASSED [ 59%]
tests/unit/test_processor.py::TestHelperFunctions::test_initialize_gcp_credentials_from_config PASSED [ 59%]
tests/unit/test_processor.py::TestHelperFunctions::test_initialize_gcp_credentials_from_env FAILED [ 59%]
tests/unit/test_processor.py::TestHelperFunctions::test_initialize_gcp_credentials_no_env FAILED [ 59%]
tests/unit/test_processor.py::TestHelperFunctions::test_safe_filename_for_doc_long_name PASSED [ 59%]
tests/unit/test_processor.py::TestHelperFunctions::test_safe_filename_for_doc_simple PASSED [ 60%]
tests/unit/test_processor.py::TestHelperFunctions::test_safe_filename_for_doc_special_chars PASSED [ 60%]
tests/unit/test_processor.py::TestHelperFunctions::test_save_chunks_to_path PASSED [ 60%]
tests/unit/test_processor.py::TestUnifiedProcessor::test_build_chunk_config_kwargs FAILED [ 60%]
tests/unit/test_processor.py::TestUnifiedProcessor::test_distribute_chunking_work FAILED [ 60%]
tests/unit/test_processor.py::TestUnifiedProcessor::test_find_documents_basic FAILED [ 61%]
tests/unit/test_processor.py::TestUnifiedProcessor::test_find_documents_test_mode FAILED [ 61%]
tests/unit/test_processor.py::TestUnifiedProcessor::test_find_documents_with_resume FAILED [ 61%]
tests/unit/test_processor.py::TestUnifiedProcessor::test_init_embed_mode FAILED [ 61%]
tests/unit/test_processor.py::TestUnifiedProcessor::test_init_with_custom_params FAILED [ 61%]
tests/unit/test_processor.py::TestUnifiedProcessor::test_init_with_defaults FAILED [ 62%]
tests/unit/test_processor.py::TestUnifiedProcessor::test_init_without_config FAILED [ 62%]
tests/unit/test_processor.py::TestChunkWorkerEntry::test_chunk_worker_entry_import_error FAILED [ 62%]
tests/unit/test_processor.py::TestChunkWorkerEntry::test_chunk_worker_entry_success FAILED [ 62%]
tests/unit/test_processor.py::TestEmbeddingOperations::test_create_embeddings_no_credentials FAILED [ 62%]
tests/unit/test_processor.py::TestEmbeddingOperations::test_create_embeddings_vertex FAILED [ 63%]
tests/unit/test_processor.py::TestIndexOperations::test_repair_index_no_files FAILED [ 63%]
tests/unit/test_processor.py::TestIndexOperations::test_repair_index_success FAILED [ 63%]
tests/unit/test_processor.py::TestCLI::test_cli_chunk_command PASSED     [ 63%]
tests/unit/test_processor.py::TestCLI::test_cli_embed_command PASSED     [ 63%]
tests/unit/test_processor.py::TestCLI::test_cli_fix_command PASSED       [ 64%]
tests/unit/test_processor.py::TestCLI::test_cli_no_command PASSED        [ 64%]
tests/unit/test_processor.py::TestCLI::test_cli_repair_command PASSED    [ 64%]
tests/unit/test_processor.py::TestErrorHandling::test_embed_from_chunks_error_handling FAILED [ 64%]
tests/unit/test_processor.py::TestErrorHandling::test_fix_failed_embeddings_re_embed_error FAILED [ 64%]
tests/unit/test_processor.py::TestErrorHandling::test_sequential_chunk_import_error FAILED [ 64%]
tests/unit/test_processor.py::TestMonitoringFunctions::test_display_progress_tty FAILED [ 65%]
tests/unit/test_processor.py::TestMonitoringFunctions::test_print_summary FAILED [ 65%]
tests/unit/test_statistics.py::TestAnalyzeFileProcessing::test_analyze_file_processing_runs_without_error PASSED [ 65%]
tests/unit/test_statistics.py::TestAnalyzeFileProcessing::test_analyze_file_processing_shows_chunked_files PASSED [ 65%]
tests/unit/test_statistics.py::TestAnalyzeFileProcessing::test_analyze_file_processing_shows_ignored_files PASSED [ 65%]
tests/unit/test_statistics.py::TestAnalyzeFileProcessing::test_analyze_file_processing_shows_summary PASSED [ 66%]
tests/unit/test_statistics.py::TestGetFileStatistics::test_get_file_statistics_with_empty_directory PASSED [ 66%]
tests/unit/test_statistics.py::TestGetFileStatistics::test_get_file_statistics_counts_conversations PASSED [ 66%]
tests/unit/test_statistics.py::TestGetFileStatistics::test_get_file_statistics_counts_files_by_extension PASSED [ 66%]
tests/unit/test_statistics.py::TestGetFileStatistics::test_get_file_statistics_returns_top_extensions PASSED [ 66%]
tests/unit/test_statistics.py::TestGetFileStatistics::test_get_file_statistics_with_no_extension_files PASSED [ 67%]
tests/unit/test_statistics.py::TestGetFileStatistics::test_get_file_statistics_includes_path_info PASSED [ 67%]
tests/unit/test_statistics.py::TestGetFileStatistics::test_get_file_statistics_handles_nested_directories PASSED [ 67%]
tests/unit/test_statistics.py::TestCountTotalChunks::test_count_total_chunks_with_missing_directory PASSED [ 67%]
tests/unit/test_statistics.py::TestCountTotalChunks::test_count_total_chunks_with_no_files PASSED [ 67%]
tests/unit/test_statistics.py::TestCountTotalChunks::test_count_total_chunks_counts_pickle_files PASSED [ 68%]
tests/unit/test_statistics.py::TestCountTotalChunks::test_count_total_chunks_sums_multiple_files PASSED [ 68%]
tests/unit/test_statistics.py::TestCountTotalChunks::test_count_total_chunks_handles_corrupted_pickle PASSED [ 68%]
tests/unit/test_statistics.py::TestCountTotalChunks::test_count_total_chunks_handles_missing_chunks_key PASSED [ 68%]
tests/unit/test_statistics.py::TestMonitorIndexingProgress::test_monitor_with_missing_log_file PASSED [ 68%]
tests/unit/test_statistics.py::TestMonitorIndexingProgress::test_monitor_with_empty_log_file PASSED [ 69%]
tests/unit/test_statistics.py::TestMonitorIndexingProgress::test_monitor_counts_success_calls PASSED [ 69%]
tests/unit/test_statistics.py::TestMonitorIndexingProgress::test_monitor_counts_errors PASSED [ 69%]
tests/unit/test_statistics.py::TestMonitorIndexingProgress::test_monitor_calculates_activity_status PASSED [ 69%]
tests/unit/test_statistics.py::TestMonitorIndexingProgress::test_monitor_calculates_elapsed_time PASSED [ 69%]
tests/unit/test_statistics.py::TestMonitorIndexingProgress::test_monitor_calculates_processing_rate PASSED [ 70%]
tests/unit/test_statistics.py::TestMonitorIndexingProgress::test_monitor_estimates_completion PASSED [ 70%]
tests/unit/test_statistics.py::TestMonitorIndexingProgress::test_monitor_handles_malformed_timestamps PASSED [ 70%]
tests/unit/test_statistics.py::TestStatisticsIntegration::test_full_workflow_with_mock_data PASSED [ 70%]
tests/unit/test_statistics.py::TestStatisticsIntegration::test_statistics_with_multiple_conversations PASSED [ 70%]
tests/unit/test_statistics.py::TestStatisticsEdgeCases::test_get_file_statistics_with_special_characters_in_names PASSED [ 70%]
tests/unit/test_statistics.py::TestStatisticsEdgeCases::test_count_total_chunks_with_empty_chunks_list PASSED [ 71%]
tests/unit/test_statistics.py::TestStatisticsEdgeCases::test_monitor_with_very_large_log_file PASSED [ 71%]
tests/unit/test_statistics.py::TestStatisticsEdgeCases::test_get_file_statistics_with_symlinks PASSED [ 71%]
tests/unit/test_statistics.py::TestStatisticsEdgeCases::test_count_total_chunks_with_non_pickle_files PASSED [ 71%]
tests/unit/test_utils.py::TestSetupLogging::test_setup_logging_with_default_level_returns_logger PASSED [ 71%]
tests/unit/test_utils.py::TestSetupLogging::test_setup_logging_with_debug_level_sets_debug PASSED [ 72%]
tests/unit/test_utils.py::TestSetupLogging::test_setup_logging_with_warning_level_sets_warning PASSED [ 72%]
tests/unit/test_utils.py::TestSetupLogging::test_setup_logging_with_invalid_level_uses_info PASSED [ 72%]
tests/unit/test_utils.py::TestSetupLogging::test_setup_logging_with_lowercase_level_works PASSED [ 72%]
tests/unit/test_utils.py::TestGetIndexPath::test_get_index_path_with_no_root_uses_cwd PASSED [ 72%]
tests/unit/test_utils.py::TestGetIndexPath::test_get_index_path_with_root_returns_root_plus_index PASSED [ 73%]
tests/unit/test_utils.py::TestGetIndexPath::test_get_index_path_respects_env_variable PASSED [ 73%]
tests/unit/test_utils.py::TestGetIndexPath::test_get_index_path_with_path_object_works PASSED [ 73%]
tests/unit/test_utils.py::TestGetIndexPath::test_get_index_path_with_relative_path_works PASSED [ 73%]
tests/unit/test_utils.py::TestGetExportRoot::test_get_export_root_with_env_variable_returns_env_path PASSED [ 73%]
tests/unit/test_utils.py::TestGetExportRoot::test_get_export_root_without_env_variable_returns_cwd PASSED [ 74%]
tests/unit/test_utils.py::TestGetExportRoot::test_get_export_root_with_empty_env_variable_returns_cwd PASSED [ 74%]
tests/unit/test_utils.py::TestFormatTimestamp::test_format_timestamp_with_datetime_returns_formatted_string PASSED [ 74%]
tests/unit/test_utils.py::TestFormatTimestamp::test_format_timestamp_with_midnight_formats_correctly PASSED [ 74%]
tests/unit/test_utils.py::TestFormatTimestamp::test_format_timestamp_with_end_of_day_formats_correctly PASSED [ 74%]
tests/unit/test_utils.py::TestFormatTimestamp::test_format_timestamp_preserves_leading_zeros PASSED [ 75%]
tests/unit/test_utils.py::TestFormatTimestamp::test_format_timestamp_with_microseconds_ignores_them PASSED [ 75%]
tests/unit/test_utils.py::TestSaveJsonReport::test_save_json_report_creates_file PASSED [ 75%]
tests/unit/test_utils.py::TestSaveJsonReport::test_save_json_report_writes_correct_content PASSED [ 75%]
tests/unit/test_utils.py::TestSaveJsonReport::test_save_json_report_with_nested_data_works PASSED [ 75%]
tests/unit/test_utils.py::TestSaveJsonReport::test_save_json_report_with_unicode_works PASSED [ 76%]
tests/unit/test_utils.py::TestSaveJsonReport::test_save_json_report_with_list_data_works PASSED [ 76%]
tests/unit/test_utils.py::TestSaveJsonReport::test_save_json_report_overwrites_existing_file PASSED [ 76%]
tests/unit/test_utils.py::TestSaveJsonReport::test_save_json_report_returns_path_object PASSED [ 76%]
tests/unit/test_utils.py::TestSaveJsonReport::test_save_json_report_with_empty_dict_works PASSED [ 76%]
tests/unit/test_utils.py::TestSaveJsonReport::test_save_json_report_formats_with_indentation PASSED [ 76%]
tests/unit/test_utils.py::TestUtilsIntegration::test_get_index_path_and_save_report_work_together PASSED [ 77%]
tests/unit/test_utils.py::TestUtilsIntegration::test_format_timestamp_in_report_data PASSED [ 77%]
tests/unit/test_utils.py::TestUtilsEdgeCases::test_get_index_path_with_special_characters_in_dirname PASSED [ 77%]
tests/unit/test_utils.py::TestUtilsEdgeCases::test_save_json_report_with_very_long_filename PASSED [ 77%]
tests/unit/test_utils.py::TestUtilsEdgeCases::test_format_timestamp_with_year_boundary PASSED [ 77%]
tests/unit/test_utils.py::TestUtilsEdgeCases::test_get_export_root_with_relative_env_path PASSED [ 78%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_path_traversal_prevention[../../../etc/passwd-Path traversal detected] PASSED [ 78%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_path_traversal_prevention[..\\..\\windows\\system32-Path traversal detected] PASSED [ 78%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_path_traversal_prevention[../../-Path traversal detected] PASSED [ 78%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_path_traversal_prevention[../-Path traversal detected] PASSED [ 78%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_path_traversal_prevention[/../../etc-Path traversal detected] PASSED [ 79%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_path_traversal_prevention[./../../-Path traversal detected] PASSED [ 79%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_path_traversal_prevention[foo/../../../bar-Path traversal detected] PASSED [ 79%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_path_traversal_prevention[test/../../sensitive-Path traversal detected] PASSED [ 79%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_path_traversal_allowed_when_explicitly_enabled PASSED [ 79%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_null_byte_handling[test\x00.txt] PASSED [ 80%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_null_byte_handling[/etc/passwd\x00] PASSED [ 80%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_null_byte_handling[directory\x00/file] PASSED [ 80%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_null_byte_handling[\x00/etc/passwd] PASSED [ 80%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_symlink_validation PASSED [ 80%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_unicode_path_separators[test\u2024directory] PASSED [ 81%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_unicode_path_separators[test\u2025directory] PASSED [ 81%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_unicode_path_separators[test\u2026directory] PASSED [ 81%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_unicode_path_separators[test\uff0edirectory] PASSED [ 81%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_cross_platform_paths[C:\\Windows\\System32-True] PASSED [ 81%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_cross_platform_paths[/usr/local/bin-True] PASSED [ 82%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_cross_platform_paths[\\\\server\\share-True] PASSED [ 82%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_cross_platform_paths[relative/path-False] PASSED [ 82%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_valid_directory_paths PASSED [ 82%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_home_directory_expansion PASSED [ 82%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_empty_path PASSED [ 82%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_very_long_path PASSED [ 83%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_special_characters_in_path PASSED [ 83%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_file_instead_of_directory PASSED [ 83%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_nonexistent_directory_must_exist PASSED [ 83%]
tests/unit/test_validators.py::TestValidateDirectoryPath::test_nonexistent_directory_may_not_exist PASSED [ 83%]
tests/unit/test_validators.py::TestValidateFilePath::test_file_path_traversal_prevention[../../../etc/passwd] PASSED [ 84%]
tests/unit/test_validators.py::TestValidateFilePath::test_file_path_traversal_prevention[..\\..\\windows\\system32\\config\\sam] PASSED [ 84%]
tests/unit/test_validators.py::TestValidateFilePath::test_file_path_traversal_prevention[../../shadow] PASSED [ 84%]
tests/unit/test_validators.py::TestValidateFilePath::test_file_path_traversal_prevention[../.bashrc] PASSED [ 84%]
tests/unit/test_validators.py::TestValidateFilePath::test_file_path_traversal_prevention[uploads/../../../etc/passwd] PASSED [ 84%]
tests/unit/test_validators.py::TestValidateFilePath::test_allowed_extensions PASSED [ 85%]
tests/unit/test_validators.py::TestValidateFilePath::test_case_insensitive_extensions PASSED [ 85%]
tests/unit/test_validators.py::TestValidateFilePath::test_file_null_byte_injection PASSED [ 85%]
tests/unit/test_validators.py::TestValidateFilePath::test_valid_file_paths PASSED [ 85%]
tests/unit/test_validators.py::TestValidateFilePath::test_directory_instead_of_file PASSED [ 85%]
tests/unit/test_validators.py::TestValidateFilePath::test_file_without_extension PASSED [ 86%]
tests/unit/test_validators.py::TestSanitizePathInput::test_null_byte_removal PASSED [ 86%]
tests/unit/test_validators.py::TestSanitizePathInput::test_whitespace_trimming PASSED [ 86%]
tests/unit/test_validators.py::TestSanitizePathInput::test_shell_metacharacter_removal PASSED [ 86%]
tests/unit/test_validators.py::TestSanitizePathInput::test_allowed_characters_preserved PASSED [ 86%]
tests/unit/test_validators.py::TestSanitizePathInput::test_empty_input PASSED [ 87%]
tests/unit/test_validators.py::TestSanitizePathInput::test_unicode_handling PASSED [ 87%]
tests/unit/test_validators.py::TestValidateCommandArgs::test_command_injection_prevention[ls-dangerous_args0] PASSED [ 87%]
tests/unit/test_validators.py::TestValidateCommandArgs::test_command_injection_prevention[echo-dangerous_args1] PASSED [ 87%]
tests/unit/test_validators.py::TestValidateCommandArgs::test_command_injection_prevention[python-dangerous_args2] PASSED [ 87%]
tests/unit/test_validators.py::TestValidateCommandArgs::test_command_injection_prevention[git-dangerous_args3] PASSED [ 88%]
tests/unit/test_validators.py::TestValidateCommandArgs::test_command_injection_prevention[npm-dangerous_args4] PASSED [ 88%]
tests/unit/test_validators.py::TestValidateCommandArgs::test_shell_metacharacters_in_command PASSED [ 88%]
tests/unit/test_validators.py::TestValidateCommandArgs::test_newline_injection PASSED [ 88%]
tests/unit/test_validators.py::TestValidateCommandArgs::test_null_byte_in_args PASSED [ 88%]
tests/unit/test_validators.py::TestValidateCommandArgs::test_command_whitelist PASSED [ 88%]
tests/unit/test_validators.py::TestValidateCommandArgs::test_valid_command_args PASSED [ 89%]
tests/unit/test_validators.py::TestValidateCommandArgs::test_empty_command PASSED [ 89%]
tests/unit/test_validators.py::TestValidateCommandArgs::test_empty_args_list PASSED [ 89%]
tests/unit/test_validators.py::TestValidateCommandArgs::test_special_chars_in_safe_context PASSED [ 89%]
tests/unit/test_validators.py::TestQuoteShellArg::test_simple_string_quoting PASSED [ 89%]
tests/unit/test_validators.py::TestQuoteShellArg::test_dangerous_character_quoting PASSED [ 90%]
tests/unit/test_validators.py::TestQuoteShellArg::test_quote_within_string PASSED [ 90%]
tests/unit/test_validators.py::TestQuoteShellArg::test_empty_string PASSED [ 90%]
tests/unit/test_validators.py::TestQuoteShellArg::test_numeric_input PASSED [ 90%]
tests/unit/test_validators.py::TestValidateProjectId::test_valid_project_ids[my-project] PASSED [ 90%]
tests/unit/test_validators.py::TestValidateProjectId::test_valid_project_ids[project-123] PASSED [ 91%]
tests/unit/test_validators.py::TestValidateProjectId::test_valid_project_ids[test-gcp-456] PASSED [ 91%]
tests/unit/test_validators.py::TestValidateProjectId::test_valid_project_ids[abc123] PASSED [ 91%]
tests/unit/test_validators.py::TestValidateProjectId::test_valid_project_ids[aaaaaa] PASSED [ 91%]
tests/unit/test_validators.py::TestValidateProjectId::test_valid_project_ids[a----------------------------a] PASSED [ 91%]
tests/unit/test_validators.py::TestValidateProjectId::test_invalid_project_ids[-cannot be empty] PASSED [ 92%]
tests/unit/test_validators.py::TestValidateProjectId::test_invalid_project_ids[short-6-30 characters] PASSED [ 92%]
tests/unit/test_validators.py::TestValidateProjectId::test_invalid_project_ids[aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa-6-30 characters] PASSED [ 92%]
tests/unit/test_validators.py::TestValidateProjectId::test_invalid_project_ids[My-Project-must start with a lowercase letter] PASSED [ 92%]
tests/unit/test_validators.py::TestValidateProjectId::test_invalid_project_ids[123-project-start with a lowercase letter] PASSED [ 92%]
tests/unit/test_validators.py::TestValidateProjectId::test_invalid_project_ids[project--cannot end with a hyphen] PASSED [ 93%]
tests/unit/test_validators.py::TestValidateProjectId::test_invalid_project_ids[project_name-only contain lowercase letters, numbers, and hyphens] PASSED [ 93%]
tests/unit/test_validators.py::TestValidateProjectId::test_invalid_project_ids[project.name-only contain lowercase letters, numbers, and hyphens] PASSED [ 93%]
tests/unit/test_validators.py::TestValidateProjectId::test_invalid_project_ids[project name-only contain lowercase letters, numbers, and hyphens] PASSED [ 93%]
tests/unit/test_validators.py::TestValidateProjectId::test_project_id_boundary_lengths PASSED [ 93%]
tests/unit/test_validators.py::TestValidateProjectId::test_hyphen_placement PASSED [ 94%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_valid_environment_variables[HOME-/home/user] PASSED [ 94%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_valid_environment_variables[PATH-/usr/bin:/usr/local/bin] PASSED [ 94%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_valid_environment_variables[PYTHON_VERSION-3.9.0] PASSED [ 94%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_valid_environment_variables[_PRIVATE_VAR-secret] PASSED [ 94%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_valid_environment_variables[VAR_WITH_NUMBERS_123-value] PASSED [ 94%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_invalid_environment_variable_names[-cannot be empty] PASSED [ 95%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_invalid_environment_variable_names[lowercase-uppercase letters, numbers, and underscores] PASSED [ 95%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_invalid_environment_variable_names[123_START-uppercase letters, numbers, and underscores] PASSED [ 95%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_invalid_environment_variable_names[VAR-WITH-DASH-uppercase letters, numbers, and underscores] PASSED [ 95%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_invalid_environment_variable_names[VAR.WITH.DOT-uppercase letters, numbers, and underscores] PASSED [ 95%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_invalid_environment_variable_names[VAR WITH SPACE-uppercase letters, numbers, and underscores] PASSED [ 96%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_null_byte_in_value PASSED [ 96%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_empty_value PASSED [ 96%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_special_chars_in_value PASSED [ 96%]
tests/unit/test_validators.py::TestValidateEnvironmentVariable::test_very_long_value PASSED [ 96%]
tests/unit/test_validators.py::TestSecurityIntegration::test_combined_path_validation_workflow PASSED [ 97%]
tests/unit/test_validators.py::TestSecurityIntegration::test_command_execution_workflow PASSED [ 97%]
tests/unit/test_validators.py::TestSecurityIntegration::test_environment_variable_workflow PASSED [ 97%]
tests/unit/test_validators.py::TestErrorHandling::test_exception_handling_in_validate_directory PASSED [ 97%]
tests/unit/test_validators.py::TestErrorHandling::test_exception_handling_in_validate_file PASSED [ 97%]
tests/unit/test_validators.py::TestErrorHandling::test_no_sensitive_data_in_errors PASSED [ 98%]
tests/unit/test_validators.py::TestWindowsSpecificPaths::test_windows_path_formats[C:\\Windows\\System32] PASSED [ 98%]
tests/unit/test_validators.py::TestWindowsSpecificPaths::test_windows_path_formats[D:\\Users\\Username\\Documents] PASSED [ 98%]
tests/unit/test_validators.py::TestWindowsSpecificPaths::test_windows_path_formats[\\\\server\\share\\folder] PASSED [ 98%]
tests/unit/test_validators.py::TestWindowsSpecificPaths::test_windows_path_formats[C:\\Program Files\\Application] PASSED [ 98%]
tests/unit/test_validators.py::TestWindowsSpecificPaths::test_windows_path_formats[C:\\Users\\..\\..\\Windows] PASSED [ 99%]
tests/unit/test_validators.py::TestLinuxSpecificPaths::test_linux_path_formats[/home/user/documents] PASSED [ 99%]
tests/unit/test_validators.py::TestLinuxSpecificPaths::test_linux_path_formats[/usr/local/bin] PASSED [ 99%]
tests/unit/test_validators.py::TestLinuxSpecificPaths::test_linux_path_formats[/etc/config] PASSED [ 99%]
tests/unit/test_validators.py::TestLinuxSpecificPaths::test_linux_path_formats[/var/log/application] PASSED [ 99%]
tests/unit/test_validators.py::TestLinuxSpecificPaths::test_linux_path_formats[/home/../etc/passwd] PASSED [100%]
ERROR: Coverage failure: total of 23 is less than fail-under=60


=================================== ERRORS ====================================
_______________________ ERROR at setup of test_account ________________________
file C:\Users\ASUS\Downloads\emailops_vertex_ai\diagnostics\diagnostics.py, line 43
  def test_account(account) -> tuple[bool, str]:
E       fixture 'account' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, capture_logs, cov, doctest_namespace, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_conversation_structure, mock_credentials_file, mock_embed_texts, mock_env_vars, mock_index_dir, mock_index_files, mock_vertex_account_validation, mock_vertex_ai, monkeypatch, no_cover, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, sample_accounts_list, sample_chunk_data, sample_embeddings, sample_mapping_data, sample_vertex_account, temp_dir, test_data_dir, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

C:\Users\ASUS\Downloads\emailops_vertex_ai\diagnostics\diagnostics.py:43
================================== FAILURES ===================================
______ TestDocumentProcessingWorkflow.test_document_processing_workflow _______
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_core_workflows.TestDocumentProcessingWorkflow testMethod=test_document_processing_workflow>,)
        func       = <function TestDocumentProcessingWorkflow.test_document_processing_workflow at 0x0000017FA5C967A0>
        keywargs   = {}
        patched    = <function TestDocumentProcessingWorkflow.test_document_processing_workflow at 0x0000017FA5C96840>
        self       = <unittest.mock._patch object at 0x0000017FA5CC8C50>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017F93F27110>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        arg        = <MagicMock name='read_text_file' id='1647454613200'>
        args       = (<test_core_workflows.TestDocumentProcessingWorkflow testMethod=test_document_processing_workflow>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017F93F26F90>
        extra_args = [<MagicMock name='read_text_file' id='1647454613200'>]
        keywargs   = {}
        patched    = <function TestDocumentProcessingWorkflow.test_document_processing_workflow at 0x0000017FA5C96840>
        patching   = <unittest.mock._patch object at 0x0000017FA5C1AD10>
        self       = <unittest.mock._patch object at 0x0000017FA5CC8C50>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA5C1AD10>
        self       = <contextlib.ExitStack object at 0x0000017F93F26F90>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA5C1AD10>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.text_chunker' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\text_chunker.py'> does not have the attribute 'TextChunker'
        local      = False
        name       = 'TextChunker'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA5C1AD10>
        target     = <module 'emailops.text_chunker' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\text_chunker.py'>
_________ TestDocumentProcessingWorkflow.test_error_recovery_workflow _________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_core_workflows.TestDocumentProcessingWorkflow testMethod=test_error_recovery_workflow>,)
        func       = <function TestDocumentProcessingWorkflow.test_error_recovery_workflow at 0x0000017FA5C96A20>
        keywargs   = {}
        patched    = <function TestDocumentProcessingWorkflow.test_error_recovery_workflow at 0x0000017FA5C96AC0>
        self       = <unittest.mock._patch object at 0x0000017FA5CC9210>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FA6528410>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        arg        = <MagicMock name='get_config' id='1647762902608'>
        args       = (<test_core_workflows.TestDocumentProcessingWorkflow testMethod=test_error_recovery_workflow>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FA6528A90>
        extra_args = [<MagicMock name='get_config' id='1647762902608'>]
        keywargs   = {}
        patched    = <function TestDocumentProcessingWorkflow.test_error_recovery_workflow at 0x0000017FA5C96AC0>
        patching   = <unittest.mock._patch object at 0x0000017FA5CC9090>
        self       = <unittest.mock._patch object at 0x0000017FA5CC9210>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA5CC9090>
        self       = <contextlib.ExitStack object at 0x0000017FA6528A90>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA5CC9090>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'embed_texts'
        local      = False
        name       = 'embed_texts'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA5CC9090>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
____________ TestEmbeddingWorkflow.test_embedding_batch_processing ____________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_core_workflows.TestEmbeddingWorkflow testMethod=test_embedding_batch_processing>,)
        func       = <function TestEmbeddingWorkflow.test_embedding_batch_processing at 0x0000017FA5C96E80>
        keywargs   = {}
        patched    = <function TestEmbeddingWorkflow.test_embedding_batch_processing at 0x0000017FA5C96F20>
        self       = <unittest.mock._patch object at 0x0000017FA5CC9A50>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FA59E7A10>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_core_workflows.TestEmbeddingWorkflow testMethod=test_embedding_batch_processing>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FA5BEE4D0>
        extra_args = []
        keywargs   = {}
        patched    = <function TestEmbeddingWorkflow.test_embedding_batch_processing at 0x0000017FA5C96F20>
        patching   = <unittest.mock._patch object at 0x0000017FA5CC9A50>
        self       = <unittest.mock._patch object at 0x0000017FA5CC9A50>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA5CC9A50>
        self       = <contextlib.ExitStack object at 0x0000017FA5BEE4D0>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA5CC9A50>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'> does not have the attribute 'llm_runtime'
        local      = False
        name       = 'llm_runtime'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA5CC9A50>
        target     = <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'>
_____________ TestEmbeddingWorkflow.test_embedding_error_handling _____________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_core_workflows.TestEmbeddingWorkflow testMethod=test_embedding_error_handling>,)
        func       = <function TestEmbeddingWorkflow.test_embedding_error_handling at 0x0000017FA5C96FC0>
        keywargs   = {}
        patched    = <function TestEmbeddingWorkflow.test_embedding_error_handling at 0x0000017FA5C97060>
        self       = <unittest.mock._patch object at 0x0000017FA5CC9CD0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FA5A08DD0>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_core_workflows.TestEmbeddingWorkflow testMethod=test_embedding_error_handling>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FA7853A90>
        extra_args = []
        keywargs   = {}
        patched    = <function TestEmbeddingWorkflow.test_embedding_error_handling at 0x0000017FA5C97060>
        patching   = <unittest.mock._patch object at 0x0000017FA5CC9CD0>
        self       = <unittest.mock._patch object at 0x0000017FA5CC9CD0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA5CC9CD0>
        self       = <contextlib.ExitStack object at 0x0000017FA7853A90>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA5CC9CD0>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'> does not have the attribute 'llm_runtime'
        local      = False
        name       = 'llm_runtime'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA5CC9CD0>
        target     = <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'>
____________ TestEmbeddingWorkflow.test_embedding_pipeline_openai _____________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_core_workflows.TestEmbeddingWorkflow testMethod=test_embedding_pipeline_openai>,)
        func       = <function TestEmbeddingWorkflow.test_embedding_pipeline_openai at 0x0000017FA5C96D40>
        keywargs   = {}
        patched    = <function TestEmbeddingWorkflow.test_embedding_pipeline_openai at 0x0000017FA5C96DE0>
        self       = <unittest.mock._patch object at 0x0000017FA5CC97D0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FA78E0810>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_core_workflows.TestEmbeddingWorkflow testMethod=test_embedding_pipeline_openai>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FA78E0AD0>
        extra_args = []
        keywargs   = {}
        patched    = <function TestEmbeddingWorkflow.test_embedding_pipeline_openai at 0x0000017FA5C96DE0>
        patching   = <unittest.mock._patch object at 0x0000017FA5CC97D0>
        self       = <unittest.mock._patch object at 0x0000017FA5CC97D0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA5CC97D0>
        self       = <contextlib.ExitStack object at 0x0000017FA78E0AD0>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA5CC97D0>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'> does not have the attribute 'llm_runtime'
        local      = False
        name       = 'llm_runtime'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA5CC97D0>
        target     = <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'>
____________ TestEmbeddingWorkflow.test_embedding_pipeline_vertex _____________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_core_workflows.TestEmbeddingWorkflow testMethod=test_embedding_pipeline_vertex>,)
        func       = <function TestEmbeddingWorkflow.test_embedding_pipeline_vertex at 0x0000017FA5C96C00>
        keywargs   = {}
        patched    = <function TestEmbeddingWorkflow.test_embedding_pipeline_vertex at 0x0000017FA5C96CA0>
        self       = <unittest.mock._patch object at 0x0000017FA5CC9590>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FA63DD610>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_core_workflows.TestEmbeddingWorkflow testMethod=test_embedding_pipeline_vertex>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FA637B0D0>
        extra_args = []
        keywargs   = {}
        patched    = <function TestEmbeddingWorkflow.test_embedding_pipeline_vertex at 0x0000017FA5C96CA0>
        patching   = <unittest.mock._patch object at 0x0000017FA5CC9590>
        self       = <unittest.mock._patch object at 0x0000017FA5CC9590>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA5CC9590>
        self       = <contextlib.ExitStack object at 0x0000017FA637B0D0>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA5CC9590>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'> does not have the attribute 'llm_runtime'
        local      = False
        name       = 'llm_runtime'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA5CC9590>
        target     = <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'>
____________ TestSecurityWorkflow.test_command_validation_workflow ____________
tests\integration\test_core_workflows.py:246: in test_command_validation_workflow
    assert not validate_command_args("rm", ["-rf", "/"])
E   AssertionError: assert not (True, 'Valid')
E    +  where (True, 'Valid') = <function validate_command_args at 0x0000017FA60C2AC0>('rm', ['-rf', '/'])
        self       = <test_core_workflows.TestSecurityWorkflow testMethod=test_command_validation_workflow>
        validate_command_args = <function validate_command_args at 0x0000017FA60C2AC0>
___________ TestSecurityWorkflow.test_environment_variable_workflow ___________
tests\integration\test_core_workflows.py:260: in test_environment_variable_workflow
    assert not validate_environment_variable("", "value")
E   AssertionError: assert not (False, 'Environment variable name cannot be empty')
E    +  where (False, 'Environment variable name cannot be empty') = <function validate_environment_variable at 0x0000017FA60C2CA0>('', 'value')
        self       = <test_core_workflows.TestSecurityWorkflow testMethod=test_environment_variable_workflow>
        validate_environment_variable = <function validate_environment_variable at 0x0000017FA60C2CA0>
_____________ TestSecurityWorkflow.test_path_validation_workflow ______________
tests\integration\test_core_workflows.py:230: in test_path_validation_workflow
    assert not validate_directory_path("../../../etc")
E   AssertionError: assert not (False, 'Path traversal detected (.. not allowed)')
E    +  where (False, 'Path traversal detected (.. not allowed)') = <function validate_directory_path at 0x0000017FA60C28E0>('../../../etc')
        self       = <test_core_workflows.TestSecurityWorkflow testMethod=test_path_validation_workflow>
        test_dir   = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmp8s61k58e/test_dir')
        test_file  = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmp8s61k58e/test_dir/test.txt')
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp8s61k58e'
        validate_directory_path = <function validate_directory_path at 0x0000017FA60C28E0>
        validate_file_path = <function validate_file_path at 0x0000017FA60C2980>
_______________ TestIndexWorkflow.test_index_creation_workflow ________________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_core_workflows.TestIndexWorkflow testMethod=test_index_creation_workflow>,)
        func       = <function TestIndexWorkflow.test_index_creation_workflow at 0x0000017FA5C96700>
        keywargs   = {}
        patched    = <function TestIndexWorkflow.test_index_creation_workflow at 0x0000017FA5C97240>
        self       = <unittest.mock._patch object at 0x0000017FA5CCA0D0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FA7888090>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_core_workflows.TestIndexWorkflow testMethod=test_index_creation_workflow>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FA788BB90>
        extra_args = []
        keywargs   = {}
        patched    = <function TestIndexWorkflow.test_index_creation_workflow at 0x0000017FA5C97240>
        patching   = <unittest.mock._patch object at 0x0000017FA5CCA0D0>
        self       = <unittest.mock._patch object at 0x0000017FA5CCA0D0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA5CCA0D0>
        self       = <contextlib.ExitStack object at 0x0000017FA788BB90>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA5CCA0D0>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'faiss'
        local      = False
        name       = 'faiss'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA5CCA0D0>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
________________ TestIndexWorkflow.test_index_repair_workflow _________________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_core_workflows.TestIndexWorkflow testMethod=test_index_repair_workflow>,)
        func       = <function TestIndexWorkflow.test_index_repair_workflow at 0x0000017FA5C97420>
        keywargs   = {}
        patched    = <function TestIndexWorkflow.test_index_repair_workflow at 0x0000017FA5C974C0>
        self       = <unittest.mock._patch object at 0x0000017FA5CCA450>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FA77B4790>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        arg        = <MagicMock name='_initialize_gcp_credentials' id='1647782348048'>
        args       = (<test_core_workflows.TestIndexWorkflow testMethod=test_index_repair_workflow>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FA77B4A50>
        extra_args = [<MagicMock name='_initialize_gcp_credentials' id='1647782348048'>]
        keywargs   = {}
        patched    = <function TestIndexWorkflow.test_index_repair_workflow at 0x0000017FA5C974C0>
        patching   = <unittest.mock._patch object at 0x0000017FA5CCA350>
        self       = <unittest.mock._patch object at 0x0000017FA5CCA450>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA5CCA350>
        self       = <contextlib.ExitStack object at 0x0000017FA77B4A50>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA5CCA350>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'embed_texts'
        local      = False
        name       = 'embed_texts'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA5CCA350>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
______________ TestMonitoringWorkflow.test_diagnostics_workflow _______________
tests\integration\test_core_workflows.py:390: in test_diagnostics_workflow
    result = test_account({"project_id": "test-project"})
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        mock_embed = <MagicMock name='embed_texts' id='1647780614416'>
        self       = <test_core_workflows.TestMonitoringWorkflow testMethod=test_diagnostics_workflow>
        test_account = <function test_account at 0x0000017FA5D34180>
diagnostics\diagnostics.py:54: in test_account
    logger.info(f"Testing Account: {account.project_id}")
                                    ^^^^^^^^^^^^^^^^^^
E   AttributeError: 'dict' object has no attribute 'project_id'
        account    = {'project_id': 'test-project'}
------------------------------ Captured log call ------------------------------
INFO     diagnostics.utils:diagnostics.py:53 
============================================================
____________ TestMonitoringWorkflow.test_index_monitoring_workflow ____________
tests\integration\test_core_workflows.py:377: in test_index_monitoring_workflow
    assert hasattr(status, 'status')
E   AssertionError: assert False
E    +  where False = hasattr(IndexStatus(root_dir='C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpnwemudm4', index_dir='C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpnwemudm4\\_index', index_exists=True, documents_indexed=2, conversations_total=0, conversations_indexed=0, progress_percent=0.0, last_updated='2025-10-10T21:02:30.719368+00:00', is_active=True, active_source='index.faiss', index_file='index.faiss', index_file_size_mb=0.0, provider=None, model=None, actual_dimensions=None, index_type=None), 'status')
        IndexMonitor = <class 'diagnostics.monitor.IndexMonitor'>
        index_dir  = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmpnwemudm4/_index')
        mapping_data = [{'doc_id': 'doc1', 'text': 'chunk1'}, {'doc_id': 'doc2', 'text': 'chunk2'}]
        monitor    = <diagnostics.monitor.IndexMonitor object at 0x0000017FA7784990>
        self       = <test_core_workflows.TestMonitoringWorkflow testMethod=test_index_monitoring_workflow>
        status     = IndexStatus(root_dir='C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpnwemudm4',
            index_dir='C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpnwemudm4\\_index',
            index_exists=True,
            documents_indexed=2,
            conversations_total=0,
            conversations_indexed=0,
            progress_percent=0.0,
            last_updated='2025-10-10T21:02:30.719368+00:00',
            is_active=True,
            active_source='index.faiss',
            index_file='index.faiss',
            index_file_size_mb=0.0,
            provider=None,
            model=None,
            actual_dimensions=None,
            index_type=None)
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpnwemudm4'
------------------------------ Captured log call ------------------------------
WARNING  emailops.index_metadata:index_metadata.py:429 No metadata found at C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpnwemudm4\\_index\\meta.json\nINFO     diagnostics.utils:monitor.py:91 \n======================================================================\n  INDEXING STATUS\n======================================================================\nINFO     diagnostics.utils:monitor.py:492 Root:       C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpnwemudm4\nINFO     diagnostics.utils:monitor.py:493 Index dir:  C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpnwemudm4\\_index\nINFO     diagnostics.utils:monitor.py:498 \nDocuments indexed:     2\nWARNING  diagnostics.utils:monitor.py:506 Conversations indexed: (unknown total)\nINFO     diagnostics.utils:monitor.py:514 Index artifact:        index.faiss  (n/a)\nINFO     diagnostics.utils:monitor.py:521 Last updated:          2025-10-11 01:02:30 Arabian Standard Time  (0 seconds ago)\nINFO     diagnostics.utils:monitor.py:528 \n\u2705 ACTIVELY INDEXING
_______________ TestMonitoringWorkflow.test_statistics_workflow _______________
tests\integration\test_core_workflows.py:416: in test_statistics_workflow
    assert stats["conversation_count"] == 1
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'conversation_count'
        att_dir    = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmpu9uvg3m9/conversation1/Attachments')
        conv_dir   = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmpu9uvg3m9/conversation1')
        get_file_statistics = <function get_file_statistics at 0x0000017FA60C0180>
        root       = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmpu9uvg3m9')
        self       = <test_core_workflows.TestMonitoringWorkflow testMethod=test_statistics_workflow>
        stats      = {'conversation_folders': 1,
 'conversation_txt_files': 1,
 'extensions': {'.docx': 1, '.pdf': 1, '.txt': 1},
 'root_path': 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpu9uvg3m9',
 'top_extensions': {'.docx': 1, '.pdf': 1, '.txt': 1},
 'total_files': 3}
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpu9uvg3m9'
------------------------------ Captured log call ------------------------------
INFO     diagnostics.utils:statistics.py:220 ================================================================================\nINFO     diagnostics.utils:statistics.py:221 FILE STATISTICS ANALYZER\nINFO     diagnostics.utils:statistics.py:222 ================================================================================\nINFO     diagnostics.utils:statistics.py:226 \n\U0001f4c1 Conversation Folders: 1\nINFO     diagnostics.utils:statistics.py:230 \U0001f4c4 Conversation.txt Files: 1\nINFO     diagnostics.utils:statistics.py:233 \n\U0001f4ca Scanning all files...\nINFO     diagnostics.utils:statistics.py:243 \u2705 Total Files Scanned: 3\nINFO     diagnostics.utils:statistics.py:245 \n\U0001f4c8 Top 20 File Extensions:\nINFO     diagnostics.utils:statistics.py:246 --------------------------------------------------------------------------------\nINFO     diagnostics.utils:statistics.py:249   .txt                        1 files ( 33.3%)\nINFO     diagnostics.utils:statistics.py:249   .pdf                        1 files ( 33.3%)\nINFO     diagnostics.utils:statistics.py:249   .docx                       1 files ( 33.3%)\nINFO     diagnostics.utils:statistics.py:251 \n================================================================================
_______ TestEmailProcessingWorkflow.test_conversation_loading_workflow ________
tests\integration\test_core_workflows.py:489: in test_conversation_loading_workflow
    assert conv["conversation_txt"] == "Email conversation content"
E   AssertionError: assert 'Email conversation content\n\n--- ATTACHMENT: test.txt ---\n\nAttachment content' == 'Email conversation content'
E     
E     - Email conversation content
E     + Email conversation content
E     ?                           +
E     + 
E     + --- ATTACHMENT: test.txt ---
E     + 
E     + Attachment content
        att_dir    = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmphky_kp5h/Attachments')
        conv       = {'attachments': [{'path': 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmphky_kp5h\\Attachments\\test.txt',
                  'text': 'Attachment content'}],
 'conversation_txt': 'Email conversation content\n'
                     '\n'
                     '--- ATTACHMENT: test.txt ---\n'
                     '\n'
                     'Attachment content',
 'manifest': {'id': 'conv123',
              'participants': ['user1@example.com', 'user2@example.com'],
              'subject': 'Test Conversation'},
 'path': 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmphky_kp5h',
 'summary': {'summary': 'This is a test conversation'}}
        conv_dir   = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmphky_kp5h')
        load_conversation = <function load_conversation at 0x0000017FA613B740>
        manifest   = {'id': 'conv123',
 'participants': ['user1@example.com', 'user2@example.com'],
 'subject': 'Test Conversation'}
        self       = <test_core_workflows.TestEmailProcessingWorkflow testMethod=test_conversation_loading_workflow>
        summary    = {'summary': 'This is a test conversation'}
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmphky_kp5h'
_________________ TestEndToEndWorkflow.test_complete_pipeline _________________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_core_workflows.TestEndToEndWorkflow testMethod=test_complete_pipeline>,)
        func       = <function TestEndToEndWorkflow.test_complete_pipeline at 0x0000017FA5C979C0>
        keywargs   = {}
        patched    = <function TestEndToEndWorkflow.test_complete_pipeline at 0x0000017FA5C97A60>
        self       = <unittest.mock._patch object at 0x0000017FA5CCAF90>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FA76E3910>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        arg        = <MagicMock name='_initialize_gcp_credentials' id='1647781485648'>
        args       = (<test_core_workflows.TestEndToEndWorkflow testMethod=test_complete_pipeline>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FA76E1ED0>
        extra_args = [<MagicMock name='_initialize_gcp_credentials' id='1647781485648'>]
        keywargs   = {}
        patched    = <function TestEndToEndWorkflow.test_complete_pipeline at 0x0000017FA5C97A60>
        patching   = <unittest.mock._patch object at 0x0000017FA5CCAE90>
        self       = <unittest.mock._patch object at 0x0000017FA5CCAF90>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA5CCAE90>
        self       = <contextlib.ExitStack object at 0x0000017FA76E1ED0>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA5CCAE90>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'embed_texts'
        local      = False
        name       = 'embed_texts'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA5CCAE90>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
___________ TestHtmlToText.test_html_to_text_without_beautifulsoup ____________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_emailops_utils.TestHtmlToText testMethod=test_html_to_text_without_beautifulsoup>,)
        func       = <function TestHtmlToText.test_html_to_text_without_beautifulsoup at 0x0000017FA6178540>
        keywargs   = {}
        patched    = <function TestHtmlToText.test_html_to_text_without_beautifulsoup at 0x0000017FA61785E0>
        self       = <unittest.mock._patch object at 0x0000017FA6159050>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB2EAB5D0>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_emailops_utils.TestHtmlToText testMethod=test_html_to_text_without_beautifulsoup>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB2EAB810>
        extra_args = []
        keywargs   = {}
        patched    = <function TestHtmlToText.test_html_to_text_without_beautifulsoup at 0x0000017FA61785E0>
        patching   = <unittest.mock._patch object at 0x0000017FA6159050>
        self       = <unittest.mock._patch object at 0x0000017FA6159050>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA6159050>
        self       = <contextlib.ExitStack object at 0x0000017FB2EAB810>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {'side_effect': <class 'ImportError'>}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA6159050>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'> does not have the attribute 'BeautifulSoup'
        local      = False
        name       = 'BeautifulSoup'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA6159050>
        target     = <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'>
_________________ TestExtractText.test_extract_text_docx_file _________________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_emailops_utils.TestExtractText testMethod=test_extract_text_docx_file>,)
        func       = <function TestExtractText.test_extract_text_docx_file at 0x0000017FA6178A40>
        keywargs   = {}
        patched    = <function TestExtractText.test_extract_text_docx_file at 0x0000017FA6178AE0>
        self       = <unittest.mock._patch object at 0x0000017FA61590D0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB31B2510>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_emailops_utils.TestExtractText testMethod=test_extract_text_docx_file>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB2D75B90>
        extra_args = []
        keywargs   = {}
        patched    = <function TestExtractText.test_extract_text_docx_file at 0x0000017FA6178AE0>
        patching   = <unittest.mock._patch object at 0x0000017FA61590D0>
        self       = <unittest.mock._patch object at 0x0000017FA61590D0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA61590D0>
        self       = <contextlib.ExitStack object at 0x0000017FB2D75B90>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA61590D0>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'> does not have the attribute 'docx'
        local      = False
        name       = 'docx'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA61590D0>
        target     = <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'>
_________________ TestExtractText.test_extract_text_pdf_file __________________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_emailops_utils.TestExtractText testMethod=test_extract_text_pdf_file>,)
        func       = <function TestExtractText.test_extract_text_pdf_file at 0x0000017FA6178B80>
        keywargs   = {}
        patched    = <function TestExtractText.test_extract_text_pdf_file at 0x0000017FA6178C20>
        self       = <unittest.mock._patch object at 0x0000017FA615BC10>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB2EBCB10>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_emailops_utils.TestExtractText testMethod=test_extract_text_pdf_file>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB2EBC7D0>
        extra_args = []
        keywargs   = {}
        patched    = <function TestExtractText.test_extract_text_pdf_file at 0x0000017FA6178C20>
        patching   = <unittest.mock._patch object at 0x0000017FA615BC10>
        self       = <unittest.mock._patch object at 0x0000017FA615BC10>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA615BC10>
        self       = <contextlib.ExitStack object at 0x0000017FB2EBC7D0>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA615BC10>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'> does not have the attribute 'PdfReader'
        local      = False
        name       = 'PdfReader'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA615BC10>
        target     = <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'>
___________ TestSplitEmailThread.test_split_email_thread_with_dates ___________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_emailops_utils.TestSplitEmailThread testMethod=test_split_email_thread_with_dates>,)
        func       = <function TestSplitEmailThread.test_split_email_thread_with_dates at 0x0000017FA6179760>
        keywargs   = {}
        patched    = <function TestSplitEmailThread.test_split_email_thread_with_dates at 0x0000017FA6179800>
        self       = <unittest.mock._patch object at 0x0000017FA6174210>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB328E2D0>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_emailops_utils.TestSplitEmailThread testMethod=test_split_email_thread_with_dates>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB328D510>
        extra_args = []
        keywargs   = {}
        patched    = <function TestSplitEmailThread.test_split_email_thread_with_dates at 0x0000017FA6179800>
        patching   = <unittest.mock._patch object at 0x0000017FA6174210>
        self       = <unittest.mock._patch object at 0x0000017FA6174210>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA6174210>
        self       = <contextlib.ExitStack object at 0x0000017FB328D510>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA6174210>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'> does not have the attribute 'parsedate_to_datetime'
        local      = False
        name       = 'parsedate_to_datetime'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA6174210>
        target     = <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'>
__________________ TestEmailParsing.test_extract_eml_success __________________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_emailops_utils.TestEmailParsing testMethod=test_extract_eml_success>,)
        func       = <function TestEmailParsing.test_extract_eml_success at 0x0000017FA617AAC0>
        keywargs   = {}
        patched    = <function TestEmailParsing.test_extract_eml_success at 0x0000017FA617AB60>
        self       = <unittest.mock._patch object at 0x0000017FA6175AD0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB2F848D0>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_emailops_utils.TestEmailParsing testMethod=test_extract_eml_success>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB2F84B90>
        extra_args = []
        keywargs   = {}
        patched    = <function TestEmailParsing.test_extract_eml_success at 0x0000017FA617AB60>
        patching   = <unittest.mock._patch object at 0x0000017FA6175AD0>
        self       = <unittest.mock._patch object at 0x0000017FA6175AD0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA6175AD0>
        self       = <contextlib.ExitStack object at 0x0000017FB2F84B90>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA6175AD0>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'> does not have the attribute 'BytesParser'
        local      = False
        name       = 'BytesParser'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA6175AD0>
        target     = <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'>
__________________ TestEmailParsing.test_extract_msg_success __________________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_emailops_utils.TestEmailParsing testMethod=test_extract_msg_success>,)
        func       = <function TestEmailParsing.test_extract_msg_success at 0x0000017FA617AC00>
        keywargs   = {}
        patched    = <function TestEmailParsing.test_extract_msg_success at 0x0000017FA617ACA0>
        self       = <unittest.mock._patch object at 0x0000017FA6175BD0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB2F86A10>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_emailops_utils.TestEmailParsing testMethod=test_extract_msg_success>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB2F86C10>
        extra_args = []
        keywargs   = {}
        patched    = <function TestEmailParsing.test_extract_msg_success at 0x0000017FA617ACA0>
        patching   = <unittest.mock._patch object at 0x0000017FA6175BD0>
        self       = <unittest.mock._patch object at 0x0000017FA6175BD0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA6175BD0>
        self       = <contextlib.ExitStack object at 0x0000017FB2F86C10>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA6175BD0>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'> does not have the attribute 'extract_msg'
        local      = False
        name       = 'extract_msg'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA6175BD0>
        target     = <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'>
_________________ TestEnvUtils.test_default_accounts_exported _________________
tests\unit\test_env_utils.py:82: in test_default_accounts_exported
    assert self.env_utils.DEFAULT_ACCOUNTS is self.mock_runtime.DEFAULT_ACCOUNTS
E   AssertionError: assert [{'project_id': 'api-agent-470921', 'credentials_path': 'secrets/api-agent-470921-4e2065b2ecf9.json'}, {'project_id': 'apt-arcana-470409-i7', 'credentials_path': 'secrets/apt-arcana-470409-i7-ce42b76061bf.json'}, {'project_id': 'embed2-474114', 'credentials_path': 'secrets/embed2-474114-fca38b4d2068.json'}, {'project_id': 'crafty-airfoil-474021-s2', 'credentials_path': 'secrets/crafty-airfoil-474021-s2-34159960925b.json'}, {'project_id': 'my-project-31635v', 'credentials_path': 'secrets/my-project-31635v-8ec357ac35b2.json'}, {'project_id': 'semiotic-nexus-470620-f3', 'credentials_path': 'secrets/semiotic-nexus-470620-f3-3240cfaf6036.json'}] is ['account1', 'account2']
E    +  where [{'project_id': 'api-agent-470921', 'credentials_path': 'secrets/api-agent-470921-4e2065b2ecf9.json'}, {'project_id': 'apt-arcana-470409-i7', 'credentials_path': 'secrets/apt-arcana-470409-i7-ce42b76061bf.json'}, {'project_id': 'embed2-474114', 'credentials_path': 'secrets/embed2-474114-fca38b4d2068.json'}, {'project_id': 'crafty-airfoil-474021-s2', 'credentials_path': 'secrets/crafty-airfoil-474021-s2-34159960925b.json'}, {'project_id': 'my-project-31635v', 'credentials_path': 'secrets/my-project-31635v-8ec357ac35b2.json'}, {'project_id': 'semiotic-nexus-470620-f3', 'credentials_path': 'secrets/semiotic-nexus-470620-f3-3240cfaf6036.json'}] = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.DEFAULT_ACCOUNTS
E    +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_default_accounts_exported>.env_utils
E    +  and   ['account1', 'account2'] = <MagicMock id='1647978612624'>.DEFAULT_ACCOUNTS
E    +    where <MagicMock id='1647978612624'> = <test_env_utils.TestEnvUtils testMethod=test_default_accounts_exported>.mock_runtime
        self       = <test_env_utils.TestEnvUtils testMethod=test_default_accounts_exported>
_________ TestEnvUtils.test_function_forwarding_with_args_and_kwargs __________
tests\unit\test_env_utils.py:165: in test_function_forwarding_with_args_and_kwargs
    result = self.env_utils.load_validated_accounts("path", force_reload=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: load_validated_accounts() got an unexpected keyword argument 'force_reload'
        self       = <test_env_utils.TestEnvUtils testMethod=test_function_forwarding_with_args_and_kwargs>
___________________ TestEnvUtils.test_init_vertex_exported ____________________
tests\unit\test_env_utils.py:88: in test_init_vertex_exported
    assert self.env_utils._init_vertex is self.mock_runtime._init_vertex
E   AssertionError: assert <function _init_vertex at 0x0000017FA5D34900> is <Mock name='mock._init_vertex' id='1647973511632'>
E    +  where <function _init_vertex at 0x0000017FA5D34900> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>._init_vertex
E    +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_init_vertex_exported>.env_utils
E    +  and   <Mock name='mock._init_vertex' id='1647973511632'> = <MagicMock id='1647975094864'>._init_vertex
E    +    where <MagicMock id='1647975094864'> = <test_env_utils.TestEnvUtils testMethod=test_init_vertex_exported>.mock_runtime
        self       = <test_env_utils.TestEnvUtils testMethod=test_init_vertex_exported>
_____________________ TestEnvUtils.test_llmerror_exported _____________________
tests\unit\test_env_utils.py:43: in test_llmerror_exported
    assert self.env_utils.LLMError is self.mock_runtime.LLMError
E   AssertionError: assert <class 'emailops.llm_runtime.LLMError'> is <class 'test_env_utils.LLMError'>
E    +  where <class 'emailops.llm_runtime.LLMError'> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.LLMError
E    +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_llmerror_exported>.env_utils
E    +  and   <class 'test_env_utils.LLMError'> = <MagicMock id='1647980686992'>.LLMError
E    +    where <MagicMock id='1647980686992'> = <test_env_utils.TestEnvUtils testMethod=test_llmerror_exported>.mock_runtime
        self       = <test_env_utils.TestEnvUtils testMethod=test_llmerror_exported>
_____________ TestEnvUtils.test_load_validated_accounts_exported ______________
tests\unit\test_env_utils.py:53: in test_load_validated_accounts_exported
    assert self.env_utils.load_validated_accounts is self.mock_runtime.load_validated_accounts
E   AssertionError: assert <function load_validated_accounts at 0x0000017FA5D342C0> is <Mock name='mock.load_validated_accounts' id='1647978336464'>
E    +  where <function load_validated_accounts at 0x0000017FA5D342C0> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.load_validated_accounts
E    +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_load_validated_accounts_exported>.env_utils
E    +  and   <Mock name='mock.load_validated_accounts' id='1647978336464'> = <MagicMock id='1647978626192'>.load_validated_accounts
E    +    where <MagicMock id='1647978626192'> = <test_env_utils.TestEnvUtils testMethod=test_load_validated_accounts_exported>.mock_runtime
        self       = <test_env_utils.TestEnvUtils testMethod=test_load_validated_accounts_exported>
______________ TestEnvUtils.test_no_additional_symbols_exported _______________
tests\unit\test_env_utils.py:144: in test_no_additional_symbols_exported
    assert not unexpected, f"Unexpected public attributes: {unexpected}"
E   AssertionError: Unexpected public attributes: {'annotations'}
E   assert not {'annotations'}
        expected_attrs = {'DEFAULT_ACCOUNTS',
 'LLMError',
 'VertexAccount',
 '__all__',
 '__annotations__',
 '__builtins__',
 '__cached__',
 '__dict__',
 '__doc__',
 '__file__',
 '__loader__',
 '__name__',
 '__package__',
 '__path__',
 '__spec__',
 '_init_vertex',
 '_rt',
 'load_validated_accounts',
 'reset_vertex_init',
 'save_validated_accounts',
 'validate_account'}
        expected_public = {'DEFAULT_ACCOUNTS',
 'LLMError',
 'VertexAccount',
 '_init_vertex',
 'load_validated_accounts',
 'reset_vertex_init',
 'save_validated_accounts',
 'validate_account'}
        module_attrs = {'DEFAULT_ACCOUNTS',
 'LLMError',
 'VertexAccount',
 '__all__',
 '__builtins__',
 '__cached__',
 '__doc__',
 '__file__',
 '__loader__',
 '__name__',
 '__package__',
 '__spec__',
 '_init_vertex',
 '_rt',
 'annotations',
 'load_validated_accounts',
 'reset_vertex_init',
 'save_validated_accounts',
 'validate_account'}
        public_attrs = {'DEFAULT_ACCOUNTS',
 'LLMError',
 'VertexAccount',
 'annotations',
 'load_validated_accounts',
 'reset_vertex_init',
 'save_validated_accounts',
 'validate_account'}
        self       = <test_env_utils.TestEnvUtils testMethod=test_no_additional_symbols_exported>
        special_attrs = {'__all__',
 '__annotations__',
 '__builtins__',
 '__cached__',
 '__dict__',
 '__doc__',
 '__file__',
 '__loader__',
 '__name__',
 '__package__',
 '__path__',
 '__spec__',
 '_rt'}
        unexpected = {'annotations'}
________________ TestEnvUtils.test_reset_vertex_init_exported _________________
tests\unit\test_env_utils.py:97: in test_reset_vertex_init_exported
    assert self.env_utils.reset_vertex_init is self.mock_runtime.reset_vertex_init
E   AssertionError: assert <function reset_vertex_init at 0x0000017FA5D34540> is <Mock name='mock.reset_vertex_init' id='1647978138256'>
E    +  where <function reset_vertex_init at 0x0000017FA5D34540> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.reset_vertex_init
E    +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_reset_vertex_init_exported>.env_utils
E    +  and   <Mock name='mock.reset_vertex_init' id='1647978138256'> = <MagicMock id='1647979598352'>.reset_vertex_init
E    +    where <MagicMock id='1647979598352'> = <test_env_utils.TestEnvUtils testMethod=test_reset_vertex_init_exported>.mock_runtime
        self       = <test_env_utils.TestEnvUtils testMethod=test_reset_vertex_init_exported>
_____________ TestEnvUtils.test_save_validated_accounts_exported ______________
tests\unit\test_env_utils.py:63: in test_save_validated_accounts_exported
    assert self.env_utils.save_validated_accounts is self.mock_runtime.save_validated_accounts
E   AssertionError: assert <function save_validated_accounts at 0x0000017FA5D347C0> is <Mock name='mock.save_validated_accounts' id='1647973996752'>
E    +  where <function save_validated_accounts at 0x0000017FA5D347C0> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.save_validated_accounts
E    +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_save_validated_accounts_exported>.env_utils
E    +  and   <Mock name='mock.save_validated_accounts' id='1647973996752'> = <MagicMock id='1647974001296'>.save_validated_accounts
E    +    where <MagicMock id='1647974001296'> = <test_env_utils.TestEnvUtils testMethod=test_save_validated_accounts_exported>.mock_runtime
        self       = <test_env_utils.TestEnvUtils testMethod=test_save_validated_accounts_exported>
_________________ TestEnvUtils.test_validate_account_exported _________________
tests\unit\test_env_utils.py:72: in test_validate_account_exported
    assert self.env_utils.validate_account is self.mock_runtime.validate_account
E   AssertionError: assert <function validate_account at 0x0000017FA5D349A0> is <Mock name='mock.validate_account' id='1647978170256'>
E    +  where <function validate_account at 0x0000017FA5D349A0> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.validate_account
E    +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_validate_account_exported>.env_utils
E    +  and   <Mock name='mock.validate_account' id='1647978170256'> = <MagicMock id='1647978181328'>.validate_account
E    +    where <MagicMock id='1647978181328'> = <test_env_utils.TestEnvUtils testMethod=test_validate_account_exported>.mock_runtime
        self       = <test_env_utils.TestEnvUtils testMethod=test_validate_account_exported>
__________________ TestEnvUtils.test_vertex_account_exported __________________
tests\unit\test_env_utils.py:48: in test_vertex_account_exported
    assert self.env_utils.VertexAccount is self.mock_runtime.VertexAccount
E   AssertionError: assert <class 'emailops.llm_runtime.VertexAccount'> is <class 'test_env_utils.VertexAccount'>
E    +  where <class 'emailops.llm_runtime.VertexAccount'> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.VertexAccount
E    +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_vertex_account_exported>.env_utils
E    +  and   <class 'test_env_utils.VertexAccount'> = <MagicMock id='1647978342480'>.VertexAccount
E    +    where <MagicMock id='1647978342480'> = <test_env_utils.TestEnvUtils testMethod=test_vertex_account_exported>.mock_runtime
        self       = <test_env_utils.TestEnvUtils testMethod=test_vertex_account_exported>
__________ TestEnvUtilsErrorHandling.test_missing_runtime_attribute ___________
tests\unit\test_env_utils.py:192: in test_missing_runtime_attribute
    with pytest.raises(AttributeError):
E   Failed: DID NOT RAISE <class 'AttributeError'>
        _          = <class 'emailops.llm_runtime.LLMError'>
        env_utils  = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>
        mock_runtime = <MagicMock id='1647759324816'>
        self       = <test_env_utils.TestEnvUtilsErrorHandling testMethod=test_missing_runtime_attribute>
________ TestEnvUtilsErrorHandling.test_runtime_function_raises_error _________
tests\unit\test_env_utils.py:212: in test_runtime_function_raises_error
    env_utils.load_validated_accounts()
        env_utils  = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>
        mock_runtime = <MagicMock id='1647974197584'>
        self       = <test_env_utils.TestEnvUtilsErrorHandling testMethod=test_runtime_function_raises_error>
emailops\llm_runtime.py:169: in load_validated_accounts
    raise LLMError(
E   emailops.llm_runtime.LLMError: No valid GCP accounts found. Provide validated_accounts.json or valid files in secrets/.
        accounts   = []
        default_accounts = None
        valid_accounts = []
        validated_file = 'validated_accounts.json'
        vf         = WindowsPath('validated_accounts.json')
_________ TestEnvUtilsErrorHandling.test_runtime_module_import_error __________
tests\unit\test_env_utils.py:220: in test_runtime_module_import_error
    with patch('emailops.env_utils.llm_runtime', side_effect=ImportError("Cannot import")):
        self       = <test_env_utils.TestEnvUtilsErrorHandling testMethod=test_runtime_module_import_error>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {'side_effect': ImportError('Cannot import')}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FB2E790D0>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> does not have the attribute 'llm_runtime'
        local      = False
        name       = 'llm_runtime'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FB2E790D0>
        target     = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>
_____________ TestEnvUtilsIntegration.test_chained_function_calls _____________
emailops\llm_runtime.py:244: in _init_vertex
    credentials = service_account.Credentials.from_service_account_file(
        cp         = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/pytest-of-ASUS/pytest-70/test_account_with_empty_embedd0/secrets/test-credentials.json')
        credentials_path = None
        location   = 'us-central1'
        project    = 'project'
        project_id = 'project'
        service_account = <module 'google.oauth2.service_account' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\google\\oauth2\\service_account.py'>
        service_account_path = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        vertexai   = <module 'vertexai' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\vertexai\\__init__.py'>
..\..\anaconda3\envs\emailops\Lib\site-packages\google\oauth2\service_account.py:264: in from_service_account_file
    info, signer = _service_account_info.from_filename(
        cls        = <class 'google.oauth2.service_account.Credentials'>
        filename   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        kwargs     = {}
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\_service_account_info.py:80: in from_filename
    return data, from_dict(data, require=require, use_rsa_signer=use_rsa_signer)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'auth_uri': 'https://accounts.google.com/o/oauth2/auth',
 'client_email': 'test@test-project.iam.gserviceaccount.com',
 'client_id': '123456789',
 'private_key': '-----BEGIN PRIVATE KEY-----\n'
                'test\n'
                '-----END PRIVATE KEY-----\n',
 'private_key_id': 'test-key-id',
 'project_id': 'test-project',
 'token_uri': 'https://oauth2.googleapis.com/token',
 'type': 'service_account'}
        filename   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        json_file  = <_io.TextIOWrapper name='C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json' mode='r' encoding='utf-8'>
        require    = ['client_email', 'token_uri']
        use_rsa_signer = True
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\_service_account_info.py:57: in from_dict
    signer = crypt.RSASigner.from_service_account_info(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'auth_uri': 'https://accounts.google.com/o/oauth2/auth',
 'client_email': 'test@test-project.iam.gserviceaccount.com',
 'client_id': '123456789',
 'private_key': '-----BEGIN PRIVATE KEY-----\n'
                'test\n'
                '-----END PRIVATE KEY-----\n',
 'private_key_id': 'test-key-id',
 'project_id': 'test-project',
 'token_uri': 'https://oauth2.googleapis.com/token',
 'type': 'service_account'}
        keys_needed = {'client_email', 'token_uri'}
        missing    = set()
        require    = ['client_email', 'token_uri']
        use_rsa_signer = True
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\crypt\base.py:109: in from_service_account_info
    return cls.from_string(
        cls        = <class 'google.auth.crypt._cryptography_rsa.RSASigner'>
        info       = {'auth_uri': 'https://accounts.google.com/o/oauth2/auth',
 'client_email': 'test@test-project.iam.gserviceaccount.com',
 'client_id': '123456789',
 'private_key': '-----BEGIN PRIVATE KEY-----\n'
                'test\n'
                '-----END PRIVATE KEY-----\n',
 'private_key_id': 'test-key-id',
 'project_id': 'test-project',
 'token_uri': 'https://oauth2.googleapis.com/token',
 'type': 'service_account'}
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\crypt\_cryptography_rsa.py:133: in from_string
    private_key = serialization.load_pem_private_key(
E   ValueError: Could not deserialize key data. The data may be in an incorrect format, it may be encrypted with an unsupported algorithm, or it may be an unsupported key type (e.g. EC curves with explicit parameters). Details: ASN.1 parsing error: invalid length
        cls        = <class 'google.auth.crypt._cryptography_rsa.RSASigner'>
        key        = b'-----BEGIN PRIVATE KEY-----\ntest\n-----END PRIVATE KEY-----\n'
        key_id     = 'test-key-id'

The above exception was the direct cause of the following exception:
tests\unit\test_env_utils.py:295: in test_chained_function_calls
    env_utils._init_vertex("project")
        env_utils  = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>
        mock_runtime = <MagicMock id='1647978043280'>
        self       = <test_env_utils.TestEnvUtilsIntegration testMethod=test_chained_function_calls>
emailops\llm_runtime.py:261: in _init_vertex
    raise LLMError(f"Failed to initialize Vertex AI SDK: {e}") from e
E   emailops.llm_runtime.LLMError: Failed to initialize Vertex AI SDK: Could not deserialize key data. The data may be in an incorrect format, it may be encrypted with an unsupported algorithm, or it may be an unsupported key type (e.g. EC curves with explicit parameters). Details: ASN.1 parsing error: invalid length
        cp         = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/pytest-of-ASUS/pytest-70/test_account_with_empty_embedd0/secrets/test-credentials.json')
        credentials_path = None
        location   = 'us-central1'
        project    = 'project'
        project_id = 'project'
        service_account = <module 'google.oauth2.service_account' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\google\\oauth2\\service_account.py'>
        service_account_path = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        vertexai   = <module 'vertexai' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\vertexai\\__init__.py'>
_________ TestEnvUtilsIntegration.test_default_accounts_modification __________
tests\unit\test_env_utils.py:272: in test_default_accounts_modification
    assert accounts == ["acc1", "acc2"]
E   AssertionError: assert [{'project_id': 'api-agent-470921', 'credentials_path': 'secrets/api-agent-470921-4e2065b2ecf9.json'}, {'project_id': 'apt-arcana-470409-i7', 'credentials_path': 'secrets/apt-arcana-470409-i7-ce42b76061bf.json'}, {'project_id': 'embed2-474114', 'credentials_path': 'secrets/embed2-474114-fca38b4d2068.json'}, {'project_id': 'crafty-airfoil-474021-s2', 'credentials_path': 'secrets/crafty-airfoil-474021-s2-34159960925b.json'}, {'project_id': 'my-project-31635v', 'credentials_path': 'secrets/my-project-31635v-8ec357ac35b2.json'}, {'project_id': 'semiotic-nexus-470620-f3', 'credentials_path': 'secrets/semiotic-nexus-470620-f3-3240cfaf6036.json'}] == ['acc1', 'acc2']
E     
E     At index 0 diff: {'project_id': 'api-agent-470921', 'credentials_path': 'secrets/api-agent-470921-4e2065b2ecf9.json'} != 'acc1'
E     Left contains 4 more items, first extra item: {'credentials_path': 'secrets/embed2-474114-fca38b4d2068.json', 'project_id': 'embed2-474114'}
E     
E     Full diff:
E       [
E     -     'acc1',
E     -     'acc2',
E     +     {
E     +         'credentials_path': 'secrets/api-agent-470921-4e2065b2ecf9.json',
E     +         'project_id': 'api-agent-470921',
E     +     },
E     +     {
E     +         'credentials_path': 'secrets/apt-arcana-470409-i7-ce42b76061bf.json',
E     +         'project_id': 'apt-arcana-470409-i7',
E     +     },
E     +     {
E     +         'credentials_path': 'secrets/embed2-474114-fca38b4d2068.json',
E     +         'project_id': 'embed2-474114',
E     +     },
E     +     {
E     +         'credentials_path': 'secrets/crafty-airfoil-474021-s2-34159960925b.json',
E     +         'project_id': 'crafty-airfoil-474021-s2',
E     +     },
E     +     {
E     +         'credentials_path': 'secrets/my-project-31635v-8ec357ac35b2.json',
E     +         'project_id': 'my-project-31635v',
E     +     },
E     +     {
E     +         'credentials_path': 'secrets/semiotic-nexus-470620-f3-3240cfaf6036.json',
E     +         'project_id': 'semiotic-nexus-470620-f3',
E     +     },
E       ]
        accounts   = [{'credentials_path': 'secrets/api-agent-470921-4e2065b2ecf9.json',
  'project_id': 'api-agent-470921'},
 {'credentials_path': 'secrets/apt-arcana-470409-i7-ce42b76061bf.json',
  'project_id': 'apt-arcana-470409-i7'},
 {'credentials_path': 'secrets/embed2-474114-fca38b4d2068.json',
  'project_id': 'embed2-474114'},
 {'credentials_path': 'secrets/crafty-airfoil-474021-s2-34159960925b.json',
  'project_id': 'crafty-airfoil-474021-s2'},
 {'credentials_path': 'secrets/my-project-31635v-8ec357ac35b2.json',
  'project_id': 'my-project-31635v'},
 {'credentials_path': 'secrets/semiotic-nexus-470620-f3-3240cfaf6036.json',
  'project_id': 'semiotic-nexus-470620-f3'}]
        env_utils  = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>
        mock_runtime = <MagicMock id='1647977281168'>
        self       = <test_env_utils.TestEnvUtilsIntegration testMethod=test_default_accounts_modification>
__________ TestEnvUtilsIntegration.test_vertex_account_instantiation __________
tests\unit\test_env_utils.py:251: in test_vertex_account_instantiation
    account = env_utils.VertexAccount("test-project", credentials="creds")  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: VertexAccount.__init__() got an unexpected keyword argument 'credentials'
        MockVertexAccount = <class 'test_env_utils.TestEnvUtilsIntegration.test_vertex_account_instantiation.<locals>.MockVertexAccount'>
        env_utils  = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>
        mock_runtime = <MagicMock id='1647979469392'>
        self       = <test_env_utils.TestEnvUtilsIntegration testMethod=test_vertex_account_instantiation>
______________________ TestLLMClient.test_complete_alias ______________________
tests\unit\test_llm_client.py:77: in test_complete_alias
    result = self.llm_client.complete("prompt")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self       = <test_llm_client.TestLLMClient testMethod=test_complete_alias>
emailops\llm_client.py:64: in complete
    return complete_text(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = ('prompt',)
        kwargs     = {}
emailops\llm_client.py:43: in complete_text
    return _rt_attr("complete_text")(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: complete_text() missing 1 required positional argument: 'user'
        args       = ('prompt',)
        kwargs     = {}
______________________ TestLLMClient.test_complete_json _______________________
tests\unit\test_llm_client.py:60: in test_complete_json
    result = self.llm_client.complete_json("prompt", schema={"type": "object"})
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self       = <test_llm_client.TestLLMClient testMethod=test_complete_json>
emailops\llm_client.py:51: in complete_json
    return _rt_attr("complete_json")(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: complete_json() got an unexpected keyword argument 'schema'
        args       = ('prompt',)
        kwargs     = {'schema': {'type': 'object'}}
______________________ TestLLMClient.test_complete_text _______________________
tests\unit\test_llm_client.py:52: in test_complete_text
    result = self.llm_client.complete_text("prompt", temperature=0.7)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self       = <test_llm_client.TestLLMClient testMethod=test_complete_text>
emailops\llm_client.py:43: in complete_text
    return _rt_attr("complete_text")(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: complete_text() missing 1 required positional argument: 'user'
        args       = ('prompt',)
        kwargs     = {'temperature': 0.7}
__________________ TestLLMClient.test_dir_returns_sorted_all __________________
tests\unit\test_llm_client.py:263: in test_dir_returns_sorted_all
    assert "zebra_func" in dir_result
E   AssertionError: assert 'zebra_func' in ['LLMError', 'complete', 'complete_json', 'complete_text', 'embed', 'embed_texts', 'json_complete']
        dir_result = ['LLMError',
 'complete',
 'complete_json',
 'complete_text',
 'embed',
 'embed_texts',
 'json_complete']
        self       = <test_llm_client.TestLLMClient testMethod=test_dir_returns_sorted_all>
_______________________ TestLLMClient.test_embed_texts ________________________
tests\unit\test_llm_client.py:69: in test_embed_texts
    result = self.llm_client.embed_texts(texts, provider="openai")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self       = <test_llm_client.TestLLMClient testMethod=test_embed_texts>
        texts      = ['text1', 'text2']
emailops\llm_client.py:58: in embed_texts
    return _rt_attr("embed_texts")(texts, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        kwargs     = {'provider': 'openai'}
        texts      = ['text1', 'text2']
emailops\llm_runtime.py:553: in embed_texts
    return _embed_openai(texts, model=model)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        _          = {}
        model      = None
        provider   = 'openai'
        texts      = ['text1', 'text2']
emailops\llm_runtime.py:689: in _embed_openai
    raise LLMError("Set OPENAI_API_KEY")
E   emailops.llm_runtime.LLMError: Set OPENAI_API_KEY
        OpenAI     = <class 'openai.OpenAI'>
        api_key    = None
        model      = None
        texts      = ['text1', 'text2']
___________________ TestLLMClient.test_embed_with_generator ___________________
emailops\llm_runtime.py:244: in _init_vertex
    credentials = service_account.Credentials.from_service_account_file(
        cp         = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/pytest-of-ASUS/pytest-70/test_account_with_empty_embedd0/secrets/test-credentials.json')
        credentials_path = None
        location   = 'us-central1'
        project    = 'valid-project-123'
        project_id = None
        service_account = <module 'google.oauth2.service_account' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\google\\oauth2\\service_account.py'>
        service_account_path = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        vertexai   = <module 'vertexai' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\vertexai\\__init__.py'>
..\..\anaconda3\envs\emailops\Lib\site-packages\google\oauth2\service_account.py:264: in from_service_account_file
    info, signer = _service_account_info.from_filename(
        cls        = <class 'google.oauth2.service_account.Credentials'>
        filename   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        kwargs     = {}
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\_service_account_info.py:80: in from_filename
    return data, from_dict(data, require=require, use_rsa_signer=use_rsa_signer)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'auth_uri': 'https://accounts.google.com/o/oauth2/auth',
 'client_email': 'test@test-project.iam.gserviceaccount.com',
 'client_id': '123456789',
 'private_key': '-----BEGIN PRIVATE KEY-----\n'
                'test\n'
                '-----END PRIVATE KEY-----\n',
 'private_key_id': 'test-key-id',
 'project_id': 'test-project',
 'token_uri': 'https://oauth2.googleapis.com/token',
 'type': 'service_account'}
        filename   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        json_file  = <_io.TextIOWrapper name='C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json' mode='r' encoding='utf-8'>
        require    = ['client_email', 'token_uri']
        use_rsa_signer = True
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\_service_account_info.py:57: in from_dict
    signer = crypt.RSASigner.from_service_account_info(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'auth_uri': 'https://accounts.google.com/o/oauth2/auth',
 'client_email': 'test@test-project.iam.gserviceaccount.com',
 'client_id': '123456789',
 'private_key': '-----BEGIN PRIVATE KEY-----\n'
                'test\n'
                '-----END PRIVATE KEY-----\n',
 'private_key_id': 'test-key-id',
 'project_id': 'test-project',
 'token_uri': 'https://oauth2.googleapis.com/token',
 'type': 'service_account'}
        keys_needed = {'client_email', 'token_uri'}
        missing    = set()
        require    = ['client_email', 'token_uri']
        use_rsa_signer = True
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\crypt\base.py:109: in from_service_account_info
    return cls.from_string(
        cls        = <class 'google.auth.crypt._cryptography_rsa.RSASigner'>
        info       = {'auth_uri': 'https://accounts.google.com/o/oauth2/auth',
 'client_email': 'test@test-project.iam.gserviceaccount.com',
 'client_id': '123456789',
 'private_key': '-----BEGIN PRIVATE KEY-----\n'
                'test\n'
                '-----END PRIVATE KEY-----\n',
 'private_key_id': 'test-key-id',
 'project_id': 'test-project',
 'token_uri': 'https://oauth2.googleapis.com/token',
 'type': 'service_account'}
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\crypt\_cryptography_rsa.py:133: in from_string
    private_key = serialization.load_pem_private_key(
E   ValueError: Could not deserialize key data. The data may be in an incorrect format, it may be encrypted with an unsupported algorithm, or it may be an unsupported key type (e.g. EC curves with explicit parameters). Details: ASN.1 parsing error: invalid length
        cls        = <class 'google.auth.crypt._cryptography_rsa.RSASigner'>
        key        = b'-----BEGIN PRIVATE KEY-----\ntest\n-----END PRIVATE KEY-----\n'
        key_id     = 'test-key-id'

The above exception was the direct cause of the following exception:
tests\unit\test_llm_client.py:106: in test_embed_with_generator
    result = self.llm_client.embed(text_generator())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self       = <test_llm_client.TestLLMClient testMethod=test_embed_with_generator>
        text_generator = <function TestLLMClient.test_embed_with_generator.<locals>.text_generator at 0x0000017FB3EA7BA0>
emailops\llm_client.py:90: in embed
    return embed_texts(seq, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
        kwargs     = {}
        seq        = ['text1', 'text2']
        texts      = <generator object TestLLMClient.test_embed_with_generator.<locals>.text_generator at 0x0000017FB3F29B10>
emailops\llm_client.py:58: in embed_texts
    return _rt_attr("embed_texts")(texts, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        kwargs     = {}
        texts      = ['text1', 'text2']
emailops\llm_runtime.py:551: in embed_texts
    return _embed_vertex(texts, model=model)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        _          = {}
        model      = None
        provider   = 'vertex'
        texts      = ['text1', 'text2']
emailops\llm_runtime.py:568: in _embed_vertex
    _init_vertex()
        model      = None
        texts      = ['text1', 'text2']
emailops\llm_runtime.py:261: in _init_vertex
    raise LLMError(f"Failed to initialize Vertex AI SDK: {e}") from e
E   emailops.llm_runtime.LLMError: Failed to initialize Vertex AI SDK: Could not deserialize key data. The data may be in an incorrect format, it may be encrypted with an unsupported algorithm, or it may be an unsupported key type (e.g. EC curves with explicit parameters). Details: ASN.1 parsing error: invalid length
        cp         = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/pytest-of-ASUS/pytest-70/test_account_with_empty_embedd0/secrets/test-credentials.json')
        credentials_path = None
        location   = 'us-central1'
        project    = 'valid-project-123'
        project_id = None
        service_account = <module 'google.oauth2.service_account' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\google\\oauth2\\service_account.py'>
        service_account_path = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        vertexai   = <module 'vertexai' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\vertexai\\__init__.py'>
_____________________ TestLLMClient.test_embed_with_list ______________________
emailops\llm_runtime.py:244: in _init_vertex
    credentials = service_account.Credentials.from_service_account_file(
        cp         = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/pytest-of-ASUS/pytest-70/test_account_with_empty_embedd0/secrets/test-credentials.json')
        credentials_path = None
        location   = 'us-central1'
        project    = 'valid-project-123'
        project_id = None
        service_account = <module 'google.oauth2.service_account' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\google\\oauth2\\service_account.py'>
        service_account_path = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        vertexai   = <module 'vertexai' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\vertexai\\__init__.py'>
..\..\anaconda3\envs\emailops\Lib\site-packages\google\oauth2\service_account.py:264: in from_service_account_file
    info, signer = _service_account_info.from_filename(
        cls        = <class 'google.oauth2.service_account.Credentials'>
        filename   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        kwargs     = {}
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\_service_account_info.py:80: in from_filename
    return data, from_dict(data, require=require, use_rsa_signer=use_rsa_signer)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'auth_uri': 'https://accounts.google.com/o/oauth2/auth',
 'client_email': 'test@test-project.iam.gserviceaccount.com',
 'client_id': '123456789',
 'private_key': '-----BEGIN PRIVATE KEY-----\n'
                'test\n'
                '-----END PRIVATE KEY-----\n',
 'private_key_id': 'test-key-id',
 'project_id': 'test-project',
 'token_uri': 'https://oauth2.googleapis.com/token',
 'type': 'service_account'}
        filename   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        json_file  = <_io.TextIOWrapper name='C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json' mode='r' encoding='utf-8'>
        require    = ['client_email', 'token_uri']
        use_rsa_signer = True
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\_service_account_info.py:57: in from_dict
    signer = crypt.RSASigner.from_service_account_info(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'auth_uri': 'https://accounts.google.com/o/oauth2/auth',
 'client_email': 'test@test-project.iam.gserviceaccount.com',
 'client_id': '123456789',
 'private_key': '-----BEGIN PRIVATE KEY-----\n'
                'test\n'
                '-----END PRIVATE KEY-----\n',
 'private_key_id': 'test-key-id',
 'project_id': 'test-project',
 'token_uri': 'https://oauth2.googleapis.com/token',
 'type': 'service_account'}
        keys_needed = {'client_email', 'token_uri'}
        missing    = set()
        require    = ['client_email', 'token_uri']
        use_rsa_signer = True
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\crypt\base.py:109: in from_service_account_info
    return cls.from_string(
        cls        = <class 'google.auth.crypt._cryptography_rsa.RSASigner'>
        info       = {'auth_uri': 'https://accounts.google.com/o/oauth2/auth',
 'client_email': 'test@test-project.iam.gserviceaccount.com',
 'client_id': '123456789',
 'private_key': '-----BEGIN PRIVATE KEY-----\n'
                'test\n'
                '-----END PRIVATE KEY-----\n',
 'private_key_id': 'test-key-id',
 'project_id': 'test-project',
 'token_uri': 'https://oauth2.googleapis.com/token',
 'type': 'service_account'}
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\crypt\_cryptography_rsa.py:133: in from_string
    private_key = serialization.load_pem_private_key(
E   ValueError: Could not deserialize key data. The data may be in an incorrect format, it may be encrypted with an unsupported algorithm, or it may be an unsupported key type (e.g. EC curves with explicit parameters). Details: ASN.1 parsing error: invalid length
        cls        = <class 'google.auth.crypt._cryptography_rsa.RSASigner'>
        key        = b'-----BEGIN PRIVATE KEY-----\ntest\n-----END PRIVATE KEY-----\n'
        key_id     = 'test-key-id'

The above exception was the direct cause of the following exception:
tests\unit\test_llm_client.py:93: in test_embed_with_list
    result = self.llm_client.embed(["text1", "text2"])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self       = <test_llm_client.TestLLMClient testMethod=test_embed_with_list>
emailops\llm_client.py:90: in embed
    return embed_texts(seq, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
        kwargs     = {}
        seq        = ['text1', 'text2']
        texts      = ['text1', 'text2']
emailops\llm_client.py:58: in embed_texts
    return _rt_attr("embed_texts")(texts, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        kwargs     = {}
        texts      = ['text1', 'text2']
emailops\llm_runtime.py:551: in embed_texts
    return _embed_vertex(texts, model=model)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        _          = {}
        model      = None
        provider   = 'vertex'
        texts      = ['text1', 'text2']
emailops\llm_runtime.py:568: in _embed_vertex
    _init_vertex()
        model      = None
        texts      = ['text1', 'text2']
emailops\llm_runtime.py:261: in _init_vertex
    raise LLMError(f"Failed to initialize Vertex AI SDK: {e}") from e
E   emailops.llm_runtime.LLMError: Failed to initialize Vertex AI SDK: Could not deserialize key data. The data may be in an incorrect format, it may be encrypted with an unsupported algorithm, or it may be an unsupported key type (e.g. EC curves with explicit parameters). Details: ASN.1 parsing error: invalid length
        cp         = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/pytest-of-ASUS/pytest-70/test_account_with_empty_embedd0/secrets/test-credentials.json')
        credentials_path = None
        location   = 'us-central1'
        project    = 'valid-project-123'
        project_id = None
        service_account = <module 'google.oauth2.service_account' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\google\\oauth2\\service_account.py'>
        service_account_path = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        vertexai   = <module 'vertexai' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\vertexai\\__init__.py'>
_____________________ TestLLMClient.test_embed_with_tuple _____________________
emailops\llm_runtime.py:244: in _init_vertex
    credentials = service_account.Credentials.from_service_account_file(
        cp         = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/pytest-of-ASUS/pytest-70/test_account_with_empty_embedd0/secrets/test-credentials.json')
        credentials_path = None
        location   = 'us-central1'
        project    = 'valid-project-123'
        project_id = None
        service_account = <module 'google.oauth2.service_account' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\google\\oauth2\\service_account.py'>
        service_account_path = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        vertexai   = <module 'vertexai' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\vertexai\\__init__.py'>
..\..\anaconda3\envs\emailops\Lib\site-packages\google\oauth2\service_account.py:264: in from_service_account_file
    info, signer = _service_account_info.from_filename(
        cls        = <class 'google.oauth2.service_account.Credentials'>
        filename   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        kwargs     = {}
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\_service_account_info.py:80: in from_filename
    return data, from_dict(data, require=require, use_rsa_signer=use_rsa_signer)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'auth_uri': 'https://accounts.google.com/o/oauth2/auth',
 'client_email': 'test@test-project.iam.gserviceaccount.com',
 'client_id': '123456789',
 'private_key': '-----BEGIN PRIVATE KEY-----\n'
                'test\n'
                '-----END PRIVATE KEY-----\n',
 'private_key_id': 'test-key-id',
 'project_id': 'test-project',
 'token_uri': 'https://oauth2.googleapis.com/token',
 'type': 'service_account'}
        filename   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        json_file  = <_io.TextIOWrapper name='C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json' mode='r' encoding='utf-8'>
        require    = ['client_email', 'token_uri']
        use_rsa_signer = True
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\_service_account_info.py:57: in from_dict
    signer = crypt.RSASigner.from_service_account_info(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'auth_uri': 'https://accounts.google.com/o/oauth2/auth',
 'client_email': 'test@test-project.iam.gserviceaccount.com',
 'client_id': '123456789',
 'private_key': '-----BEGIN PRIVATE KEY-----\n'
                'test\n'
                '-----END PRIVATE KEY-----\n',
 'private_key_id': 'test-key-id',
 'project_id': 'test-project',
 'token_uri': 'https://oauth2.googleapis.com/token',
 'type': 'service_account'}
        keys_needed = {'client_email', 'token_uri'}
        missing    = set()
        require    = ['client_email', 'token_uri']
        use_rsa_signer = True
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\crypt\base.py:109: in from_service_account_info
    return cls.from_string(
        cls        = <class 'google.auth.crypt._cryptography_rsa.RSASigner'>
        info       = {'auth_uri': 'https://accounts.google.com/o/oauth2/auth',
 'client_email': 'test@test-project.iam.gserviceaccount.com',
 'client_id': '123456789',
 'private_key': '-----BEGIN PRIVATE KEY-----\n'
                'test\n'
                '-----END PRIVATE KEY-----\n',
 'private_key_id': 'test-key-id',
 'project_id': 'test-project',
 'token_uri': 'https://oauth2.googleapis.com/token',
 'type': 'service_account'}
..\..\anaconda3\envs\emailops\Lib\site-packages\google\auth\crypt\_cryptography_rsa.py:133: in from_string
    private_key = serialization.load_pem_private_key(
E   ValueError: Could not deserialize key data. The data may be in an incorrect format, it may be encrypted with an unsupported algorithm, or it may be an unsupported key type (e.g. EC curves with explicit parameters). Details: ASN.1 parsing error: invalid length
        cls        = <class 'google.auth.crypt._cryptography_rsa.RSASigner'>
        key        = b'-----BEGIN PRIVATE KEY-----\ntest\n-----END PRIVATE KEY-----\n'
        key_id     = 'test-key-id'

The above exception was the direct cause of the following exception:
tests\unit\test_llm_client.py:114: in test_embed_with_tuple
    result = self.llm_client.embed(("text1", "text2"))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self       = <test_llm_client.TestLLMClient testMethod=test_embed_with_tuple>
emailops\llm_client.py:90: in embed
    return embed_texts(seq, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
        kwargs     = {}
        seq        = ['text1', 'text2']
        texts      = ('text1', 'text2')
emailops\llm_client.py:58: in embed_texts
    return _rt_attr("embed_texts")(texts, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        kwargs     = {}
        texts      = ['text1', 'text2']
emailops\llm_runtime.py:551: in embed_texts
    return _embed_vertex(texts, model=model)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        _          = {}
        model      = None
        provider   = 'vertex'
        texts      = ['text1', 'text2']
emailops\llm_runtime.py:568: in _embed_vertex
    _init_vertex()
        model      = None
        texts      = ['text1', 'text2']
emailops\llm_runtime.py:261: in _init_vertex
    raise LLMError(f"Failed to initialize Vertex AI SDK: {e}") from e
E   emailops.llm_runtime.LLMError: Failed to initialize Vertex AI SDK: Could not deserialize key data. The data may be in an incorrect format, it may be encrypted with an unsupported algorithm, or it may be an unsupported key type (e.g. EC curves with explicit parameters). Details: ASN.1 parsing error: invalid length
        cp         = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/pytest-of-ASUS/pytest-70/test_account_with_empty_embedd0/secrets/test-credentials.json')
        credentials_path = None
        location   = 'us-central1'
        project    = 'valid-project-123'
        project_id = None
        service_account = <module 'google.oauth2.service_account' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\google\\oauth2\\service_account.py'>
        service_account_path = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\pytest-of-ASUS\\pytest-70\\test_account_with_empty_embedd0\\secrets\\test-credentials.json'
        vertexai   = <module 'vertexai' from 'C:\\Users\\ASUS\\anaconda3\\envs\\emailops\\Lib\\site-packages\\vertexai\\__init__.py'>
_________________ TestLLMClient.test_getattr_all_deduplicates _________________
tests\unit\test_llm_client.py:225: in test_getattr_all_deduplicates
    assert "new_func" in all_exports
E   AssertionError: assert 'new_func' in ['complete_text', 'complete_json', 'embed_texts', 'complete', 'json_complete', 'embed', 'LLMError']
        all_exports = ['complete_text',
 'complete_json',
 'embed_texts',
 'complete',
 'json_complete',
 'embed',
 'LLMError']
        self       = <test_llm_client.TestLLMClient testMethod=test_getattr_all_deduplicates>
________________ TestLLMClient.test_getattr_all_with_llmerror _________________
tests\unit\test_llm_client.py:200: in test_getattr_all_with_llmerror
    assert "extra_func" in all_exports
E   AssertionError: assert 'extra_func' in ['complete_text', 'complete_json', 'embed_texts', 'complete', 'json_complete', 'embed', 'LLMError']
        all_exports = ['complete_text',
 'complete_json',
 'embed_texts',
 'complete',
 'json_complete',
 'embed',
 'LLMError']
        self       = <test_llm_client.TestLLMClient testMethod=test_getattr_all_with_llmerror>
_______________ TestLLMClient.test_getattr_all_without_llmerror _______________
tests\unit\test_llm_client.py:212: in test_getattr_all_without_llmerror
    assert "LLMError" not in all_exports
E   AssertionError: assert 'LLMError' not in ['complete_text', 'complete_json', 'embed_texts', 'complete', 'json_complete', 'embed', 'LLMError']
        all_exports = ['complete_text',
 'complete_json',
 'embed_texts',
 'complete',
 'json_complete',
 'embed',
 'LLMError']
        self       = <test_llm_client.TestLLMClient testMethod=test_getattr_all_without_llmerror>
_______________ TestLLMClient.test_getattr_forwards_to_runtime ________________
emailops\llm_client.py:153: in __getattr__
    return getattr(_rt, name)
           ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'emailops.llm_runtime' has no attribute 'special_func'
        name       = 'special_func'

The above exception was the direct cause of the following exception:
tests\unit\test_llm_client.py:231: in test_getattr_forwards_to_runtime
    result = self.llm_client.__getattr__("special_func")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self       = <test_llm_client.TestLLMClient testMethod=test_getattr_forwards_to_runtime>
emailops\llm_client.py:155: in __getattr__
    raise AttributeError(
E   AttributeError: module 'emailops.llm_client' has no attribute 'special_func'
        name       = 'special_func'
_____________________ TestLLMClient.test_getattr_llmerror _____________________
tests\unit\test_llm_client.py:242: in test_getattr_llmerror
    assert error_class is CustomError
E   AssertionError: assert <class 'emailops.llm_runtime.LLMError'> is <class 'test_llm_client.TestLLMClient.test_getattr_llmerror.<locals>.CustomError'>
        CustomError = <class 'test_llm_client.TestLLMClient.test_getattr_llmerror.<locals>.CustomError'>
        error_class = <class 'emailops.llm_runtime.LLMError'>
        self       = <test_llm_client.TestLLMClient testMethod=test_getattr_llmerror>
___________________ TestLLMClient.test_json_complete_alias ____________________
tests\unit\test_llm_client.py:85: in test_json_complete_alias
    result = self.llm_client.json_complete("prompt")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self       = <test_llm_client.TestLLMClient testMethod=test_json_complete_alias>
emailops\llm_client.py:69: in json_complete
    return complete_json(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = ('prompt',)
        kwargs     = {}
emailops\llm_client.py:51: in complete_json
    return _rt_attr("complete_json")(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: complete_json() missing 1 required positional argument: 'user'
        args       = ('prompt',)
        kwargs     = {}
_____________________ TestLLMClient.test_rt_attr_success ______________________
emailops\llm_client.py:32: in _rt_attr
    return getattr(_rt, name)
           ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'emailops.llm_runtime' has no attribute 'test_func'
        name       = 'test_func'

The above exception was the direct cause of the following exception:
tests\unit\test_llm_client.py:39: in test_rt_attr_success
    result = self.llm_client._rt_attr("test_func")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self       = <test_llm_client.TestLLMClient testMethod=test_rt_attr_success>
emailops\llm_client.py:34: in _rt_attr
    raise AttributeError(f"llm_runtime.{name} is not available") from exc
E   AttributeError: llm_runtime.test_func is not available
        name       = 'test_func'
___________ TestLLMClient.test_runtime_exports_filters_non_strings ____________
tests\unit\test_llm_client.py:165: in test_runtime_exports_filters_non_strings
    assert exports == ["func1", "func2"]
E   AssertionError: assert [] == ['func1', 'func2']
E     
E     Right contains 2 more items, first extra item: 'func1'
E     
E     Full diff:
E     + []
E     - [
E     -     'func1',
E     -     'func2',
E     - ]
        exports    = []
        self       = <test_llm_client.TestLLMClient testMethod=test_runtime_exports_filters_non_strings>
______________ TestLLMClient.test_runtime_exports_with_iterable _______________
tests\unit\test_llm_client.py:171: in test_runtime_exports_with_iterable
    assert set(exports) == {"func1", "func2"}
E   AssertionError: assert set() == {'func1', 'func2'}
E     
E     Extra items in the right set:
E     'func1'
E     'func2'
E     
E     Full diff:
E     + set()
E     - {
E     -     'func1',
E     -     'func2',
E     - }
        exports    = []
        self       = <test_llm_client.TestLLMClient testMethod=test_runtime_exports_with_iterable>
________________ TestLLMClient.test_runtime_exports_with_list _________________
tests\unit\test_llm_client.py:153: in test_runtime_exports_with_list
    assert exports == ["func1", "func2", "LLMError"]
E   AssertionError: assert [] == ['func1', 'func2', 'LLMError']
E     
E     Right contains 3 more items, first extra item: 'func1'
E     
E     Full diff:
E     + []
E     - [
E     -     'func1',
E     -     'func2',
E     -     'LLMError',
E     - ]
        exports    = []
        self       = <test_llm_client.TestLLMClient testMethod=test_runtime_exports_with_list>
________________ TestLLMClient.test_runtime_exports_with_tuple ________________
tests\unit\test_llm_client.py:159: in test_runtime_exports_with_tuple
    assert exports == ["func1", "func2"]
E   AssertionError: assert [] == ['func1', 'func2']
E     
E     Right contains 2 more items, first extra item: 'func1'
E     
E     Full diff:
E     + []
E     - [
E     -     'func1',
E     -     'func2',
E     - ]
        exports    = []
        self       = <test_llm_client.TestLLMClient testMethod=test_runtime_exports_with_tuple>
_________ TestLLMClientIntegration.test_complete_text_error_handling __________
tests\unit\test_llm_client.py:289: in test_complete_text_error_handling
    llm_client.complete_text("prompt")
        llm_client = <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'>
        mock_runtime = <MagicMock id='1647473339856'>
        self       = <test_llm_client.TestLLMClientIntegration testMethod=test_complete_text_error_handling>
emailops\llm_client.py:43: in complete_text
    return _rt_attr("complete_text")(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: complete_text() missing 1 required positional argument: 'user'
        args       = ('prompt',)
        kwargs     = {}
_______________ TestLLMClientIntegration.test_embed_empty_list ________________
tests\unit\test_llm_client.py:300: in test_embed_empty_list
    mock_runtime.embed_texts.assert_called_once_with([])
        llm_client = <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'>
        mock_runtime = <MagicMock id='1647992945808'>
        result     = array([], shape=(0, 0), dtype=float32)
        self       = <test_llm_client.TestLLMClientIntegration testMethod=test_embed_empty_list>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:950: in assert_called_once_with
    raise AssertionError(msg)
E   AssertionError: Expected 'embed_texts' to be called once. Called 0 times.
        args       = ([],)
        kwargs     = {}
        msg        = "Expected 'embed_texts' to be called once. Called 0 times."
        self       = <Mock name='mock.embed_texts' id='1647992933264'>
__________ TestLLMClientIntegration.test_multiple_kwargs_forwarding ___________
tests\unit\test_llm_client.py:311: in test_multiple_kwargs_forwarding
    llm_client.complete_text(
        llm_client = <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'>
        mock_runtime = <MagicMock id='1647994978512'>
        self       = <test_llm_client.TestLLMClientIntegration testMethod=test_multiple_kwargs_forwarding>
emailops\llm_client.py:43: in complete_text
    return _rt_attr("complete_text")(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: complete_text() got an unexpected keyword argument 'max_tokens'
        args       = ('prompt',)
        kwargs     = {'custom_param': 'value', 'max_tokens': 100, 'temperature': 0.7, 'top_p': 0.9}
____ TestLLMClientIntegration.test_runtime_attribute_caching_not_performed ____
emailops\llm_client.py:153: in __getattr__
    return getattr(_rt, name)
           ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'emailops.llm_runtime' has no attribute 'dynamic_func'
        name       = 'dynamic_func'

The above exception was the direct cause of the following exception:
tests\unit\test_llm_client.py:339: in test_runtime_attribute_caching_not_performed
    f1 = llm_client.__getattr__("dynamic_func")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func_v1    = <Mock name='mock.dynamic_func' id='1647988766352'>
        llm_client = <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'>
        mock_runtime = <MagicMock id='1647988760464'>
        self       = <test_llm_client.TestLLMClientIntegration testMethod=test_runtime_attribute_caching_not_performed>
emailops\llm_client.py:155: in __getattr__
    raise AttributeError(
E   AttributeError: module 'emailops.llm_client' has no attribute 'dynamic_func'
        name       = 'dynamic_func'
___________ TestLLMClientEdgeCases.test_embed_with_empty_generator ____________
tests\unit\test_llm_client.py:383: in test_embed_with_empty_generator
    mock_runtime.embed_texts.assert_called_once_with([])
        empty_gen  = <function TestLLMClientEdgeCases.test_embed_with_empty_generator.<locals>.empty_gen at 0x0000017FB3EA7BA0>
        llm_client = <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'>
        mock_runtime = <MagicMock id='1647987050896'>
        result     = array([], shape=(0, 0), dtype=float32)
        self       = <test_llm_client.TestLLMClientEdgeCases testMethod=test_embed_with_empty_generator>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:950: in assert_called_once_with
    raise AssertionError(msg)
E   AssertionError: Expected 'embed_texts' to be called once. Called 0 times.
        args       = ([],)
        kwargs     = {}
        msg        = "Expected 'embed_texts' to be called once. Called 0 times."
        self       = <Mock name='mock.embed_texts' id='1647987054992'>
________ TestHelperFunctions.test_initialize_gcp_credentials_from_env _________
tests\unit\test_processor.py:263: in test_initialize_gcp_credentials_from_env
    assert result == cred_path
E   AssertionError: assert '\\path\\to\\creds.json' == '/path/to/creds.json'
E     
E     - /path/to/creds.json
E     ? ^    ^  ^
E     + \path\to\creds.json
E     ? ^    ^  ^
        cred_path  = '/path/to/creds.json'
        mock_exists = <MagicMock name='exists' id='1647994112592'>
        mock_logging = <MagicMock name='logging' id='1647993029648'>
        result     = '\\path\\to\\creds.json'
        self       = <test_processor.TestHelperFunctions testMethod=test_initialize_gcp_credentials_from_env>
_________ TestHelperFunctions.test_initialize_gcp_credentials_no_env __________
tests\unit\test_processor.py:242: in test_initialize_gcp_credentials_no_env
    with patch('processing.processor.get_config') as mock_get_config:
        mock_exists = <MagicMock name='exists' id='1647989324112'>
        mock_logging = <MagicMock name='logging' id='1647988926608'>
        self       = <test_processor.TestHelperFunctions testMethod=test_initialize_gcp_credentials_no_env>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FB3D16C90>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
        local      = False
        name       = 'get_config'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FB3D16C90>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
_____________ TestUnifiedProcessor.test_build_chunk_config_kwargs _____________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_build_chunk_config_kwargs>,)
        func       = <function TestUnifiedProcessor.test_build_chunk_config_kwargs at 0x0000017FA63027A0>
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_build_chunk_config_kwargs at 0x0000017FA6302840>
        self       = <unittest.mock._patch object at 0x0000017FA62F3B10>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB3C8DB10>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_build_chunk_config_kwargs>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB3C2F310>
        extra_args = []
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_build_chunk_config_kwargs at 0x0000017FA6302840>
        patching   = <unittest.mock._patch object at 0x0000017FA62F3B10>
        self       = <unittest.mock._patch object at 0x0000017FA62F3B10>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA62F3B10>
        self       = <contextlib.ExitStack object at 0x0000017FB3C2F310>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA62F3B10>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
        local      = False
        name       = 'get_config'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA62F3B10>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
_____________ TestUnifiedProcessor.test_distribute_chunking_work ______________
..\..\anaconda3\envs\emailops\Lib\shutil.py:632: in _rmtree_unsafe
    os.unlink(fullname)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3\\_chunks\\_chunker_state\\chunk_20251011_010244.log'
        entries    = [<DirEntry 'chunk_20251011_010244.log'>]
        entry      = <DirEntry 'chunk_20251011_010244.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3\\_chunks\\_chunker_state\\chunk_20251011_010244.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB2EE6AC0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3\\_chunks\\_chunker_state'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1487680>

During handling of the above exception, another exception occurred:
tests\unit\test_processor.py:494: in test_distribute_chunking_work
    with tempfile.TemporaryDirectory() as tmpdir:
        chunk_config = {'chunk_size': 1600}
        configs    = [WorkerConfig(worker_id=0,
              jobs_assigned=[('doc1', '\\path1', 1000),
                             ('doc3', '\\path3', 1500)],
              chunk_config={'chunk_size': 1600}),
 WorkerConfig(worker_id=1,
              jobs_assigned=[('doc2', '\\path2', 2000),
                             ('doc4', '\\path4', 500)],
              chunk_config={'chunk_size': 1600})]
        jobs       = [ChunkJob(doc_id='doc1',
          doc_path=WindowsPath('/path1'),
          file_size=1000,
          priority=0),
 ChunkJob(doc_id='doc2',
          doc_path=WindowsPath('/path2'),
          file_size=2000,
          priority=0),
 ChunkJob(doc_id='doc3',
          doc_path=WindowsPath('/path3'),
          file_size=1500,
          priority=0),
 ChunkJob(doc_id='doc4',
          doc_path=WindowsPath('/path4'),
          file_size=500,
          priority=0)]
        mock_config = <Mock name='get_config()' id='1647989546960'>
        mock_get_config = <MagicMock name='get_config' id='1647989553360'>
        processor  = <processing.processor.UnifiedProcessor object at 0x0000017FB3BAC3D0>
        self       = <test_processor.TestUnifiedProcessor testMethod=test_distribute_chunking_work>
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3'
        total_jobs = 4
        worker0_size = 2500
        worker1_size = 2500
..\..\anaconda3\envs\emailops\Lib\tempfile.py:943: in __exit__
    self.cleanup()
        exc        = None
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3'>
        tb         = None
        value      = None
..\..\anaconda3\envs\emailops\Lib\tempfile.py:947: in cleanup
    self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3'>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:929: in _rmtree
    _shutil.rmtree(name, onerror=onerror)
        cls        = <class 'tempfile.TemporaryDirectory'>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB2EE6AC0>
        repeated   = False
..\..\anaconda3\envs\emailops\Lib\shutil.py:787: in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dir_fd     = None
        ignore_errors = False
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB2EE6AC0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3'
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry '_chunks'>]
        entry      = <DirEntry '_chunks'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3\\_chunks'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB2EE6AC0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1488700>
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry '_chunker_state'>]
        entry      = <DirEntry '_chunker_state'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3\\_chunks\\_chunker_state'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB2EE6AC0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3\\_chunks'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1489780>
..\..\anaconda3\envs\emailops\Lib\shutil.py:634: in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
        entries    = [<DirEntry 'chunk_20251011_010244.log'>]
        entry      = <DirEntry 'chunk_20251011_010244.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3\\_chunks\\_chunker_state\\chunk_20251011_010244.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB2EE6AC0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3\\_chunks\\_chunker_state'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1487680>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:893: in onerror
    _os.unlink(path)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3\\_chunks\\_chunker_state\\chunk_20251011_010244.log'
        cls        = <class 'tempfile.TemporaryDirectory'>
        exc_info   = (<class 'PermissionError'>,
 PermissionError(13, 'The process cannot access the file because it is being used by another process'),
 <traceback object at 0x0000017FB3BAC340>)
        func       = <built-in function unlink>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3'
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3\\_chunks\\_chunker_state\\chunk_20251011_010244.log'
        repeated   = False
        st         = os.stat_result(st_mode=33206, st_ino=844424931729720, st_dev=686416114, st_nlink=1, st_uid=0, st_gid=0, st_size=0, st_atime=1760130164, st_mtime=1760130164, st_ctime=1760130164)
_______________ TestUnifiedProcessor.test_find_documents_basic ________________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_find_documents_basic>,)
        func       = <function TestUnifiedProcessor.test_find_documents_basic at 0x0000017FA63028E0>
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_find_documents_basic at 0x0000017FA6302980>
        self       = <unittest.mock._patch object at 0x0000017FA62F3D10>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB3D7ED50>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_find_documents_basic>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB393C8D0>
        extra_args = []
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_find_documents_basic at 0x0000017FA6302980>
        patching   = <unittest.mock._patch object at 0x0000017FA62F3D10>
        self       = <unittest.mock._patch object at 0x0000017FA62F3D10>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA62F3D10>
        self       = <contextlib.ExitStack object at 0x0000017FB393C8D0>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA62F3D10>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
        local      = False
        name       = 'get_config'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA62F3D10>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
_____________ TestUnifiedProcessor.test_find_documents_test_mode ______________
..\..\anaconda3\envs\emailops\Lib\shutil.py:632: in _rmtree_unsafe
    os.unlink(fullname)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp\\_chunks\\_chunker_state\\chunk_20251011_010245.log'
        entries    = [<DirEntry 'chunk_20251011_010245.log'>]
        entry      = <DirEntry 'chunk_20251011_010245.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp\\_chunks\\_chunker_state\\chunk_20251011_010245.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403C180>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp\\_chunks\\_chunker_state'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1487100>

During handling of the above exception, another exception occurred:
tests\unit\test_processor.py:469: in test_find_documents_test_mode
    with tempfile.TemporaryDirectory() as tmpdir:
        i          = 14
        jobs       = [ChunkJob(doc_id='doc10.txt',
          doc_path=WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmp7hdo8pyp/doc10.txt'),
          file_size=10,
          priority=0),
 ChunkJob(doc_id='doc11.txt',
          doc_path=WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmp7hdo8pyp/doc11.txt'),
          file_size=10,
          priority=0),
 ChunkJob(doc_id='doc12.txt',
          doc_path=WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmp7hdo8pyp/doc12.txt'),
          file_size=10,
          priority=0),
 ChunkJob(doc_id='doc13.txt',
          doc_path=WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmp7hdo8pyp/doc13.txt'),
          file_size=10,
          priority=0),
 ChunkJob(doc_id='doc14.txt',
          doc_path=WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmp7hdo8pyp/doc14.txt'),
          file_size=10,
          priority=0),
 ChunkJob(doc_id='doc0.txt',
          doc_path=WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmp7hdo8pyp/doc0.txt'),
          file_size=9,
          priority=0),
 ChunkJob(doc_id='doc1.txt',
          doc_path=WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmp7hdo8pyp/doc1.txt'),
          file_size=9,
          priority=0),
 ChunkJob(doc_id='doc2.txt',
          doc_path=WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmp7hdo8pyp/doc2.txt'),
          file_size=9,
          priority=0),
 ChunkJob(doc_id='doc3.txt',
          doc_path=WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmp7hdo8pyp/doc3.txt'),
          file_size=9,
          priority=0),
 ChunkJob(doc_id='doc4.txt',
          doc_path=WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmp7hdo8pyp/doc4.txt'),
          file_size=9,
          priority=0)]
        mock_config = <Mock name='get_config()' id='1647990245456'>
        mock_get_config = <MagicMock name='get_config' id='1647990245776'>
        processor  = <processing.processor.UnifiedProcessor object at 0x0000017FB4066210>
        self       = <test_processor.TestUnifiedProcessor testMethod=test_find_documents_test_mode>
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp'
..\..\anaconda3\envs\emailops\Lib\tempfile.py:943: in __exit__
    self.cleanup()
        exc        = None
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp'>
        tb         = None
        value      = None
..\..\anaconda3\envs\emailops\Lib\tempfile.py:947: in cleanup
    self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp'>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:929: in _rmtree
    _shutil.rmtree(name, onerror=onerror)
        cls        = <class 'tempfile.TemporaryDirectory'>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403C180>
        repeated   = False
..\..\anaconda3\envs\emailops\Lib\shutil.py:787: in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dir_fd     = None
        ignore_errors = False
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403C180>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp'
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry 'doc0.txt'>,
 <DirEntry 'doc1.txt'>,
 <DirEntry 'doc10.txt'>,
 <DirEntry 'doc11.txt'>,
 <DirEntry 'doc12.txt'>,
 <DirEntry 'doc13.txt'>,
 <DirEntry 'doc14.txt'>,
 <DirEntry 'doc2.txt'>,
 <DirEntry 'doc3.txt'>,
 <DirEntry 'doc4.txt'>,
 <DirEntry 'doc5.txt'>,
 <DirEntry 'doc6.txt'>,
 <DirEntry 'doc7.txt'>,
 <DirEntry 'doc8.txt'>,
 <DirEntry 'doc9.txt'>,
 <DirEntry '_chunks'>]
        entry      = <DirEntry '_chunks'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp\\_chunks'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403C180>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1489200>
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry 'chunks'>, <DirEntry '_chunker_state'>]
        entry      = <DirEntry '_chunker_state'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp\\_chunks\\_chunker_state'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403C180>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp\\_chunks'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1486080>
..\..\anaconda3\envs\emailops\Lib\shutil.py:634: in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
        entries    = [<DirEntry 'chunk_20251011_010245.log'>]
        entry      = <DirEntry 'chunk_20251011_010245.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp\\_chunks\\_chunker_state\\chunk_20251011_010245.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403C180>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp\\_chunks\\_chunker_state'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1487100>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:893: in onerror
    _os.unlink(path)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp\\_chunks\\_chunker_state\\chunk_20251011_010245.log'
        cls        = <class 'tempfile.TemporaryDirectory'>
        exc_info   = (<class 'PermissionError'>,
 PermissionError(13, 'The process cannot access the file because it is being used by another process'),
 <traceback object at 0x0000017FB4067500>)
        func       = <built-in function unlink>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp'
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp\\_chunks\\_chunker_state\\chunk_20251011_010245.log'
        repeated   = False
        st         = os.stat_result(st_mode=33206, st_ino=844424931729724, st_dev=686416114, st_nlink=1, st_uid=0, st_gid=0, st_size=0, st_atime=1760130165, st_mtime=1760130165, st_ctime=1760130165)
____________ TestUnifiedProcessor.test_find_documents_with_resume _____________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_find_documents_with_resume>,)
        func       = <function TestUnifiedProcessor.test_find_documents_with_resume at 0x0000017FA6302A20>
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_find_documents_with_resume at 0x0000017FA6302AC0>
        self       = <unittest.mock._patch object at 0x0000017FA62F3F10>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB3BAC6D0>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_find_documents_with_resume>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB3BAD910>
        extra_args = []
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_find_documents_with_resume at 0x0000017FA6302AC0>
        patching   = <unittest.mock._patch object at 0x0000017FA62F3F10>
        self       = <unittest.mock._patch object at 0x0000017FA62F3F10>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA62F3F10>
        self       = <contextlib.ExitStack object at 0x0000017FB3BAD910>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA62F3F10>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
        local      = False
        name       = 'get_config'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA62F3F10>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
__________________ TestUnifiedProcessor.test_init_embed_mode __________________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_init_embed_mode>,)
        func       = <function TestUnifiedProcessor.test_init_embed_mode at 0x0000017FA6302520>
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_init_embed_mode at 0x0000017FA63025C0>
        self       = <unittest.mock._patch object at 0x0000017FA62F3710>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB42ED590>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_init_embed_mode>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB42EDD10>
        extra_args = []
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_init_embed_mode at 0x0000017FA63025C0>
        patching   = <unittest.mock._patch object at 0x0000017FA62F3710>
        self       = <unittest.mock._patch object at 0x0000017FA62F3710>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA62F3710>
        self       = <contextlib.ExitStack object at 0x0000017FB42EDD10>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA62F3710>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
        local      = False
        name       = 'get_config'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA62F3710>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
______________ TestUnifiedProcessor.test_init_with_custom_params ______________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_init_with_custom_params>,)
        func       = <function TestUnifiedProcessor.test_init_with_custom_params at 0x0000017FA63023E0>
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_init_with_custom_params at 0x0000017FA6302480>
        self       = <unittest.mock._patch object at 0x0000017FA62F35D0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB3F46E90>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_init_with_custom_params>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB3F46A10>
        extra_args = []
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_init_with_custom_params at 0x0000017FA6302480>
        patching   = <unittest.mock._patch object at 0x0000017FA62F35D0>
        self       = <unittest.mock._patch object at 0x0000017FA62F35D0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA62F35D0>
        self       = <contextlib.ExitStack object at 0x0000017FB3F46A10>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA62F35D0>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
        local      = False
        name       = 'get_config'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA62F35D0>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
________________ TestUnifiedProcessor.test_init_with_defaults _________________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_init_with_defaults>,)
        func       = <function TestUnifiedProcessor.test_init_with_defaults at 0x0000017FA63022A0>
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_init_with_defaults at 0x0000017FA6302340>
        self       = <unittest.mock._patch object at 0x0000017FA62F3490>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB5401AD0>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_init_with_defaults>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB5401850>
        extra_args = []
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_init_with_defaults at 0x0000017FA6302340>
        patching   = <unittest.mock._patch object at 0x0000017FA62F3490>
        self       = <unittest.mock._patch object at 0x0000017FA62F3490>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA62F3490>
        self       = <contextlib.ExitStack object at 0x0000017FB5401850>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA62F3490>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
        local      = False
        name       = 'get_config'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA62F3490>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
________________ TestUnifiedProcessor.test_init_without_config ________________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_init_without_config>,)
        func       = <function TestUnifiedProcessor.test_init_without_config at 0x0000017FA6302660>
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_init_without_config at 0x0000017FA6302700>
        self       = <unittest.mock._patch object at 0x0000017FA62F3910>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB3C05BD0>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (<test_processor.TestUnifiedProcessor testMethod=test_init_without_config>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB3C06C50>
        extra_args = []
        keywargs   = {}
        patched    = <function TestUnifiedProcessor.test_init_without_config at 0x0000017FA6302700>
        patching   = <unittest.mock._patch object at 0x0000017FA62F3910>
        self       = <unittest.mock._patch object at 0x0000017FA62F3910>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA62F3910>
        self       = <contextlib.ExitStack object at 0x0000017FB3C06C50>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {'side_effect': <class 'ImportError'>}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA62F3910>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
        local      = False
        name       = 'get_config'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA62F3910>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
__________ TestChunkWorkerEntry.test_chunk_worker_entry_import_error __________
tests\unit\test_processor.py:565: in test_chunk_worker_entry_import_error
    with patch('emailops.text_chunker.TextChunker', side_effect=ImportError("Missing dependency")):
        control_queue = <Mock id='1648013254800'>
        mock_logging = <MagicMock name='basicConfig' id='1648013251152'>
        self       = <test_processor.TestChunkWorkerEntry testMethod=test_chunk_worker_entry_import_error>
        stats_queue = <Mock id='1648013254736'>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {'side_effect': ImportError('Missing dependency')}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FB53EA0D0>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.text_chunker' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\text_chunker.py'> does not have the attribute 'TextChunker'
        local      = False
        name       = 'TextChunker'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FB53EA0D0>
        target     = <module 'emailops.text_chunker' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\text_chunker.py'>
____________ TestChunkWorkerEntry.test_chunk_worker_entry_success _____________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_processor.TestChunkWorkerEntry testMethod=test_chunk_worker_entry_success>,)
        func       = <function TestChunkWorkerEntry.test_chunk_worker_entry_success at 0x0000017FA6302DE0>
        keywargs   = {}
        patched    = <function TestChunkWorkerEntry.test_chunk_worker_entry_success at 0x0000017FA6302E80>
        self       = <unittest.mock._patch object at 0x0000017FA6308890>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB3B45810>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        arg        = <MagicMock name='read_text_file' id='1647987409296'>
        args       = (<test_processor.TestChunkWorkerEntry testMethod=test_chunk_worker_entry_success>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB3B44050>
        extra_args = [<MagicMock name='read_text_file' id='1647987409296'>]
        keywargs   = {}
        patched    = <function TestChunkWorkerEntry.test_chunk_worker_entry_success at 0x0000017FA6302E80>
        patching   = <unittest.mock._patch object at 0x0000017FA6308750>
        self       = <unittest.mock._patch object at 0x0000017FA6308890>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA6308750>
        self       = <contextlib.ExitStack object at 0x0000017FB3B44050>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA6308750>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.text_chunker' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\text_chunker.py'> does not have the attribute 'TextChunker'
        local      = False
        name       = 'TextChunker'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA6308750>
        target     = <module 'emailops.text_chunker' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\text_chunker.py'>
________ TestEmbeddingOperations.test_create_embeddings_no_credentials ________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_processor.TestEmbeddingOperations testMethod=test_create_embeddings_no_credentials>,)
        func       = <function TestEmbeddingOperations.test_create_embeddings_no_credentials at 0x0000017FA63032E0>
        keywargs   = {}
        patched    = <function TestEmbeddingOperations.test_create_embeddings_no_credentials at 0x0000017FA6303380>
        self       = <unittest.mock._patch object at 0x0000017FA63092D0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB41AC690>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        arg        = <MagicMock name='_initialize_gcp_credentials' id='1647994127376'>
        args       = (<test_processor.TestEmbeddingOperations testMethod=test_create_embeddings_no_credentials>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB41AC450>
        extra_args = [<MagicMock name='_initialize_gcp_credentials' id='1647994127376'>]
        keywargs   = {}
        patched    = <function TestEmbeddingOperations.test_create_embeddings_no_credentials at 0x0000017FA6303380>
        patching   = <unittest.mock._patch object at 0x0000017FA6309210>
        self       = <unittest.mock._patch object at 0x0000017FA63092D0>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA6309210>
        self       = <contextlib.ExitStack object at 0x0000017FB41AC450>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA6309210>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
        local      = False
        name       = 'get_config'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA6309210>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
____________ TestEmbeddingOperations.test_create_embeddings_vertex ____________
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1375: in patched
    with self.decoration_helper(patched,
        args       = (<test_processor.TestEmbeddingOperations testMethod=test_create_embeddings_vertex>,)
        func       = <function TestEmbeddingOperations.test_create_embeddings_vertex at 0x0000017FA6303100>
        keywargs   = {}
        patched    = <function TestEmbeddingOperations.test_create_embeddings_vertex at 0x0000017FA63031A0>
        self       = <unittest.mock._patch object at 0x0000017FA6308F10>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
        self       = <contextlib._GeneratorContextManager object at 0x0000017FB3E9B350>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1357: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        arg        = <MagicMock name='_initialize_gcp_credentials' id='1647993340368'>
        args       = (<test_processor.TestEmbeddingOperations testMethod=test_create_embeddings_vertex>,)
        exit_stack = <contextlib.ExitStack object at 0x0000017FB3E98D50>
        extra_args = [<MagicMock name='embed_texts' id='1647990903312'>,
 <MagicMock name='_initialize_gcp_credentials' id='1647993340368'>]
        keywargs   = {}
        patched    = <function TestEmbeddingOperations.test_create_embeddings_vertex at 0x0000017FA63031A0>
        patching   = <unittest.mock._patch object at 0x0000017FA6308D50>
        self       = <unittest.mock._patch object at 0x0000017FA6308F10>
..\..\anaconda3\envs\emailops\Lib\contextlib.py:517: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
        _enter     = <function _patch.__enter__ at 0x0000017F978C51C0>
        _exit      = <function _patch.__exit__ at 0x0000017F978C5260>
        cls        = <class 'unittest.mock._patch'>
        cm         = <unittest.mock._patch object at 0x0000017FA6308D50>
        self       = <contextlib.ExitStack object at 0x0000017FB3E98D50>
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FA6308D50>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
        local      = False
        name       = 'get_config'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FA6308D50>
        target     = <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'>
_______________ TestIndexOperations.test_repair_index_no_files ________________
..\..\anaconda3\envs\emailops\Lib\shutil.py:632: in _rmtree_unsafe
    os.unlink(fullname)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y\\_index\\repair_20251011_010246.log'
        entries    = [<DirEntry 'repair_20251011_010246.log'>]
        entry      = <DirEntry 'repair_20251011_010246.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y\\_index\\repair_20251011_010246.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403E2A0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y\\_index'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1487C00>

During handling of the above exception, another exception occurred:
tests\unit\test_processor.py:707: in test_repair_index_no_files
    with tempfile.TemporaryDirectory() as tmpdir:
        mock_config = <Mock name='get_config()' id='1648012891984'>
        mock_get_config = <MagicMock name='get_config' id='1648012888784'>
        processor  = <processing.processor.UnifiedProcessor object at 0x0000017FB5391610>
        self       = <test_processor.TestIndexOperations testMethod=test_repair_index_no_files>
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y'
..\..\anaconda3\envs\emailops\Lib\tempfile.py:943: in __exit__
    self.cleanup()
        exc        = None
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y'>
        tb         = None
        value      = None
..\..\anaconda3\envs\emailops\Lib\tempfile.py:947: in cleanup
    self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y'>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:929: in _rmtree
    _shutil.rmtree(name, onerror=onerror)
        cls        = <class 'tempfile.TemporaryDirectory'>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403E2A0>
        repeated   = False
..\..\anaconda3\envs\emailops\Lib\shutil.py:787: in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dir_fd     = None
        ignore_errors = False
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403E2A0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y'
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry '_index'>]
        entry      = <DirEntry '_index'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y\\_index'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403E2A0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1488C80>
..\..\anaconda3\envs\emailops\Lib\shutil.py:634: in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
        entries    = [<DirEntry 'repair_20251011_010246.log'>]
        entry      = <DirEntry 'repair_20251011_010246.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y\\_index\\repair_20251011_010246.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403E2A0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y\\_index'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1487C00>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:893: in onerror
    _os.unlink(path)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y\\_index\\repair_20251011_010246.log'
        cls        = <class 'tempfile.TemporaryDirectory'>
        exc_info   = (<class 'PermissionError'>,
 PermissionError(13, 'The process cannot access the file because it is being used by another process'),
 <traceback object at 0x0000017FB5392BC0>)
        func       = <built-in function unlink>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y'
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y\\_index\\repair_20251011_010246.log'
        repeated   = False
        st         = os.stat_result(st_mode=33206, st_ino=1125899908440383, st_dev=686416114, st_nlink=1, st_uid=0, st_gid=0, st_size=153, st_atime=1760130166, st_mtime=1760130166, st_ctime=1760130166)
---------------------------- Captured stdout call -----------------------------
2025-10-11 01:02:46,991 - UnifiedProcessor.repair - ERROR - No batch directory found at: C:\Users\ASUS\AppData\Local\Temp\tmpd9bcoe1y\_index\embeddings
________________ TestIndexOperations.test_repair_index_success ________________
..\..\anaconda3\envs\emailops\Lib\shutil.py:632: in _rmtree_unsafe
    os.unlink(fullname)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq\\_index\\repair_20251011_010247.log'
        entries    = [<DirEntry 'embeddings'>,
 <DirEntry 'embeddings.npy'>,
 <DirEntry 'mapping.json'>,
 <DirEntry 'repair_20251011_010247.log'>]
        entry      = <DirEntry 'repair_20251011_010247.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq\\_index\\repair_20251011_010247.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403EC00>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq\\_index'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1489780>

During handling of the above exception, another exception occurred:
tests\unit\test_processor.py:669: in test_repair_index_success
    with tempfile.TemporaryDirectory() as tmpdir:
        batch_data = {'chunks': [{'doc_id': 'doc1', 'text': 'test'}],
 'embeddings': array([[0.1, 0.2]], dtype=float32)}
        emb_dir    = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmpg8u8nnlq/_index/embeddings')
        f          = <_io.BufferedWriter name='C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq\\_index\\embeddings\\worker_0_batch_00000.pkl'>
        mock_config = <Mock name='get_config()' id='1647991025424'>
        mock_faiss = <MagicMock id='1647994917904'>
        mock_get_config = <MagicMock name='get_config' id='1647991021456'>
        processor  = <processing.processor.UnifiedProcessor object at 0x0000017FB3EB7350>
        self       = <test_processor.TestIndexOperations testMethod=test_repair_index_success>
        sys        = <module 'sys' (built-in)>
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq'
..\..\anaconda3\envs\emailops\Lib\tempfile.py:943: in __exit__
    self.cleanup()
        exc        = None
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq'>
        tb         = None
        value      = None
..\..\anaconda3\envs\emailops\Lib\tempfile.py:947: in cleanup
    self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq'>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:929: in _rmtree
    _shutil.rmtree(name, onerror=onerror)
        cls        = <class 'tempfile.TemporaryDirectory'>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403EC00>
        repeated   = False
..\..\anaconda3\envs\emailops\Lib\shutil.py:787: in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dir_fd     = None
        ignore_errors = False
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403EC00>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq'
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry '_index'>]
        entry      = <DirEntry '_index'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq\\_index'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403EC00>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1486E40>
..\..\anaconda3\envs\emailops\Lib\shutil.py:634: in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
        entries    = [<DirEntry 'embeddings'>,
 <DirEntry 'embeddings.npy'>,
 <DirEntry 'mapping.json'>,
 <DirEntry 'repair_20251011_010247.log'>]
        entry      = <DirEntry 'repair_20251011_010247.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq\\_index\\repair_20251011_010247.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403EC00>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq\\_index'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1489780>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:893: in onerror
    _os.unlink(path)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq\\_index\\repair_20251011_010247.log'
        cls        = <class 'tempfile.TemporaryDirectory'>
        exc_info   = (<class 'PermissionError'>,
 PermissionError(13, 'The process cannot access the file because it is being used by another process'),
 <traceback object at 0x0000017FB3DB6D40>)
        func       = <built-in function unlink>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq'
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq\\_index\\repair_20251011_010247.log'
        repeated   = False
        st         = os.stat_result(st_mode=33206, st_ino=1125899908440387, st_dev=686416114, st_nlink=1, st_uid=0, st_gid=0, st_size=256, st_atime=1760130167, st_mtime=1760130167, st_ctime=1760130167)
---------------------------- Captured stdout call -----------------------------
2025-10-11 01:02:47,124 - UnifiedProcessor.repair - INFO - Merging 1 batch files...
2025-10-11 01:02:47,135 - UnifiedProcessor.repair - INFO - Saved 1 chunks with embeddings
2025-10-11 01:02:47,135 - UnifiedProcessor.repair - INFO - Created FAISS index
___________ TestErrorHandling.test_embed_from_chunks_error_handling ___________
..\..\anaconda3\envs\emailops\Lib\shutil.py:632: in _rmtree_unsafe
    os.unlink(fullname)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit\\_index\\embed_20251011_010247.log'
        entries    = [<DirEntry 'embeddings'>, <DirEntry 'embed_20251011_010247.log'>]
        entry      = <DirEntry 'embed_20251011_010247.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit\\_index\\embed_20251011_010247.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403E5C0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit\\_index'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1488F40>

During handling of the above exception, another exception occurred:
tests\unit\test_processor.py:818: in test_embed_from_chunks_error_handling
    with tempfile.TemporaryDirectory() as tmpdir:
        chunk_data = {'chunks': [{'text': 'chunk 1'}, {'text': 'chunk 2'}], 'doc_id': 'test_doc'}
        chunks_dir = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmpk_vt2zit/_chunks/chunks')
        emb_dir    = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmpk_vt2zit/_index/embeddings')
        mock_config = <Mock name='get_config()' id='1647993835152'>
        mock_embed = <MagicMock name='embed_texts' id='1647993835792'>
        mock_get_config = <MagicMock name='get_config' id='1647992178640'>
        pkl_files  = [WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmpk_vt2zit/_index/embeddings/worker_0_batch_00000.pkl')]
        processor  = <processing.processor.UnifiedProcessor object at 0x0000017FB2F0F410>
        self       = <test_processor.TestErrorHandling testMethod=test_embed_from_chunks_error_handling>
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit'
..\..\anaconda3\envs\emailops\Lib\tempfile.py:943: in __exit__
    self.cleanup()
        exc        = None
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit'>
        tb         = None
        value      = None
..\..\anaconda3\envs\emailops\Lib\tempfile.py:947: in cleanup
    self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit'>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:929: in _rmtree
    _shutil.rmtree(name, onerror=onerror)
        cls        = <class 'tempfile.TemporaryDirectory'>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403E5C0>
        repeated   = False
..\..\anaconda3\envs\emailops\Lib\shutil.py:787: in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dir_fd     = None
        ignore_errors = False
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403E5C0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit'
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry '_chunks'>, <DirEntry '_index'>]
        entry      = <DirEntry '_index'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit\\_index'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403E5C0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1488C80>
..\..\anaconda3\envs\emailops\Lib\shutil.py:634: in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
        entries    = [<DirEntry 'embeddings'>, <DirEntry 'embed_20251011_010247.log'>]
        entry      = <DirEntry 'embed_20251011_010247.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit\\_index\\embed_20251011_010247.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403E5C0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit\\_index'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1488F40>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:893: in onerror
    _os.unlink(path)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit\\_index\\embed_20251011_010247.log'
        cls        = <class 'tempfile.TemporaryDirectory'>
        exc_info   = (<class 'PermissionError'>,
 PermissionError(13, 'The process cannot access the file because it is being used by another process'),
 <traceback object at 0x0000017FB602BBC0>)
        func       = <built-in function unlink>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit'
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit\\_index\\embed_20251011_010247.log'
        repeated   = False
        st         = os.stat_result(st_mode=33206, st_ino=1407374885151046, st_dev=686416114, st_nlink=1, st_uid=0, st_gid=0, st_size=410, st_atime=1760130167, st_mtime=1760130167, st_ctime=1760130167)
---------------------------- Captured stdout call -----------------------------
2025-10-11 01:02:47,392 - UnifiedProcessor.embed - INFO - Embedding 1 chunk files (batch size=1)
2025-10-11 01:02:47,392 - UnifiedProcessor.embed - INFO - Wrote worker_0_batch_00000.pkl (chunks=1, dim=2)
2025-10-11 01:02:47,392 - UnifiedProcessor.embed - ERROR - Embedding failed for batch 1: API error
2025-10-11 01:02:47,392 - UnifiedProcessor.embed - INFO - Embedding complete. Total chunks embedded: 1
_________ TestErrorHandling.test_fix_failed_embeddings_re_embed_error _________
..\..\anaconda3\envs\emailops\Lib\shutil.py:632: in _rmtree_unsafe
    os.unlink(fullname)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde\\_index\\fix_20251011_010247.log'
        entries    = [<DirEntry 'embeddings'>, <DirEntry 'fix_20251011_010247.log'>]
        entry      = <DirEntry 'fix_20251011_010247.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde\\_index\\fix_20251011_010247.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403DE40>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde\\_index'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB14868C0>

During handling of the above exception, another exception occurred:
tests\unit\test_processor.py:856: in test_fix_failed_embeddings_re_embed_error
    with tempfile.TemporaryDirectory() as tmpdir:
        batch_data = {'chunks': [{'doc_id': 'doc1', 'text': 'test'}],
 'embeddings': array([[0., 0.]], dtype=float32)}
        emb_dir    = WindowsPath('C:/Users/ASUS/AppData/Local/Temp/tmps7rahzde/_index/embeddings')
        f          = <_io.BufferedWriter name='C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde\\_index\\embeddings\\batch.pkl'>
        mock_config = <Mock name='get_config()' id='1647993352976'>
        mock_embed = <MagicMock name='embed_texts' id='1647993352464'>
        mock_get_config = <MagicMock name='get_config' id='1647993347280'>
        mock_init_creds = <MagicMock name='_initialize_gcp_credentials' id='1647993353552'>
        processor  = <processing.processor.UnifiedProcessor object at 0x0000017FB3CD7410>
        self       = <test_processor.TestErrorHandling testMethod=test_fix_failed_embeddings_re_embed_error>
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde'
..\..\anaconda3\envs\emailops\Lib\tempfile.py:943: in __exit__
    self.cleanup()
        exc        = None
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde'>
        tb         = None
        value      = None
..\..\anaconda3\envs\emailops\Lib\tempfile.py:947: in cleanup
    self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde'>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:929: in _rmtree
    _shutil.rmtree(name, onerror=onerror)
        cls        = <class 'tempfile.TemporaryDirectory'>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403DE40>
        repeated   = False
..\..\anaconda3\envs\emailops\Lib\shutil.py:787: in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dir_fd     = None
        ignore_errors = False
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403DE40>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde'
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry '_index'>]
        entry      = <DirEntry '_index'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde\\_index'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403DE40>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1487100>
..\..\anaconda3\envs\emailops\Lib\shutil.py:634: in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
        entries    = [<DirEntry 'embeddings'>, <DirEntry 'fix_20251011_010247.log'>]
        entry      = <DirEntry 'fix_20251011_010247.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde\\_index\\fix_20251011_010247.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403DE40>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde\\_index'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB14868C0>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:893: in onerror
    _os.unlink(path)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde\\_index\\fix_20251011_010247.log'
        cls        = <class 'tempfile.TemporaryDirectory'>
        exc_info   = (<class 'PermissionError'>,
 PermissionError(13, 'The process cannot access the file because it is being used by another process'),
 <traceback object at 0x0000017FB3CD4080>)
        func       = <built-in function unlink>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde'
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde\\_index\\fix_20251011_010247.log'
        repeated   = False
        st         = os.stat_result(st_mode=33206, st_ino=1407374885151049, st_dev=686416114, st_nlink=1, st_uid=0, st_gid=0, st_size=364, st_atime=1760130167, st_mtime=1760130167, st_ctime=1760130167)
---------------------------- Captured stdout call -----------------------------
2025-10-11 01:02:47,532 - UnifiedProcessor.fix - INFO - Scanning 1 files for zero vectors...
2025-10-11 01:02:47,532 - UnifiedProcessor.fix - INFO - Found 1 zero vectors in batch.pkl
2025-10-11 01:02:47,532 - UnifiedProcessor.fix - ERROR - Failed to re-embed: Embedding failed
2025-10-11 01:02:47,532 - UnifiedProcessor.fix - INFO - Fixed 0 zero vectors total
____________ TestErrorHandling.test_sequential_chunk_import_error _____________
tests\unit\test_processor.py:798: in test_sequential_chunk_import_error
    with patch('emailops.text_chunker.TextChunker', side_effect=ImportError("Missing dep")):
        mock_config = <Mock name='get_config()' id='1648013083472'>
        mock_get_config = <MagicMock name='get_config' id='1648013093904'>
        processor  = <processing.processor.UnifiedProcessor object at 0x0000017FB53C2BD0>
        self       = <test_processor.TestErrorHandling testMethod=test_sequential_chunk_import_error>
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6'
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
        autospec   = None
        kwargs     = {'side_effect': ImportError('Missing dep')}
        new        = sentinel.DEFAULT
        new_callable = None
        self       = <unittest.mock._patch object at 0x0000017FB53C2950>
        spec       = None
        spec_set   = None
..\..\anaconda3\envs\emailops\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'emailops.text_chunker' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\text_chunker.py'> does not have the attribute 'TextChunker'
        local      = False
        name       = 'TextChunker'
        original   = sentinel.DEFAULT
        self       = <unittest.mock._patch object at 0x0000017FB53C2950>
        target     = <module 'emailops.text_chunker' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\text_chunker.py'>

During handling of the above exception, another exception occurred:
..\..\anaconda3\envs\emailops\Lib\shutil.py:632: in _rmtree_unsafe
    os.unlink(fullname)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6\\_chunks\\_chunker_state\\chunk_20251011_010247.log'
        entries    = [<DirEntry 'chunk_20251011_010247.log'>]
        entry      = <DirEntry 'chunk_20251011_010247.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6\\_chunks\\_chunker_state\\chunk_20251011_010247.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F240>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6\\_chunks\\_chunker_state'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1486B80>

During handling of the above exception, another exception occurred:
tests\unit\test_processor.py:795: in test_sequential_chunk_import_error
    with tempfile.TemporaryDirectory() as tmpdir:
        mock_config = <Mock name='get_config()' id='1648013083472'>
        mock_get_config = <MagicMock name='get_config' id='1648013093904'>
        processor  = <processing.processor.UnifiedProcessor object at 0x0000017FB53C2BD0>
        self       = <test_processor.TestErrorHandling testMethod=test_sequential_chunk_import_error>
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6'
..\..\anaconda3\envs\emailops\Lib\tempfile.py:943: in __exit__
    self.cleanup()
        exc        = <class 'AttributeError'>
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6'>
        tb         = <traceback object at 0x0000017FB53C1C40>
        value      = AttributeError("<module 'emailops.text_chunker' from 'C:\\\\Users\\\\ASUS\\\\Downloads\\\\emailops_vertex_ai\\\\emailops\\\\text_chunker.py'> does not have the attribute 'TextChunker'")
..\..\anaconda3\envs\emailops\Lib\tempfile.py:947: in cleanup
    self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6'>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:929: in _rmtree
    _shutil.rmtree(name, onerror=onerror)
        cls        = <class 'tempfile.TemporaryDirectory'>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F240>
        repeated   = False
..\..\anaconda3\envs\emailops\Lib\shutil.py:787: in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dir_fd     = None
        ignore_errors = False
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F240>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6'
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry '_chunks'>]
        entry      = <DirEntry '_chunks'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6\\_chunks'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F240>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1489A40>
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry '_chunker_state'>]
        entry      = <DirEntry '_chunker_state'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6\\_chunks\\_chunker_state'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F240>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6\\_chunks'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1486340>
..\..\anaconda3\envs\emailops\Lib\shutil.py:634: in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
        entries    = [<DirEntry 'chunk_20251011_010247.log'>]
        entry      = <DirEntry 'chunk_20251011_010247.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6\\_chunks\\_chunker_state\\chunk_20251011_010247.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F240>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6\\_chunks\\_chunker_state'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1486B80>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:893: in onerror
    _os.unlink(path)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6\\_chunks\\_chunker_state\\chunk_20251011_010247.log'
        cls        = <class 'tempfile.TemporaryDirectory'>
        exc_info   = (<class 'PermissionError'>,
 PermissionError(13, 'The process cannot access the file because it is being used by another process'),
 <traceback object at 0x0000017FB53C3E40>)
        func       = <built-in function unlink>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6'
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6\\_chunks\\_chunker_state\\chunk_20251011_010247.log'
        repeated   = False
        st         = os.stat_result(st_mode=33206, st_ino=1125899908440397, st_dev=686416114, st_nlink=1, st_uid=0, st_gid=0, st_size=0, st_atime=1760130167, st_mtime=1760130167, st_ctime=1760130167)
______________ TestMonitoringFunctions.test_display_progress_tty ______________
..\..\anaconda3\envs\emailops\Lib\shutil.py:632: in _rmtree_unsafe
    os.unlink(fullname)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi\\_chunks\\_chunker_state\\chunk_20251011_010247.log'
        entries    = [<DirEntry 'chunk_20251011_010247.log'>]
        entry      = <DirEntry 'chunk_20251011_010247.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi\\_chunks\\_chunker_state\\chunk_20251011_010247.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F560>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi\\_chunks\\_chunker_state'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1487680>

During handling of the above exception, another exception occurred:
tests\unit\test_processor.py:893: in test_display_progress_tty
    with tempfile.TemporaryDirectory() as tmpdir:
        mock_config = <Mock name='get_config()' id='1647978391888'>
        mock_get_config = <MagicMock name='get_config' id='1648013532816'>
        mock_isatty = <MagicMock name='isatty' id='1647978388496'>
        mock_print = <MagicMock name='print' id='1648013534096'>
        mock_system = <MagicMock name='system' id='1647987839056'>
        processor  = <processing.processor.UnifiedProcessor object at 0x0000017FB542FBD0>
        self       = <test_processor.TestMonitoringFunctions testMethod=test_display_progress_tty>
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi'
        worker_states = {0: WorkerStats(worker_id=0,
                docs_processed=5,
                docs_total=10,
                chunks_created=50,
                bytes_processed=5000,
                bytes_total=10000,
                start_time=1760130167.9360342,
                last_update=1760130167.9360342,
                errors=1,
                status='running',
                current_doc='test.txt')}
..\..\anaconda3\envs\emailops\Lib\tempfile.py:943: in __exit__
    self.cleanup()
        exc        = None
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi'>
        tb         = None
        value      = None
..\..\anaconda3\envs\emailops\Lib\tempfile.py:947: in cleanup
    self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi'>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:929: in _rmtree
    _shutil.rmtree(name, onerror=onerror)
        cls        = <class 'tempfile.TemporaryDirectory'>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F560>
        repeated   = False
..\..\anaconda3\envs\emailops\Lib\shutil.py:787: in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dir_fd     = None
        ignore_errors = False
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F560>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi'
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry '_chunks'>]
        entry      = <DirEntry '_chunks'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi\\_chunks'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F560>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB14873C0>
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry '_chunker_state'>]
        entry      = <DirEntry '_chunker_state'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi\\_chunks\\_chunker_state'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F560>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi\\_chunks'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1486600>
..\..\anaconda3\envs\emailops\Lib\shutil.py:634: in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
        entries    = [<DirEntry 'chunk_20251011_010247.log'>]
        entry      = <DirEntry 'chunk_20251011_010247.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi\\_chunks\\_chunker_state\\chunk_20251011_010247.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F560>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi\\_chunks\\_chunker_state'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1487680>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:893: in onerror
    _os.unlink(path)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi\\_chunks\\_chunker_state\\chunk_20251011_010247.log'
        cls        = <class 'tempfile.TemporaryDirectory'>
        exc_info   = (<class 'PermissionError'>,
 PermissionError(13, 'The process cannot access the file because it is being used by another process'),
 <traceback object at 0x0000017FB542F4C0>)
        func       = <built-in function unlink>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi'
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi\\_chunks\\_chunker_state\\chunk_20251011_010247.log'
        repeated   = False
        st         = os.stat_result(st_mode=33206, st_ino=844424931729745, st_dev=686416114, st_nlink=1, st_uid=0, st_gid=0, st_size=0, st_atime=1760130167, st_mtime=1760130167, st_ctime=1760130167)
_________________ TestMonitoringFunctions.test_print_summary __________________
..\..\anaconda3\envs\emailops\Lib\shutil.py:632: in _rmtree_unsafe
    os.unlink(fullname)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi\\_chunks\\_chunker_state\\chunk_20251011_010248.log'
        entries    = [<DirEntry 'chunk_20251011_010248.log'>]
        entry      = <DirEntry 'chunk_20251011_010248.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi\\_chunks\\_chunker_state\\chunk_20251011_010248.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F4C0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi\\_chunks\\_chunker_state'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1486E40>

During handling of the above exception, another exception occurred:
tests\unit\test_processor.py:931: in test_print_summary
    with tempfile.TemporaryDirectory() as tmpdir:
        mock_config = <Mock name='get_config()' id='1648026103888'>
        mock_get_config = <MagicMock name='get_config' id='1648026095312'>
        mock_print = <MagicMock name='print' id='1648013527248'>
        print_calls = ["call('\\n================================================================================')",
 "call('PROCESSING COMPLETED')",
 "call('================================================================================')",
 "call('Total processed: 8')",
 "call('Total errors: 3')"]
        processor  = <processing.processor.UnifiedProcessor object at 0x0000017FB602A690>
        self       = <test_processor.TestMonitoringFunctions testMethod=test_print_summary>
        tmpdir     = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi'
        worker_states = {0: WorkerStats(worker_id=0,
                docs_processed=5,
                docs_total=10,
                chunks_created=50,
                bytes_processed=5000,
                bytes_total=10000,
                start_time=1760130168.1859758,
                last_update=1760130168.1859758,
                errors=2,
                status='completed',
                current_doc=None),
 1: WorkerStats(worker_id=1,
                docs_processed=3,
                docs_total=5,
                chunks_created=30,
                bytes_processed=3000,
                bytes_total=5000,
                start_time=1760130168.1859758,
                last_update=1760130168.1859758,
                errors=1,
                status='completed',
                current_doc=None)}
..\..\anaconda3\envs\emailops\Lib\tempfile.py:943: in __exit__
    self.cleanup()
        exc        = None
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi'>
        tb         = None
        value      = None
..\..\anaconda3\envs\emailops\Lib\tempfile.py:947: in cleanup
    self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
        self       = <TemporaryDirectory 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi'>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:929: in _rmtree
    _shutil.rmtree(name, onerror=onerror)
        cls        = <class 'tempfile.TemporaryDirectory'>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F4C0>
        repeated   = False
..\..\anaconda3\envs\emailops\Lib\shutil.py:787: in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dir_fd     = None
        ignore_errors = False
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F4C0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi'
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry '_chunks'>]
        entry      = <DirEntry '_chunks'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi\\_chunks'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F4C0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1488180>
..\..\anaconda3\envs\emailops\Lib\shutil.py:629: in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
        entries    = [<DirEntry '_chunker_state'>]
        entry      = <DirEntry '_chunker_state'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi\\_chunks\\_chunker_state'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F4C0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi\\_chunks'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1487C00>
..\..\anaconda3\envs\emailops\Lib\shutil.py:634: in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
        entries    = [<DirEntry 'chunk_20251011_010248.log'>]
        entry      = <DirEntry 'chunk_20251011_010248.log'>
        fullname   = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi\\_chunks\\_chunker_state\\chunk_20251011_010248.log'
        onerror    = <function TemporaryDirectory._rmtree.<locals>.onerror at 0x0000017FB403F4C0>
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi\\_chunks\\_chunker_state'
        scandir_it = <nt.ScandirIterator object at 0x0000017FB1486E40>
..\..\anaconda3\envs\emailops\Lib\tempfile.py:893: in onerror
    _os.unlink(path)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi\\_chunks\\_chunker_state\\chunk_20251011_010248.log'
        cls        = <class 'tempfile.TemporaryDirectory'>
        exc_info   = (<class 'PermissionError'>,
 PermissionError(13, 'The process cannot access the file because it is being used by another process'),
 <traceback object at 0x0000017FB41AD2C0>)
        func       = <built-in function unlink>
        ignore_errors = False
        name       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi'
        path       = 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi\\_chunks\\_chunker_state\\chunk_20251011_010248.log'
        repeated   = False
        st         = os.stat_result(st_mode=33206, st_ino=844424931729749, st_dev=686416114, st_nlink=1, st_uid=0, st_gid=0, st_size=0, st_atime=1760130168, st_mtime=1760130168, st_ctime=1760130168)
============================== warnings summary ===============================
..\..\anaconda3\envs\emailops\Lib\site-packages\_pytest\config\__init__.py:1474
  C:\Users\ASUS\anaconda3\envs\emailops\Lib\site-packages\_pytest\config\__init__.py:1474: PytestConfigWarning: Unknown config option: timeout
  
    self._warn_or_fail_if_strict(f"Unknown config option: {key}\n")

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=============================== tests coverage ================================
______________ coverage: platform win32, python 3.11.13-final-0 _______________

Name                                 Stmts   Miss  Cover   Missing
------------------------------------------------------------------
diagnostics\__init__.py                  7      0   100%
diagnostics\diagnostics.py             243     78    68%   122-216, 249, 255-257, 264-266, 295, 305-309, 380-383, 410-411, 414-415, 433-434, 449-456
diagnostics\monitor.py                 355    121    66%   22-23, 28-29, 34-36, 43-45, 80-81, 175, 209-210, 244, 251, 256, 268-274, 297, 326-327, 330-333, 352-354, 385-397, 412, 428-429, 445-448, 459-460, 476, 486-487, 496, 501-502, 524-525, 530, 535-543, 553-650, 654
diagnostics\statistics.py              255     38    85%   25-30, 216, 218, 303-305, 321-333, 424-426, 443-461
diagnostics\utils.py                    28      0   100%
emailops\config.py                      85      1    99%   95
emailops\doctor.py                     151    151     0%   2-252
emailops\email_indexer.py              532    532     0%   2-1003
emailops\env_utils.py                   12      0   100%
emailops\index_metadata.py             390    330    15%   113-118, 125-128, 137-141, 156-175, 183-199, 206-219, 227-246, 250-263, 270-283, 287-292, 302-341, 355-417, 421-423, 434-435, 437-439, 448-513, 522-601, 605-687, 701-714, 718-720
emailops\llm_client.py                  60      5    92%   114, 118-120, 139
emailops\llm_runtime.py                453    355    22%   51, 94, 101-119, 123-125, 137-167, 172-173, 180-188, 209, 227, 240, 247-259, 266-276, 292-311, 315-343, 358-359, 375-389, 393-394, 403-405, 412-415, 419, 433-457, 461-470, 482-522, 529-533, 554-563, 569-679, 685-686, 690-703, 707-734, 738-759, 763-780, 784-816, 820-829, 838-840
emailops\search_and_draft.py          1140   1140     0%   1-2350
emailops\summarize_email_thread.py     515    515     0%   2-1256
emailops\text_chunker.py              1008    909    10%   85-87, 91-98, 115-117, 121-128, 136, 139, 146-147, 150, 153, 156-159, 162-166, 169-182, 186-197, 201-219, 230-285, 293-307, 315-401, 412-487, 509-538, 544-567, 574-611, 615-632, 636-653, 657-674, 678-697, 707-723, 727-747, 751-854, 861-958, 962-988, 992-1126, 1134-1289, 1295-1350, 1353-1370, 1373-1386, 1393-1469, 1473-1474
emailops\utils.py                      449    244    46%   92-96, 117-121, 126-144, 149-196, 201-229, 255-298, 302-321, 325-338, 342-383, 387-424, 428, 592-593, 655-657, 678-704, 716-718, 726-727, 736-747, 764-765, 771-772
emailops\validators.py                  98     12    88%   39-40, 52, 60-61, 92-93, 111, 117-120
processing\__init__.py                   5      0   100%
processing\processor.py                650    275    58%   84, 109, 115, 173-176, 198-208, 226-299, 325-334, 387, 397-414, 426, 432, 435-436, 438-439, 445, 451-484, 488-508, 539-565, 574-575, 579-580, 587-588, 624, 629-630, 639-701, 709-749, 769-770, 789-790, 810-811, 830-832, 835-836, 860-861, 865-870, 879-880, 884-886, 890-891, 907-908, 921-938, 942-943, 975-978, 1045-1046
setup\__init__.py                        4      4     0%   7-13
setup\enable_vertex_apis.py            119    119     0%   11-233
ui\__init__.py                           4      4     0%   7-13
ui\emailops_ui.py                      961    961     0%   21-2363
------------------------------------------------------------------
TOTAL                                 7524   5794    23%
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml
FAIL Required test coverage of 60% not reached. Total coverage: 22.99%
============================ slowest 10 durations =============================
4.97s setup    tests/integration/test_embedding_pipeline.py::TestProviderBehavior::test_vertex_provider_initialization
2.69s call     tests/unit/test_validators.py::TestValidateDirectoryPath::test_cross_platform_paths[\\\\server\\share-True]
1.51s call     tests/unit/test_monitor.py::TestCheckStatus::test_check_status_detects_inactive_indexing
1.38s call     tests/unit/test_monitor.py::TestFindProcesses::test_find_processes_returns_list
1.15s call     tests/unit/test_llm_client.py::TestLLMClient::test_embed_texts
0.36s call     tests/unit/test_monitor.py::TestMonitorEdgeCases::test_check_status_with_very_large_index
0.17s call     tests/unit/test_emailops_utils.py::TestHtmlToText::test_html_to_text_complex
0.07s call     tests/integration/test_index_workflow.py::TestIndexPerformance::test_index_with_large_number_of_documents
0.03s call     tests/integration/test_index_workflow.py::TestIndexUpdateAndRepair::test_append_new_documents_to_existing_index
0.03s call     tests/unit/test_statistics.py::TestAnalyzeFileProcessing::test_analyze_file_processing_runs_without_error
=========================== short test summary info ===========================
SKIPPED [1] tests\test_all_accounts_live.py:89: GCP credentials not available for testing
ERROR tests/unit/test_diagnostics.py::test_account
FAILED tests/integration/test_core_workflows.py::TestDocumentProcessingWorkflow::test_document_processing_workflow - AttributeError: <module 'emailops.text_chunker' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\text_chunker.py'> does not have the attribute 'TextChunker'
FAILED tests/integration/test_core_workflows.py::TestDocumentProcessingWorkflow::test_error_recovery_workflow - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'embed_texts'
FAILED tests/integration/test_core_workflows.py::TestEmbeddingWorkflow::test_embedding_batch_processing - AttributeError: <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'> does not have the attribute 'llm_runtime'
FAILED tests/integration/test_core_workflows.py::TestEmbeddingWorkflow::test_embedding_error_handling - AttributeError: <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'> does not have the attribute 'llm_runtime'
FAILED tests/integration/test_core_workflows.py::TestEmbeddingWorkflow::test_embedding_pipeline_openai - AttributeError: <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'> does not have the attribute 'llm_runtime'
FAILED tests/integration/test_core_workflows.py::TestEmbeddingWorkflow::test_embedding_pipeline_vertex - AttributeError: <module 'emailops.llm_client' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\llm_client.py'> does not have the attribute 'llm_runtime'
FAILED tests/integration/test_core_workflows.py::TestSecurityWorkflow::test_command_validation_workflow - AssertionError: assert not (True, 'Valid')
 +  where (True, 'Valid') = <function validate_command_args at 0x0000017FA60C2AC0>('rm', ['-rf', '/'])
FAILED tests/integration/test_core_workflows.py::TestSecurityWorkflow::test_environment_variable_workflow - AssertionError: assert not (False, 'Environment variable name cannot be empty')
 +  where (False, 'Environment variable name cannot be empty') = <function validate_environment_variable at 0x0000017FA60C2CA0>('', 'value')
FAILED tests/integration/test_core_workflows.py::TestSecurityWorkflow::test_path_validation_workflow - AssertionError: assert not (False, 'Path traversal detected (.. not allowed)')
 +  where (False, 'Path traversal detected (.. not allowed)') = <function validate_directory_path at 0x0000017FA60C28E0>('../../../etc')
FAILED tests/integration/test_core_workflows.py::TestIndexWorkflow::test_index_creation_workflow - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'faiss'
FAILED tests/integration/test_core_workflows.py::TestIndexWorkflow::test_index_repair_workflow - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'embed_texts'
FAILED tests/integration/test_core_workflows.py::TestMonitoringWorkflow::test_diagnostics_workflow - AttributeError: 'dict' object has no attribute 'project_id'
FAILED tests/integration/test_core_workflows.py::TestMonitoringWorkflow::test_index_monitoring_workflow - AssertionError: assert False
 +  where False = hasattr(IndexStatus(root_dir='C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpnwemudm4', index_dir='C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpnwemudm4\\_index', index_exists=True, documents_indexed=2, conversations_total=0, conversations_indexed=0, progress_percent=0.0, last_updated='2025-10-10T21:02:30.719368+00:00', is_active=True, active_source='index.faiss', index_file='index.faiss', index_file_size_mb=0.0, provider=None, model=None, actual_dimensions=None, index_type=None), 'status')
FAILED tests/integration/test_core_workflows.py::TestMonitoringWorkflow::test_statistics_workflow - KeyError: 'conversation_count'
FAILED tests/integration/test_core_workflows.py::TestEmailProcessingWorkflow::test_conversation_loading_workflow - AssertionError: assert 'Email conversation content\n\n--- ATTACHMENT: test.txt ---\n\nAttachment content' == 'Email conversation content'
  
  - Email conversation content
  + Email conversation content
  ?                           +
  + 
  + --- ATTACHMENT: test.txt ---
  + 
  + Attachment content
FAILED tests/integration/test_core_workflows.py::TestEndToEndWorkflow::test_complete_pipeline - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'embed_texts'
FAILED tests/unit/test_emailops_utils.py::TestHtmlToText::test_html_to_text_without_beautifulsoup - AttributeError: <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'> does not have the attribute 'BeautifulSoup'
FAILED tests/unit/test_emailops_utils.py::TestExtractText::test_extract_text_docx_file - AttributeError: <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'> does not have the attribute 'docx'
FAILED tests/unit/test_emailops_utils.py::TestExtractText::test_extract_text_pdf_file - AttributeError: <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'> does not have the attribute 'PdfReader'
FAILED tests/unit/test_emailops_utils.py::TestSplitEmailThread::test_split_email_thread_with_dates - AttributeError: <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'> does not have the attribute 'parsedate_to_datetime'
FAILED tests/unit/test_emailops_utils.py::TestEmailParsing::test_extract_eml_success - AttributeError: <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'> does not have the attribute 'BytesParser'
FAILED tests/unit/test_emailops_utils.py::TestEmailParsing::test_extract_msg_success - AttributeError: <module 'emailops.utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\utils.py'> does not have the attribute 'extract_msg'
FAILED tests/unit/test_env_utils.py::TestEnvUtils::test_default_accounts_exported - AssertionError: assert [{'project_id': 'api-agent-470921', 'credentials_path': 'secrets/api-agent-470921-4e2065b2ecf9.json'}, {'project_id': 'apt-arcana-470409-i7', 'credentials_path': 'secrets/apt-arcana-470409-i7-ce42b76061bf.json'}, {'project_id': 'embed2-474114', 'credentials_path': 'secrets/embed2-474114-fca38b4d2068.json'}, {'project_id': 'crafty-airfoil-474021-s2', 'credentials_path': 'secrets/crafty-airfoil-474021-s2-34159960925b.json'}, {'project_id': 'my-project-31635v', 'credentials_path': 'secrets/my-project-31635v-8ec357ac35b2.json'}, {'project_id': 'semiotic-nexus-470620-f3', 'credentials_path': 'secrets/semiotic-nexus-470620-f3-3240cfaf6036.json'}] is ['account1', 'account2']
 +  where [{'project_id': 'api-agent-470921', 'credentials_path': 'secrets/api-agent-470921-4e2065b2ecf9.json'}, {'project_id': 'apt-arcana-470409-i7', 'credentials_path': 'secrets/apt-arcana-470409-i7-ce42b76061bf.json'}, {'project_id': 'embed2-474114', 'credentials_path': 'secrets/embed2-474114-fca38b4d2068.json'}, {'project_id': 'crafty-airfoil-474021-s2', 'credentials_path': 'secrets/crafty-airfoil-474021-s2-34159960925b.json'}, {'project_id': 'my-project-31635v', 'credentials_path': 'secrets/my-project-31635v-8ec357ac35b2.json'}, {'project_id': 'semiotic-nexus-470620-f3', 'credentials_path': 'secrets/semiotic-nexus-470620-f3-3240cfaf6036.json'}] = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.DEFAULT_ACCOUNTS
 +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_default_accounts_exported>.env_utils
 +  and   ['account1', 'account2'] = <MagicMock id='1647978612624'>.DEFAULT_ACCOUNTS
 +    where <MagicMock id='1647978612624'> = <test_env_utils.TestEnvUtils testMethod=test_default_accounts_exported>.mock_runtime
FAILED tests/unit/test_env_utils.py::TestEnvUtils::test_function_forwarding_with_args_and_kwargs - TypeError: load_validated_accounts() got an unexpected keyword argument 'force_reload'
FAILED tests/unit/test_env_utils.py::TestEnvUtils::test_init_vertex_exported - AssertionError: assert <function _init_vertex at 0x0000017FA5D34900> is <Mock name='mock._init_vertex' id='1647973511632'>
 +  where <function _init_vertex at 0x0000017FA5D34900> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>._init_vertex
 +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_init_vertex_exported>.env_utils
 +  and   <Mock name='mock._init_vertex' id='1647973511632'> = <MagicMock id='1647975094864'>._init_vertex
 +    where <MagicMock id='1647975094864'> = <test_env_utils.TestEnvUtils testMethod=test_init_vertex_exported>.mock_runtime
FAILED tests/unit/test_env_utils.py::TestEnvUtils::test_llmerror_exported - AssertionError: assert <class 'emailops.llm_runtime.LLMError'> is <class 'test_env_utils.LLMError'>
 +  where <class 'emailops.llm_runtime.LLMError'> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.LLMError
 +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_llmerror_exported>.env_utils
 +  and   <class 'test_env_utils.LLMError'> = <MagicMock id='1647980686992'>.LLMError
 +    where <MagicMock id='1647980686992'> = <test_env_utils.TestEnvUtils testMethod=test_llmerror_exported>.mock_runtime
FAILED tests/unit/test_env_utils.py::TestEnvUtils::test_load_validated_accounts_exported - AssertionError: assert <function load_validated_accounts at 0x0000017FA5D342C0> is <Mock name='mock.load_validated_accounts' id='1647978336464'>
 +  where <function load_validated_accounts at 0x0000017FA5D342C0> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.load_validated_accounts
 +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_load_validated_accounts_exported>.env_utils
 +  and   <Mock name='mock.load_validated_accounts' id='1647978336464'> = <MagicMock id='1647978626192'>.load_validated_accounts
 +    where <MagicMock id='1647978626192'> = <test_env_utils.TestEnvUtils testMethod=test_load_validated_accounts_exported>.mock_runtime
FAILED tests/unit/test_env_utils.py::TestEnvUtils::test_no_additional_symbols_exported - AssertionError: Unexpected public attributes: {'annotations'}
assert not {'annotations'}
FAILED tests/unit/test_env_utils.py::TestEnvUtils::test_reset_vertex_init_exported - AssertionError: assert <function reset_vertex_init at 0x0000017FA5D34540> is <Mock name='mock.reset_vertex_init' id='1647978138256'>
 +  where <function reset_vertex_init at 0x0000017FA5D34540> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.reset_vertex_init
 +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_reset_vertex_init_exported>.env_utils
 +  and   <Mock name='mock.reset_vertex_init' id='1647978138256'> = <MagicMock id='1647979598352'>.reset_vertex_init
 +    where <MagicMock id='1647979598352'> = <test_env_utils.TestEnvUtils testMethod=test_reset_vertex_init_exported>.mock_runtime
FAILED tests/unit/test_env_utils.py::TestEnvUtils::test_save_validated_accounts_exported - AssertionError: assert <function save_validated_accounts at 0x0000017FA5D347C0> is <Mock name='mock.save_validated_accounts' id='1647973996752'>
 +  where <function save_validated_accounts at 0x0000017FA5D347C0> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.save_validated_accounts
 +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_save_validated_accounts_exported>.env_utils
 +  and   <Mock name='mock.save_validated_accounts' id='1647973996752'> = <MagicMock id='1647974001296'>.save_validated_accounts
 +    where <MagicMock id='1647974001296'> = <test_env_utils.TestEnvUtils testMethod=test_save_validated_accounts_exported>.mock_runtime
FAILED tests/unit/test_env_utils.py::TestEnvUtils::test_validate_account_exported - AssertionError: assert <function validate_account at 0x0000017FA5D349A0> is <Mock name='mock.validate_account' id='1647978170256'>
 +  where <function validate_account at 0x0000017FA5D349A0> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.validate_account
 +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_validate_account_exported>.env_utils
 +  and   <Mock name='mock.validate_account' id='1647978170256'> = <MagicMock id='1647978181328'>.validate_account
 +    where <MagicMock id='1647978181328'> = <test_env_utils.TestEnvUtils testMethod=test_validate_account_exported>.mock_runtime
FAILED tests/unit/test_env_utils.py::TestEnvUtils::test_vertex_account_exported - AssertionError: assert <class 'emailops.llm_runtime.VertexAccount'> is <class 'test_env_utils.VertexAccount'>
 +  where <class 'emailops.llm_runtime.VertexAccount'> = <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'>.VertexAccount
 +    where <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> = <test_env_utils.TestEnvUtils testMethod=test_vertex_account_exported>.env_utils
 +  and   <class 'test_env_utils.VertexAccount'> = <MagicMock id='1647978342480'>.VertexAccount
 +    where <MagicMock id='1647978342480'> = <test_env_utils.TestEnvUtils testMethod=test_vertex_account_exported>.mock_runtime
FAILED tests/unit/test_env_utils.py::TestEnvUtilsErrorHandling::test_missing_runtime_attribute - Failed: DID NOT RAISE <class 'AttributeError'>
FAILED tests/unit/test_env_utils.py::TestEnvUtilsErrorHandling::test_runtime_function_raises_error - emailops.llm_runtime.LLMError: No valid GCP accounts found. Provide validated_accounts.json or valid files in secrets/.
FAILED tests/unit/test_env_utils.py::TestEnvUtilsErrorHandling::test_runtime_module_import_error - AttributeError: <module 'emailops.env_utils' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\env_utils.py'> does not have the attribute 'llm_runtime'
FAILED tests/unit/test_env_utils.py::TestEnvUtilsIntegration::test_chained_function_calls - emailops.llm_runtime.LLMError: Failed to initialize Vertex AI SDK: Could not deserialize key data. The data may be in an incorrect format, it may be encrypted with an unsupported algorithm, or it may be an unsupported key type (e.g. EC curves with explicit parameters). Details: ASN.1 parsing error: invalid length
FAILED tests/unit/test_env_utils.py::TestEnvUtilsIntegration::test_default_accounts_modification - AssertionError: assert [{'project_id': 'api-agent-470921', 'credentials_path': 'secrets/api-agent-470921-4e2065b2ecf9.json'}, {'project_id': 'apt-arcana-470409-i7', 'credentials_path': 'secrets/apt-arcana-470409-i7-ce42b76061bf.json'}, {'project_id': 'embed2-474114', 'credentials_path': 'secrets/embed2-474114-fca38b4d2068.json'}, {'project_id': 'crafty-airfoil-474021-s2', 'credentials_path': 'secrets/crafty-airfoil-474021-s2-34159960925b.json'}, {'project_id': 'my-project-31635v', 'credentials_path': 'secrets/my-project-31635v-8ec357ac35b2.json'}, {'project_id': 'semiotic-nexus-470620-f3', 'credentials_path': 'secrets/semiotic-nexus-470620-f3-3240cfaf6036.json'}] == ['acc1', 'acc2']
  
  At index 0 diff: {'project_id': 'api-agent-470921', 'credentials_path': 'secrets/api-agent-470921-4e2065b2ecf9.json'} != 'acc1'
  Left contains 4 more items, first extra item: {'credentials_path': 'secrets/embed2-474114-fca38b4d2068.json', 'project_id': 'embed2-474114'}
  
  Full diff:
    [
  -     'acc1',
  -     'acc2',
  +     {
  +         'credentials_path': 'secrets/api-agent-470921-4e2065b2ecf9.json',
  +         'project_id': 'api-agent-470921',
  +     },
  +     {
  +         'credentials_path': 'secrets/apt-arcana-470409-i7-ce42b76061bf.json',
  +         'project_id': 'apt-arcana-470409-i7',
  +     },
  +     {
  +         'credentials_path': 'secrets/embed2-474114-fca38b4d2068.json',
  +         'project_id': 'embed2-474114',
  +     },
  +     {
  +         'credentials_path': 'secrets/crafty-airfoil-474021-s2-34159960925b.json',
  +         'project_id': 'crafty-airfoil-474021-s2',
  +     },
  +     {
  +         'credentials_path': 'secrets/my-project-31635v-8ec357ac35b2.json',
  +         'project_id': 'my-project-31635v',
  +     },
  +     {
  +         'credentials_path': 'secrets/semiotic-nexus-470620-f3-3240cfaf6036.json',
  +         'project_id': 'semiotic-nexus-470620-f3',
  +     },
    ]
FAILED tests/unit/test_env_utils.py::TestEnvUtilsIntegration::test_vertex_account_instantiation - TypeError: VertexAccount.__init__() got an unexpected keyword argument 'credentials'
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_complete_alias - TypeError: complete_text() missing 1 required positional argument: 'user'
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_complete_json - TypeError: complete_json() got an unexpected keyword argument 'schema'
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_complete_text - TypeError: complete_text() missing 1 required positional argument: 'user'
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_dir_returns_sorted_all - AssertionError: assert 'zebra_func' in ['LLMError', 'complete', 'complete_json', 'complete_text', 'embed', 'embed_texts', 'json_complete']
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_embed_texts - emailops.llm_runtime.LLMError: Set OPENAI_API_KEY
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_embed_with_generator - emailops.llm_runtime.LLMError: Failed to initialize Vertex AI SDK: Could not deserialize key data. The data may be in an incorrect format, it may be encrypted with an unsupported algorithm, or it may be an unsupported key type (e.g. EC curves with explicit parameters). Details: ASN.1 parsing error: invalid length
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_embed_with_list - emailops.llm_runtime.LLMError: Failed to initialize Vertex AI SDK: Could not deserialize key data. The data may be in an incorrect format, it may be encrypted with an unsupported algorithm, or it may be an unsupported key type (e.g. EC curves with explicit parameters). Details: ASN.1 parsing error: invalid length
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_embed_with_tuple - emailops.llm_runtime.LLMError: Failed to initialize Vertex AI SDK: Could not deserialize key data. The data may be in an incorrect format, it may be encrypted with an unsupported algorithm, or it may be an unsupported key type (e.g. EC curves with explicit parameters). Details: ASN.1 parsing error: invalid length
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_getattr_all_deduplicates - AssertionError: assert 'new_func' in ['complete_text', 'complete_json', 'embed_texts', 'complete', 'json_complete', 'embed', 'LLMError']
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_getattr_all_with_llmerror - AssertionError: assert 'extra_func' in ['complete_text', 'complete_json', 'embed_texts', 'complete', 'json_complete', 'embed', 'LLMError']
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_getattr_all_without_llmerror - AssertionError: assert 'LLMError' not in ['complete_text', 'complete_json', 'embed_texts', 'complete', 'json_complete', 'embed', 'LLMError']
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_getattr_forwards_to_runtime - AttributeError: module 'emailops.llm_client' has no attribute 'special_func'
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_getattr_llmerror - AssertionError: assert <class 'emailops.llm_runtime.LLMError'> is <class 'test_llm_client.TestLLMClient.test_getattr_llmerror.<locals>.CustomError'>
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_json_complete_alias - TypeError: complete_json() missing 1 required positional argument: 'user'
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_rt_attr_success - AttributeError: llm_runtime.test_func is not available
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_runtime_exports_filters_non_strings - AssertionError: assert [] == ['func1', 'func2']
  
  Right contains 2 more items, first extra item: 'func1'
  
  Full diff:
  + []
  - [
  -     'func1',
  -     'func2',
  - ]
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_runtime_exports_with_iterable - AssertionError: assert set() == {'func1', 'func2'}
  
  Extra items in the right set:
  'func1'
  'func2'
  
  Full diff:
  + set()
  - {
  -     'func1',
  -     'func2',
  - }
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_runtime_exports_with_list - AssertionError: assert [] == ['func1', 'func2', 'LLMError']
  
  Right contains 3 more items, first extra item: 'func1'
  
  Full diff:
  + []
  - [
  -     'func1',
  -     'func2',
  -     'LLMError',
  - ]
FAILED tests/unit/test_llm_client.py::TestLLMClient::test_runtime_exports_with_tuple - AssertionError: assert [] == ['func1', 'func2']
  
  Right contains 2 more items, first extra item: 'func1'
  
  Full diff:
  + []
  - [
  -     'func1',
  -     'func2',
  - ]
FAILED tests/unit/test_llm_client.py::TestLLMClientIntegration::test_complete_text_error_handling - TypeError: complete_text() missing 1 required positional argument: 'user'
FAILED tests/unit/test_llm_client.py::TestLLMClientIntegration::test_embed_empty_list - AssertionError: Expected 'embed_texts' to be called once. Called 0 times.
FAILED tests/unit/test_llm_client.py::TestLLMClientIntegration::test_multiple_kwargs_forwarding - TypeError: complete_text() got an unexpected keyword argument 'max_tokens'
FAILED tests/unit/test_llm_client.py::TestLLMClientIntegration::test_runtime_attribute_caching_not_performed - AttributeError: module 'emailops.llm_client' has no attribute 'dynamic_func'
FAILED tests/unit/test_llm_client.py::TestLLMClientEdgeCases::test_embed_with_empty_generator - AssertionError: Expected 'embed_texts' to be called once. Called 0 times.
FAILED tests/unit/test_processor.py::TestHelperFunctions::test_initialize_gcp_credentials_from_env - AssertionError: assert '\\path\\to\\creds.json' == '/path/to/creds.json'
  
  - /path/to/creds.json
  ? ^    ^  ^
  + \path\to\creds.json
  ? ^    ^  ^
FAILED tests/unit/test_processor.py::TestHelperFunctions::test_initialize_gcp_credentials_no_env - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
FAILED tests/unit/test_processor.py::TestUnifiedProcessor::test_build_chunk_config_kwargs - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
FAILED tests/unit/test_processor.py::TestUnifiedProcessor::test_distribute_chunking_work - PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpcyxggcd3\\_chunks\\_chunker_state\\chunk_20251011_010244.log'
FAILED tests/unit/test_processor.py::TestUnifiedProcessor::test_find_documents_basic - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
FAILED tests/unit/test_processor.py::TestUnifiedProcessor::test_find_documents_test_mode - PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmp7hdo8pyp\\_chunks\\_chunker_state\\chunk_20251011_010245.log'
FAILED tests/unit/test_processor.py::TestUnifiedProcessor::test_find_documents_with_resume - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
FAILED tests/unit/test_processor.py::TestUnifiedProcessor::test_init_embed_mode - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
FAILED tests/unit/test_processor.py::TestUnifiedProcessor::test_init_with_custom_params - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
FAILED tests/unit/test_processor.py::TestUnifiedProcessor::test_init_with_defaults - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
FAILED tests/unit/test_processor.py::TestUnifiedProcessor::test_init_without_config - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
FAILED tests/unit/test_processor.py::TestChunkWorkerEntry::test_chunk_worker_entry_import_error - AttributeError: <module 'emailops.text_chunker' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\text_chunker.py'> does not have the attribute 'TextChunker'
FAILED tests/unit/test_processor.py::TestChunkWorkerEntry::test_chunk_worker_entry_success - AttributeError: <module 'emailops.text_chunker' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\emailops\\text_chunker.py'> does not have the attribute 'TextChunker'
FAILED tests/unit/test_processor.py::TestEmbeddingOperations::test_create_embeddings_no_credentials - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
FAILED tests/unit/test_processor.py::TestEmbeddingOperations::test_create_embeddings_vertex - AttributeError: <module 'processing.processor' from 'C:\\Users\\ASUS\\Downloads\\emailops_vertex_ai\\processing\\processor.py'> does not have the attribute 'get_config'
FAILED tests/unit/test_processor.py::TestIndexOperations::test_repair_index_no_files - PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpd9bcoe1y\\_index\\repair_20251011_010246.log'
FAILED tests/unit/test_processor.py::TestIndexOperations::test_repair_index_success - PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpg8u8nnlq\\_index\\repair_20251011_010247.log'
FAILED tests/unit/test_processor.py::TestErrorHandling::test_embed_from_chunks_error_handling - PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpk_vt2zit\\_index\\embed_20251011_010247.log'
FAILED tests/unit/test_processor.py::TestErrorHandling::test_fix_failed_embeddings_re_embed_error - PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmps7rahzde\\_index\\fix_20251011_010247.log'
FAILED tests/unit/test_processor.py::TestErrorHandling::test_sequential_chunk_import_error - PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpy6xpngd6\\_chunks\\_chunker_state\\chunk_20251011_010247.log'
FAILED tests/unit/test_processor.py::TestMonitoringFunctions::test_display_progress_tty - PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpup8d6eyi\\_chunks\\_chunker_state\\chunk_20251011_010247.log'
FAILED tests/unit/test_processor.py::TestMonitoringFunctions::test_print_summary - PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ASUS\\AppData\\Local\\Temp\\tmpj8fsmbfi\\_chunks\\_chunker_state\\chunk_20251011_010248.log'
======= 84 failed, 431 passed, 1 skipped, 1 warning, 1 error in 25.92s ========
