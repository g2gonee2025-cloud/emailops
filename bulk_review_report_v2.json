{
  "timestamp": "2025-12-26T15:32:44.901644",
  "summary": {
    "total_files": 186,
    "skipped": 2,
    "failed": 5,
    "models": [
      "openai-gpt-oss-120b"
    ],
    "total_unique_issues": 459
  },
  "issues": [
    {
      "category": "NULL_SAFETY",
      "line": 47,
      "description": "The call to `get_config()` assumes it always returns an object with a `SECRET_KEY` attribute; if it returns `None` or a config without that attribute, an `AttributeError` will be raised before the explicit check.",
      "file": "backend/src/cortex/routes_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 71,
      "description": "A bare `except Exception as e` is used around JWT encoding, which swallows all possible exceptions (including unexpected ones) and re\u2011raises a generic `HTTPException`, losing the original traceback context.",
      "file": "backend/src/cortex/routes_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 30,
      "description": "Mock user credentials are stored in plain text within the source code, which is insecure even for development; if this file is accidentally shipped to production the credentials could be exposed.",
      "file": "backend/src/cortex/routes_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 68,
      "description": "The JWT payload includes `iat` and `exp` fields as `datetime` objects rather than Unix timestamps; depending on the JWT library this may result in improperly formatted tokens that could be rejected or misinterpreted.",
      "file": "backend/src/cortex/routes_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 62,
      "description": "The `expires_seconds` value is hard\u2011coded and recomputed on each request; defining it as a module\u2011level constant would avoid repeated allocation.",
      "file": "backend/src/cortex/routes_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 28,
      "description": "Magic numbers like `86400` (seconds in a day) are used directly in the code without a named constant, reducing readability.",
      "file": "backend/src/cortex/routes_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 66,
      "description": "`payload` is annotated as `dict[str, Any]` but includes `datetime` objects for `iat` and `exp`; typical JWT libraries expect integer timestamps, leading to a type mismatch between the declared type and the actual required type.",
      "file": "backend/src/cortex/routes_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 48,
      "description": "Broad use of `contextlib.suppress(Exception)` around Tika parsing silently ignores all errors, making debugging and error reporting difficult.",
      "file": "backend/src/cortex/text_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 80,
      "description": "Multiple generic `except Exception` clauses (e.g., in `_extract_with_unstructured`, `_extract_image_ocr`, `_extract_pdf_with_ocr`) swallow unexpected exceptions and hide root causes.",
      "file": "backend/src/cortex/text_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 56,
      "description": "The regex used to validate `TIKA_SERVER_URL` is permissive and allows arbitrary hostnames/ports, which may enable SSRF if the environment variable is controlled by an attacker.",
      "file": "backend/src/cortex/text_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 61,
      "description": "Setting `os.environ['TIKA_SERVER_ENDPOINT']` globally based on a possibly untrusted URL can affect other parts of the process and other threads.",
      "file": "backend/src/cortex/text_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 146,
      "description": "In `_extract_pdf_tables`, the code reads the same PDF twice \u2013 first with Camelot, then again with pdfplumber if Camelot yields no tables \u2013 leading to unnecessary I/O.",
      "file": "backend/src/cortex/text_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 57,
      "description": "Line exceeds typical 79\u2011character limit (`logger.warning(\"Invalid TIKA_SERVER_URL format ignored: %s\", tika_server_url)`).",
      "file": "backend/src/cortex/text_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 118,
      "description": "Long line with many keyword arguments in the `kwargs` dictionary for `partition` exceeds the recommended line length.",
      "file": "backend/src/cortex/text_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 31,
      "description": "Function `_is_cache_valid` lacks a return type annotation, reducing clarity for callers.",
      "file": "backend/src/cortex/text_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 199,
      "description": "In `_extract_msg`, `getattr(m, \"htmlBody\", None)` may return a non\u2011string (e.g., bytes); `_html_to_text` expects a string and could raise a `TypeError`.",
      "file": "backend/src/cortex/text_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 70,
      "description": "The repair loop updates `validation_errors` after a failed attempt but never rebuilds `full_prompt` with the new errors, so subsequent attempts use stale error information.",
      "file": "backend/src/cortex/safety/guardrails_client.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 124,
      "description": "`GuardrailsClient.validate_output` passes the full `max_retries` count to `_attempt_repair` after already having performed one validation attempt, resulting in an off\u2011by\u2011one number of repair attempts.",
      "file": "backend/src/cortex/safety/guardrails_client.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 84,
      "description": "A bare `except Exception` clause catches all exceptions, logs a warning, and continues the loop, potentially masking unexpected errors and making debugging difficult.",
      "file": "backend/src/cortex/safety/guardrails_client.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 71,
      "description": "Inside the repair loop the same `full_prompt` string is recomputed (including JSON dumps) on every iteration even though it does not change, incurring unnecessary overhead.",
      "file": "backend/src/cortex/safety/guardrails_client.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 31,
      "description": "Duplicate placeholder `error` and `validation_errors` are passed to `get_prompt`; one of them is redundant and may cause confusion if the prompt template does not expect both.",
      "file": "backend/src/cortex/safety/guardrails_client.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 165,
      "description": "If `metadata` is passed as `None`, the final `PolicyDecision` construction accesses `metadata.keys()` which will raise an `AttributeError`. The code only guards against `None` for the policy checks but not for this later use.",
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 143,
      "description": "The admin bypass mechanism trusts the presence of `admin_bypass` and `admin_confirmed` flags without any cryptographic verification or identity check, allowing privilege escalation if a caller can inject those keys into the metadata.",
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 119,
      "description": "The external recipient regex `EXTERNAL_DOMAIN_PATTERN = re.compile(r\"@(?!internal\\.company\\.com$)\", re.IGNORECASE)` matches any '@' that is not followed immediately by `internal.company.com`. It will also match strings like `'user@external.com extra@'` where the look\u2011ahead fails, potentially misclassifying internal addresses that have extra characters after the domain.",
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 18,
      "description": "A broad `except Exception` is used when importing `InjectionDefense`; this swallows all import\u2011related errors without logging, making debugging difficult.",
      "file": "backend/src/cortex/safety/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 32,
      "description": "The instantiation of `InjectionDefense` is wrapped in a generic `except Exception` that silently returns the original text, hiding any constructor failures.",
      "file": "backend/src/cortex/safety/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 45,
      "description": "When invoking a possible injection\u2011defense method, any exception is caught generically and the loop is aborted (`break`). The error is ignored and no logging is performed, potentially masking bugs.",
      "file": "backend/src/cortex/safety/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 45,
      "description": "If a callable method raises an exception, the loop breaks and no alternative methods are tried, which may prevent a working sanitisation routine from being used.",
      "file": "backend/src/cortex/safety/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 44,
      "description": "The wrapper returns the direct result of `method(text)` without verifying it is a string; if the method returns `None` (or any non\u2011string), callers expecting a string may encounter `NoneType` errors later.",
      "file": "backend/src/cortex/safety/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 22,
      "description": "The function `strip_injection_patterns` lacks type annotations for its parameters and return value, violating typical type\u2011hinting conventions.",
      "file": "backend/src/cortex/safety/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 14,
      "description": "`check_action` is imported but never used and is not listed in `__all__`; this constitutes dead code and an unnecessary import.",
      "file": "backend/src/cortex/safety/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 49,
      "description": "`__all__` does not include `check_action`, which was imported for public use, leading to an inconsistent public API definition.",
      "file": "backend/src/cortex/safety/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 22,
      "description": "Absence of type hints makes static type checking impossible for this public API, potentially causing type\u2011related bugs in downstream code.",
      "file": "backend/src/cortex/safety/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 21,
      "description": "tenant_id and user_id fields are declared with Optional[str] = None but without using Field; this omits explicit description and may reduce clarity for static analysis tools.",
      "file": "backend/src/cortex/rag_api/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 64,
      "description": "tenant_id and user_id in AnswerRequest are also declared without Field, losing the chance to document them consistently.",
      "file": "backend/src/cortex/rag_api/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 87,
      "description": "tenant_id and user_id in DraftEmailRequest are declared without Field, similar documentation inconsistency.",
      "file": "backend/src/cortex/rag_api/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 107,
      "description": "tenant_id and user_id in SummarizeThreadRequest are declared without Field, missing explicit description.",
      "file": "backend/src/cortex/rag_api/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 126,
      "description": "In ChatRequest, the description for max_length mentions \"Max summary length in words\" which is misleading for a chat request payload.",
      "file": "backend/src/cortex/rag_api/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 139,
      "description": "ChatResponse includes optional fields answer, summary, and search_results regardless of the selected action; this can lead to ambiguous or incomplete responses if the caller assumes the presence of a field based on the action.",
      "file": "backend/src/cortex/rag_api/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 34,
      "description": "SearchResponse.results is typed as List[Dict[str, Any]] but the model does not enforce a concrete schema for each result entry, which may cause downstream type\u2011checking issues.",
      "file": "backend/src/cortex/rag_api/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 28,
      "description": "Catches the broad ``Exception`` class, which also intercepts system\u2011level exceptions like ``KeyboardInterrupt`` and ``SystemExit``; this can hide important termination signals and make debugging harder.",
      "file": "backend/src/cortex/utils/atomic_io.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 22,
      "description": "Uses the magic number ``0o600`` directly for file permissions without a named constant or comment clarifying its intent.",
      "file": "backend/src/cortex/utils/atomic_io.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 45,
      "description": "Performs an unnecessary ``hasattr(os, \"open\")`` and ``hasattr(os, \"O_RDONLY\")`` check; these attributes are guaranteed to exist on supported platforms, making the conditional superfluous.",
      "file": "backend/src/cortex/utils/atomic_io.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 31,
      "description": "tenant_id_ctx.get() and user_id_ctx.get() may return None; the KBSearchInput is built without guarding against missing tenant or user identifiers, which could cause downstream failures.",
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 71,
      "description": "request.query is used directly in hashlib.sha256(request.query.encode()); if query is None, this will raise an AttributeError.",
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 84,
      "description": "The expression \"[r.model_dump() for r in results.results] if results.results else []\" accesses results.results before checking that results itself is not None, leading to a possible AttributeError when results is None.",
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 90,
      "description": "SearchResponse is instantiated with correlation_id that may be None, while the response model likely expects a non\u2011optional string.",
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 97,
      "description": "CortexError does not define a to_dict() method, so calling e.to_dict() will raise an AttributeError and mask the original error handling logic.",
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 101,
      "description": "A broad \"except Exception\" catches all unexpected errors, potentially swallowing important exceptions and making debugging harder; more specific exception handling is advisable.",
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 1,
      "description": "The module imports \"hashlib\" twice (once at the top of the file and again inside the function), which is redundant.",
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 55,
      "description": "Catches a broad `Exception` which can swallow unexpected errors and makes debugging harder; specific exception types should be caught or the exception re\u2011raised after logging.",
      "file": "backend/src/cortex/intelligence/summarizer.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 32,
      "description": "Uses a magic number `4` for the estimated characters\u2011per\u2011token conversion without an explanatory constant or comment, reducing code readability and maintainability.",
      "file": "backend/src/cortex/intelligence/summarizer.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 59,
      "description": "`embed_summary` is annotated to return `list[float]`, but when the embedding is a NumPy array the method returns the result of `.tolist()` which yields a list of NumPy scalar types (e.g., `np.float32`), violating the declared return type.",
      "file": "backend/src/cortex/intelligence/summarizer.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 106,
      "description": "In `_chunk_text` the start index is reset with `start = end - self.overlap`. If the newline\u2011based truncation sets `end` far before `self.chunk_size`, `start` can move backwards, causing an infinite loop for certain inputs.",
      "file": "backend/src/cortex/intelligence/graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 143,
      "description": "`_parse_json_to_graph` accesses `node[\"name\"]` and `node[\"type\"]` directly without verifying the keys exist, which can raise a `KeyError` when the LLM output omits them.",
      "file": "backend/src/cortex/intelligence/graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 155,
      "description": "`_parse_json_to_graph` also accesses `edge[\"source\"]` and `edge[\"target\"]` without presence checks, leading to possible `KeyError` if the schema validation fails.",
      "file": "backend/src/cortex/intelligence/graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 132,
      "description": "A broad `except Exception` clause in `_process_chunk` catches all errors, logs a warning, and returns an empty graph, potentially hiding bugs and making debugging difficult.",
      "file": "backend/src/cortex/intelligence/graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 148,
      "description": "Similarly, `_parse_json_to_graph` wraps the entire parsing logic in a generic `except Exception`, which swallows parsing errors and may result in partially constructed graphs without alerting callers.",
      "file": "backend/src/cortex/intelligence/graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 124,
      "description": "The raw `chunk_text` is interpolated directly into the LLM prompt (`GRAPH_EXTRACTION_PROMPT.format(input_text=chunk_text)`) without sanitization, opening the possibility of prompt injection or token\u2011budget overflow.",
      "file": "backend/src/cortex/intelligence/graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 71,
      "description": "The sliding\u2011window chunking strategy creates overlapping chunks, causing duplicated LLM calls for the same text portions and increasing latency and cost.",
      "file": "backend/src/cortex/intelligence/graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 70,
      "description": "`self.chunk_size = 8000` and `self.overlap = 500` are magic numbers; they should be defined as named constants or configurable parameters.",
      "file": "backend/src/cortex/intelligence/graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 115,
      "description": "`_normalize_relation` lacks a return type annotation, making static type checking incomplete.",
      "file": "backend/src/cortex/intelligence/graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 5,
      "description": "Importing `graph_*` modules at package import time can create circular import dependencies because those graph modules likely import symbols from this `__init__` (or from `nodes`/`states`). This may cause `ImportError` or partially initialized modules at runtime.",
      "file": "backend/src/cortex/orchestration/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 14,
      "description": "`extract_document_mentions` is imported from `cortex.orchestration.nodes`, but the provided excerpt of `nodes` does not show such a symbol. If it is not defined there, the import will fail, breaking package initialization.",
      "file": "backend/src/cortex/orchestration/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 84,
      "description": "Duplicate definition of function `_safe_stat_mb`; the second definition later in the file overwrites the first, causing dead code and potential maintenance issues.",
      "file": "backend/src/cortex/orchestration/nodes.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 31,
      "description": "The check `if pattern.pattern.startswith(\"[\\\"']\")` in `_extract_patterns` will never be true for the compiled patterns used, making the quoted\u2011reference guard unreachable.",
      "file": "backend/src/cortex/orchestration/nodes.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 122,
      "description": "Broad `except Exception: continue` in `_select_attachments_from_mentions` swallows all errors without logging, making debugging difficult.",
      "file": "backend/src/cortex/orchestration/nodes.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 162,
      "description": "Broad `except Exception: continue` in `_select_all_available_attachments` similarly hides unexpected failures.",
      "file": "backend/src/cortex/orchestration/nodes.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 226,
      "description": "`ThreadParticipant` is instantiated with `role=\"participant\"`, but its type is a Literal restricted to \"sender\", \"recipient\", or \"cc\"; this will raise a validation error.",
      "file": "backend/src/cortex/orchestration/nodes.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 244,
      "description": "`ThreadMessage` is constructed with fields (`from_addr`, `to_addrs`, `cc_addrs`, `subject`, `body_markdown`, `is_inbound`) that are not defined in the `ThreadMessage` Pydantic model, leading to a `ValidationError`.",
      "file": "backend/src/cortex/orchestration/nodes.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 191,
      "description": "Unnecessary casting to `int` for `limit` (`int(limit)`) when `limit` is already an integer; introduces needless complexity.",
      "file": "backend/src/cortex/orchestration/nodes.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 34,
      "description": "The function mutates the caller\u2011provided `conversation_ids` list by extending it in place when `thread_ids` are supplied, causing unexpected side\u2011effects for the caller.",
      "file": "backend/src/cortex/retrieval/vector_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 24,
      "description": "There is no validation that the dimensionality of the supplied `embedding` matches `output_dim` from the configuration; a mismatched vector length will cause runtime errors in the underlying vector store.",
      "file": "backend/src/cortex/retrieval/vector_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 58,
      "description": "The call to `store.search` passes a `thread_ids=None` argument; if the concrete `search` implementation does not define a `thread_ids` parameter (e.g., after merging into `conversation_ids`), this will raise a `TypeError`.",
      "file": "backend/src/cortex/retrieval/vector_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 56,
      "description": "Leftover developer comment `# P1 Fix: Add file_types filter` is a TODO marker that should be removed or turned into a proper issue tracker item.",
      "file": "backend/src/cortex/retrieval/vector_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 150,
      "description": "In `fuse_rrf`, the key for vector results is built as `item.chunk_id or item.message_id` without a fallback. If both are None, the key becomes `None`, causing collisions between distinct items and incorrect fusion scores.",
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 95,
      "description": "A broad `except Exception` block is used when performing the summary\u2011search step. Catching all exceptions can mask unexpected errors and makes debugging harder.",
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 84,
      "description": "The comment `# P1 Fix` is left in the source, indicating a temporary or unfinished fix and polluting the codebase.",
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 44,
      "description": "`apply_recency_boost` accesses `item.thread_id` without checking if the attribute is present or None; if a result lacks a thread identifier, the lookup will always be a miss but the function proceeds without warning.",
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 118,
      "description": "`_merge_result_fields` merges `highlights` assuming they are mutable lists. If a `SearchResultItem` provides an immutable sequence (e.g., a tuple), `into.highlights.append` will raise a `AttributeError`.",
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 9,
      "description": "Missing import of `List` from `typing`; the `results: List[SearchResultItem]` annotation will raise a NameError at module import time.",
      "file": "backend/src/cortex/retrieval/results.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 51,
      "description": "`thread_id` property is annotated to return `str` but actually returns `self.conversation_id`, which is typed as `Optional[str]`; the return type annotation is incorrect.",
      "file": "backend/src/cortex/retrieval/results.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 61,
      "description": "`from_fts_result` does not guard against `res` being `None`; calling `getattr` on a `None` value will raise an `AttributeError`.",
      "file": "backend/src/cortex/retrieval/results.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 66,
      "description": "TTL comparison uses time.time() which is susceptible to system clock changes; a monotonic clock should be used for reliable expiration.",
      "file": "backend/src/cortex/retrieval/cache.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 45,
      "description": "Cache keys are built by simple string concatenation with \"::\" separator; if the model name or query itself contains that substring, distinct inputs can map to the same key, causing accidental cache hits.",
      "file": "backend/src/cortex/retrieval/cache.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 93,
      "description": "Double\u2011checked locking in get_query_cache() is not fully thread\u2011safe; two threads may both see _query_cache as None and each create a new QueryEmbeddingCache before the lock serialises the assignment.",
      "file": "backend/src/cortex/retrieval/cache.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 84,
      "description": "stats() iterates over the entire cache to count valid (non\u2011expired) entries on each call, resulting in O(N) work even when only the total size is needed.",
      "file": "backend/src/cortex/retrieval/cache.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 61,
      "description": "A magic number (50) is used when truncating the query for debug logging (query[:50]); this should be expressed as a named constant or omitted.",
      "file": "backend/src/cortex/retrieval/cache.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 106,
      "description": "The global getter get_query_cache() lacks an explicit return type annotation, making the public API less clear.",
      "file": "backend/src/cortex/retrieval/cache.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 97,
      "description": "The field `due_date` in `NextAction` is typed as `Optional[str]` but likely represents a date/time; using a string can cause type mismatches and parsing errors elsewhere in the codebase.",
      "file": "backend/src/cortex/domain_models/rag.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 98,
      "description": "The function `classify_query_llm` references `PROMPT_QUERY_CLASSIFY`, which is not defined in the imported `cortex.prompts` module; this will raise a NameError at runtime.",
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 92,
      "description": "The docstring for `classify_query_llm` describes an `args` parameter, but the function signature takes a single `query: str` argument, causing a mismatch between documentation and implementation.",
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 124,
      "description": "`tool_classify_query` calls `args.query.strip()` without confirming that `args.query` is not `None`; if a `None` value is passed, an AttributeError will be raised.",
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 104,
      "description": "`classify_query_llm` catches a broad `Exception` and silently falls back to the fast classifier, potentially masking unexpected errors and making debugging harder.",
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 5,
      "description": "The module imports `strip_injection_patterns` from `cortex.security.injection_defense`, but the referenced module defines only the `InjectionDefense` class and does not provide a `strip_injection_patterns` function, leading to an ImportError at runtime.",
      "file": "backend/src/cortex/security/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 7,
      "description": "`__all__` lists `strip_injection_patterns`, which does not exist in this module, resulting in dead/incorrect export metadata.",
      "file": "backend/src/cortex/security/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 31,
      "description": "Regex patterns are compiled twice: once in the class __init__ (self.patterns) and again at module load time for _COMPILED_PATTERNS, causing unnecessary work and memory use.",
      "file": "backend/src/cortex/security/injection_defense.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 13,
      "description": "The blocklist includes very generic phrases (e.g., \"you are a helpful assistant\") that are likely to appear in benign content, leading to false\u2011positive injection detection.",
      "file": "backend/src/cortex/security/injection_defense.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 24,
      "description": "Pattern compilation with re.compile is performed without a try/except; if a pattern becomes invalid (e.g., during future modifications), a re.error would propagate and potentially crash the application.",
      "file": "backend/src/cortex/security/injection_defense.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 57,
      "description": "The method sanitize_prompt repeats the injection check (calls contains_injection) after it has already been performed by the caller in typical usage, resulting in duplicated work.",
      "file": "backend/src/cortex/security/injection_defense.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 48,
      "description": "The condition `if input_data and not input_hash:` treats empty but valid input data (e.g., empty dict, list, 0) as falsy and skips hash generation; should check for `input_data is not None` and `input_hash is None`.",
      "file": "backend/src/cortex/audit/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 56,
      "description": "The condition `if output_data and not output_hash:` has the same falsy\u2011value problem for empty output data; it should explicitly test for `output_data is not None` and `output_hash is None`.",
      "file": "backend/src/cortex/audit/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 48,
      "description": "The `participants` column is typed as `Optional[Dict[str, Any]]` but the comment/documentation indicates it stores a list of dictionaries (`[{name, smtp}, ...]`), causing a mismatch between the type hint and actual data shape.",
      "file": "backend/src/cortex/db/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 115,
      "description": "`embedding` column is declared without a `Mapped[...]` type annotation, breaking the expected typing convention for SQLAlchemy declarative models.",
      "file": "backend/src/cortex/db/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 210,
      "description": "In the `EntityNode.outgoing_edges` relationship, `foreign_keys` is provided as a string `\"[EntityEdge.source_id]\"` instead of a list of column objects; this will raise an error at runtime because SQLAlchemy expects actual column references.",
      "file": "backend/src/cortex/db/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 219,
      "description": "Similarly, the `EntityNode.incoming_edges` relationship uses a string for `foreign_keys` (`\"[EntityEdge.target_id]\"`) which is invalid and will prevent correct relationship resolution.",
      "file": "backend/src/cortex/db/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": null,
      "description": "Several string literals are used as default values for status-like fields (e.g., `status=\"pending\"` in `Attachment`) without being defined as constants, constituting magic strings that reduce maintainability.",
      "file": "backend/src/cortex/db/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 112,
      "description": "The after_cursor_execute listener assumes that conn.info[\"query_start_time\"] exists and contains an element; if the corresponding before_cursor_execute event was not fired or the list is empty, popping will raise an IndexError.",
      "file": "backend/src/cortex/db/session.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 111,
      "description": "The after_cursor_execute listener also assumes the key \"query_start_time\" is present in conn.info; if it is missing, a KeyError will be raised.",
      "file": "backend/src/cortex/db/session.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 106,
      "description": "The listeners import the time module using __import__(\"time\") on every call, causing unnecessary import overhead; a regular top\u2011level \"import time\" would be more efficient.",
      "file": "backend/src/cortex/db/session.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 119,
      "description": "The slow\u2011query threshold is a hard\u2011coded magic number (1.0 seconds); using a configurable value would avoid recompilation and allow tuning without code changes.",
      "file": "backend/src/cortex/db/session.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 84,
      "description": "Importing the \"re\" module inside set_session_tenant adds unnecessary local import overhead and deviates from the convention of placing imports at the module level.",
      "file": "backend/src/cortex/db/session.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 71,
      "description": "The generic \"except Exception as e\" block in get_db_session catches all exceptions, including KeyboardInterrupt and SystemExit, which are usually better allowed to propagate.",
      "file": "backend/src/cortex/db/session.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 31,
      "description": "The _RedactingExceptionFilter attempts to replace exception instances with a parameter\u2011less instance; for exception types that require arguments this fallback keeps the original exception object, potentially leaking sensitive information in logs.",
      "file": "backend/src/cortex/db/session.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 235,
      "description": "The definition of `dry_run` in `DigitalOceanScalerConfig` has an unterminated string literal and missing closing parenthesis, causing a syntax error and preventing the module from loading.",
      "file": "backend/src/cortex/config/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 127,
      "description": "`StorageConfig` stores `access_key` and `secret_key` directly from environment variables without any masking or validation, which could lead to accidental exposure of credentials if the object is logged or repr\u2011ed.",
      "file": "backend/src/cortex/config/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 107,
      "description": "`CoreConfig.env` allows both \"prod\" and \"production\" as literals, which can cause inconsistency and harder validation downstream.",
      "file": "backend/src/cortex/config/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 78,
      "description": "`DatabaseConfig.model_post_init` raises `ValueError` if `url` is falsy, but an empty string default is allowed by the field, potentially causing runtime failures that could be caught earlier with a stricter validator.",
      "file": "backend/src/cortex/config/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 166,
      "description": "`_env_list` splits the environment variable on commas and trims each part on every call; repeated calls could be optimized by caching the parsed list if used frequently.",
      "file": "backend/src/cortex/config/models.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 97,
      "description": "When an unknown `name` is passed, the function returns an empty string silently, which can mask configuration errors and lead to downstream logic receiving an unexpected empty prompt.",
      "file": "backend/src/cortex/prompts/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 100,
      "description": "`template.format(**kwargs)` is called without catching `KeyError` (or other formatting errors); missing placeholders in `kwargs` will raise an uncaught exception at runtime.",
      "file": "backend/src/cortex/prompts/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": null,
      "description": "Multiple lines exceed the PEP8 maximum line length (79 characters), reducing readability.",
      "file": "backend/src/cortex/prompts/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 84,
      "description": "Inconsistent naming conventions for keys in `prompt_map` (e.g., mixed lower\u2011case \"answer_question\" vs upper\u2011case \"DRAFT_EMAIL_INITIAL\"), which can cause confusion and errors when accessing prompts.",
      "file": "backend/src/cortex/prompts/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 92,
      "description": "`get_prompt` lacks an explicit return type annotation, making static type checking incomplete.",
      "file": "backend/src/cortex/prompts/__init__.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 265,
      "description": "The main `while token_pos < total_tokens:` loop never advances `token_pos` after a successful chunk is created, resulting in an infinite loop (or extremely slow processing). `token_pos` is only incremented in the empty\u2011chunk branch.",
      "file": "backend/src/cortex/chunking/chunker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 268,
      "description": "When a chunk is smaller than `min_tokens` and is merged with the previous chunk, `token_pos` is not updated to reflect the bytes that have been consumed, so the loop can become stuck.",
      "file": "backend/src/cortex/chunking/chunker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 250,
      "description": "The code checks `if len(chunk_tokens) > input_data.max_tokens:` inside the loop, but the slice was created using `eff_max_tokens` (which may be larger or smaller after progressive scaling). This mismatched comparison can lead to unexpected truncation or missed enforcement of the effective token limit.",
      "file": "backend/src/cortex/chunking/chunker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 285,
      "description": "`section_idx` is never incremented, so all generated `ChunkModel.position` fields will be identical, breaking ordering information.",
      "file": "backend/src/cortex/chunking/chunker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 311,
      "description": "`classify_chunk_type` returns `type_hint` directly without verifying it matches the declared `Literal` set; if a user passes an arbitrary string (or `None`), downstream code may receive an unexpected value.",
      "file": "backend/src/cortex/chunking/chunker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 225,
      "description": "`counter.decode(chunk_tokens)` can raise a `UnicodeDecodeError` when the fallback decoding path is used (bytes \u2192 UTF\u20118). The exception is not caught, potentially crashing the whole chunking process.",
      "file": "backend/src/cortex/chunking/chunker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 227,
      "description": "Encoding the entire text into a token list (`all_tokens = counter.encode(text)`) and then repeatedly calling `text.find(chunk_text_str, pos)` results in O(N\u00b2) time for large documents and high memory usage.",
      "file": "backend/src/cortex/chunking/chunker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 115,
      "description": "`find_sentence_boundary` scans a window of up to 200 characters for each boundary search using regular expressions, which can be expensive when called repeatedly for many chunks.",
      "file": "backend/src/cortex/chunking/chunker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 122,
      "description": "Magic numbers such as the default `window=100` in `find_sentence_boundary` and hard\u2011coded token\u2011to\u2011character ratio `4` in `TokenCounter.tokens_to_chars` are not given named constants or documentation.",
      "file": "backend/src/cortex/chunking/chunker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 210,
      "description": "The function `_apply_progressive_scaling` contains duplicated logic for determining the scaling factor; a lookup table or enumeration would improve readability.",
      "file": "backend/src/cortex/chunking/chunker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 150,
      "description": "`classify_chunk_type` is annotated to return a `Literal[...]`, but when `type_hint` is supplied it returns the raw `type_hint` value without a static type guarantee, potentially violating the return type contract.",
      "file": "backend/src/cortex/chunking/chunker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 25,
      "description": "Calling `args.to_tool_input()` without confirming that `args` implements that method can raise an AttributeError when a value of an unexpected type is passed.",
      "file": "backend/src/cortex/tools/search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 8,
      "description": "The import renames `KBSearchInput` from `cortex.retrieval.hybrid_search` to `HybridSearchInput` and then creates a second alias `RetrievalKBSearchInput`; this double aliasing is redundant and reduces code clarity.",
      "file": "backend/src/cortex/tools/search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 9,
      "description": "Using a multi\u2011line parentheses import block for a single name (`tool_kb_search_hybrid`) is unnecessarily verbose; a simple single\u2011line import would be clearer.",
      "file": "backend/src/cortex/tools/search.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 138,
      "description": "`__all__` is assigned a single string instead of an iterable of strings; this causes `from module import *` to export each character of the string rather than the intended function name.",
      "file": "backend/src/cortex/ingestion/conversation_parser.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 78,
      "description": "When constructing a pseudo\u2011email from an Exchange DN the CN component is inserted verbatim (`f\"{last_cn}@exchange.local\"`) without sanitising it; characters illegal in email local\u2011parts (spaces, commas, etc.) can produce malformed addresses.",
      "file": "backend/src/cortex/ingestion/conversation_parser.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 69,
      "description": "Name extraction removes every occurrence of the email substring from the raw address via `raw.replace(email, ...)`; if the email text also appears in the display name (e.g., \"john.doe@example.com (John)\") the name is truncated incorrectly.",
      "file": "backend/src/cortex/ingestion/conversation_parser.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 44,
      "description": "`_split_recipients` iterates character\u2011by\u2011character with a manual state machine; for long recipient strings this is less efficient than a well\u2011crafted regular expression or `csv`\u2011style parser.",
      "file": "backend/src/cortex/ingestion/conversation_parser.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 57,
      "description": "The `close` method catches a broad `Exception` and silently ignores it, potentially hiding resource\u2011cleanup errors.",
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 118,
      "description": "`conversation_exists` swallows all exceptions and treats any error as a missing conversation, which can mask permission or network problems.",
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 84,
      "description": "Path handling in `download_conversation_folder` attempts to prevent directory traversal but the logic (normpath + manual '..' check) is fragile and may still allow writes outside the intended folder.",
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 70,
      "description": "`list_conversation_folders` calls `_list_folder_files` for each discovered folder, causing an additional full pagination request per folder (N+1 requests) which can be expensive for many folders.",
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 140,
      "description": "`download_conversation_folder` creates a temporary directory with `tempfile.mkdtemp` but never cleans it up, risking accumulation of orphaned directories.",
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 41,
      "description": "The `client` property is typed as `Any`; a more precise type (e.g., `boto3.resources.base.ServiceResource` or a protocol) would improve static analysis.",
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 27,
      "description": "The comment for `files` uses a mutable default via `Field(default_factory=list)`, which is correct, but the surrounding docstring and inline comments are inconsistent in capitalization and punctuation.",
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 21,
      "description": "The first loop over `lines` contains only a `pass` statement; it performs no useful work and leaves dead code.",
      "file": "backend/src/cortex/ingestion/quoted_masks.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 23,
      "description": "Mutating `lines[i]` with `line.strip()` is unnecessary and potentially confusing since the mutated list is never used afterwards.",
      "file": "backend/src/cortex/ingestion/quoted_masks.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 25,
      "description": "The `is_quoted` boolean expression relies on operator precedence (`or` vs `and`) without explicit parentheses, which can lead to unintended truth\u2011value evaluation if the code were ever used.",
      "file": "backend/src/cortex/ingestion/quoted_masks.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 13,
      "description": "The function assumes `text` is a non\u2011null string; passing `None` would raise an `AttributeError` when calling `splitlines`.",
      "file": "backend/src/cortex/ingestion/quoted_masks.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 21,
      "description": "The initial loop over `lines` adds O(N) overhead while producing no output; it could be removed to improve efficiency.",
      "file": "backend/src/cortex/ingestion/quoted_masks.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 34,
      "description": "The function `prepare_for_indexing` only handles `text_type` values \"email\" and \"attachment\"; any other value silently bypasses type\u2011specific cleaning, which may lead to unexpected uncleaned content.",
      "file": "backend/src/cortex/ingestion/text_preprocessor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 78,
      "description": "`get_text_preprocessor` lazily creates a singleton without any synchronization; in a multithreaded environment two threads could both see `_preprocessor` as None and instantiate separate objects, breaking the singleton guarantee.",
      "file": "backend/src/cortex/ingestion/text_preprocessor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 62,
      "description": "`_redact_pii` assumes `config.pii` is always present and has an `enabled` attribute; if the configuration omits the `pii` section or sets it to `None`, an `AttributeError` will be raised.",
      "file": "backend/src/cortex/ingestion/text_preprocessor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 58,
      "description": "`_redact_pii` imports `get_config` inside the method on every call, causing repeated module import overhead; the import should be moved to module level or cached.",
      "file": "backend/src/cortex/ingestion/text_preprocessor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 33,
      "description": "When a filename appears multiple times in the CSV, the code overwrites the previous entry in `metadata_map` instead of preserving all occurrences as described in the docstring.",
      "file": "backend/src/cortex/ingestion/attachments_log.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 12,
      "description": "Docstring states the function returns a mapping of filename to a *list* of metadata dicts, but the implementation returns a single dict per filename, causing a mismatch between documentation and behavior.",
      "file": "backend/src/cortex/ingestion/attachments_log.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 9,
      "description": "The return type hint `Dict[str, Dict[str, Any]]` does not match the documented intent (which implies `Dict[str, List[Dict[str, Any]]]`). This inconsistency can confuse static type checkers.",
      "file": "backend/src/cortex/ingestion/attachments_log.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 45,
      "description": "A broad `except Exception` block catches all errors, logs a warning, and silently continues, potentially hiding serious parsing problems without notifying callers.",
      "file": "backend/src/cortex/ingestion/attachments_log.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 23,
      "description": "Function _derive_status accesses attributes aborted_reason, messages_failed, and attachments_failed on IngestJobSummary, but the IngestJobSummary model does not define these fields, causing AttributeError at runtime.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 48,
      "description": "In process_folder, the code assumes the supplied folder object may have a 'last_modified' attribute; however, the S3ConversationFolder model shown elsewhere only defines a 'prefix' field, so accessing folder.last_modified may raise AttributeError.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 70,
      "description": "Database query builds a filter using folder.name if present, otherwise extracts a name from the prefix; this logic may produce incorrect folder names when the prefix does not follow the expected pattern.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 97,
      "description": "When constructing the IngestJobRequest, the options dict is mutated with a 'source_last_modified' key without checking that options is indeed a mutable dict (though default_factory provides one, the type hint allows None).",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 104,
      "description": "Broad except Exception catches all errors during process_job, logs them, increments stats.errors, and returns None, which may hide programming bugs and makes debugging harder.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 126,
      "description": "In run_full_ingestion, the progress log uses len(folders) inside the loop; if folders is a generator rather than a list, len() will raise TypeError.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 146,
      "description": "In process_batch, the code sets many attributes on agg_stats (threads_created, chunks_created, embeddings_generated, errors, skipped) that are not defined in the IngestJobSummary model, leading to AttributeError or silent attribute creation depending on pydantic configuration.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 172,
      "description": "Inside the futures loop of process_batch, the exception handler accesses folder.prefix assuming folder is an object with that attribute; if the original folder is a plain string, this will raise AttributeError while handling another exception.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 178,
      "description": "process_batch catches generic Exception for each future, logs it, and increments agg_stats.errors, but does not distinguish between recoverable errors and serious failures.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 55,
      "description": "process_folder creates a new database session for every folder processed; this per\u2011folder session creation can be a performance bottleneck when processing many folders.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 89,
      "description": "The code logs the full folder prefix (potentially containing sensitive information) at INFO level, which could expose internal storage paths in logs.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 115,
      "description": "Two consecutive logger.info calls ('Starting ingestion scan for prefix \u2026' and 'Starting ingestion scan') are redundant and violate DRY principles.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 38,
      "description": "The method process_folder is annotated to return Optional[IngestJobSummary] but may also return None implicitly; however, callers (run_full_ingestion, process_batch) treat the result as always an IngestJobSummary, leading to possible type mismatches.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 161,
      "description": "process_batch receives job_id as a string and forcibly converts it to uuid.UUID without validation; type hinting expects a string but the method later treats it as a UUID, which can cause runtime errors if an invalid string is passed.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 58,
      "description": "When checking last_modified, the code uses 'if last_modified:' which will treat a falsy datetime (e.g., datetime.min) as missing; a more explicit None check would be safer.",
      "file": "backend/src/cortex/ingestion/processor.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 184,
      "description": "Function _add_pair references undefined function _normalize_name, causing a NameError at runtime when a participant without email is processed.",
      "file": "backend/src/cortex/ingestion/core_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 262,
      "description": "Deduplication loop in extract_participants_detailed also calls undefined _normalize_name, leading to another NameError during participant deduplication.",
      "file": "backend/src/cortex/ingestion/core_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 106,
      "description": "load_manifest catches a broad Exception and only logs a warning, potentially masking I/O or permission errors without proper remediation.",
      "file": "backend/src/cortex/ingestion/core_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 230,
      "description": "extract_participants_detailed uses a broad except (Exception) after handling specific errors, which can hide unexpected failures and makes debugging harder.",
      "file": "backend/src/cortex/ingestion/core_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 196,
      "description": "_extract_date_range wraps its entire logic in a bare except that silently ignores any exception, losing valuable error information.",
      "file": "backend/src/cortex/ingestion/core_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 11,
      "description": "The module docstring contains an accidental code line \"from typing import Any, Dict\" which should be removed to keep the docstring clean.",
      "file": "backend/src/cortex/ingestion/core_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 183,
      "description": "Variable names like 'f' for 'from' shadow a Python keyword and reduce readability; a more descriptive name should be used.",
      "file": "backend/src/cortex/ingestion/core_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 73,
      "description": "The class VLLMProvider contains two consecutive triple\u2011quoted strings; only the first becomes the class docstring, the second is a stray literal that serves no purpose.",
      "file": "backend/src/cortex/llm/runtime.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 55,
      "description": "BaseProvider.normalize_l2 assumes a 2\u2011D array (rows of vectors). If a 1\u2011D array is passed, np.linalg.norm with axis=1 will raise an AxisError.",
      "file": "backend/src/cortex/llm/runtime.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 131,
      "description": "In the llm_client property, the variable `intended_model` is derived from an environment variable but never used except for logging; this may be confusing and appears to be dead code.",
      "file": "backend/src/cortex/llm/runtime.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 159,
      "description": "Default API keys are set to the literal string \"EMPTY\" and passed to the OpenAI client; if the client does not reject this value, requests could be sent with an invalid credential, potentially leaking request data.",
      "file": "backend/src/cortex/llm/runtime.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 202,
      "description": "ResilienceManager.acquire_token uses a tight while\u2011True loop that reacquires the lock on every iteration; under high contention this could cause unnecessary CPU usage before the sleep path is taken.",
      "file": "backend/src/cortex/llm/runtime.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 114,
      "description": "When resolving `base_url` for the LLM client, the code may leave `base_url` as `None` if none of the configuration sources are present, leading to a potential TypeError when passing it to OpenAI().",
      "file": "backend/src/cortex/llm/runtime.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 118,
      "description": "The ImportError for the OpenAI dependency is re\u2011raised as ConfigurationError, but the original exception context is lost because it is not included as the cause.",
      "file": "backend/src/cortex/llm/runtime.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 23,
      "description": "Debug comment 'P2 Fix' left in production code; violates clean code style and may leak internal tracking information.",
      "file": "cli/src/cortex_cli/style.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 27,
      "description": "Debug comment 'P2 Fix' left in production code; violates clean code style.",
      "file": "cli/src/cortex_cli/style.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 78,
      "description": "The code checks `if not text or not text.strip():` but if `text` is `None` the call to `text.strip()` will raise an `AttributeError`; a explicit `None` guard is missing.",
      "file": "backend/src/cortex/llm/gguf_provider.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 96,
      "description": "The response handling assumes `data[0]['embedding']` is a non\u2011empty list and accesses the first element with `[0]`. If the embedding list is empty or the key is missing, an `IndexError` or `KeyError` will be raised and is not caught.",
      "file": "backend/src/cortex/llm/gguf_provider.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 108,
      "description": "When `texts` is empty the method returns a 2\u2011D array of shape `(0, dim)`, but when `embeddings` ends up empty (e.g., all texts are invalid) it returns a 1\u2011D empty array `np.array([], dtype=np.float32)`. This inconsistent shape can cause downstream dimension mismatches.",
      "file": "backend/src/cortex/llm/gguf_provider.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 72,
      "description": "Each text is sent in an individual HTTP request inside a loop, leading to N round\u2011trips to the llama\u2011server. This is inefficient for bulk embedding; a batched request would reduce latency.",
      "file": "backend/src/cortex/llm/gguf_provider.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 42,
      "description": "Magic number `3840` (expected embedding dimension) is hard\u2011coded; it should be defined as a named constant for clarity.",
      "file": "backend/src/cortex/llm/gguf_provider.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 43,
      "description": "Magic number `60` (request timeout) is hard\u2011coded; consider using a descriptively named constant.",
      "file": "backend/src/cortex/llm/gguf_provider.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 84,
      "description": "Magic number `512 * 4` used for `max_chars` is a magic value; define a constant with a clear name (e.g., `MAX_TOKENS` and `CHARS_PER_TOKEN`).",
      "file": "backend/src/cortex/llm/gguf_provider.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 55,
      "description": "A broad `except Exception:` is used to silence any error while loading configuration. This can hide real issues and makes debugging harder.",
      "file": "backend/src/cortex/llm/gguf_provider.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 55,
      "description": "The endpoint URL is taken directly from configuration or environment without validation of scheme, host, or path, potentially allowing Server\u2011Side Request Forgery (SSRF) if an attacker can control the environment variable.",
      "file": "backend/src/cortex/llm/gguf_provider.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 36,
      "description": "Function `_run_maintenance_resolve` is defined but never used, resulting in dead code.",
      "file": "cli/src/cortex_cli/cmd_maintenance.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 76,
      "description": "Multiple `return` statements appear after an unconditional `return` (lines 75\u201179), making the later returns unreachable dead code.",
      "file": "cli/src/cortex_cli/cmd_maintenance.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 76,
      "description": "Unreachable code after a `return` can lead to confusing control flow and may hide logical mistakes.",
      "file": "cli/src/cortex_cli/cmd_maintenance.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 41,
      "description": "Type hint uses a private class `argparse._SubParsersAction`; relying on private APIs is discouraged and may break with future Python versions.",
      "file": "cli/src/cortex_cli/cmd_maintenance.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 9,
      "description": "os.getenv may return None for OUTLOOKCORTEX_S3_ENDPOINT, OUTLOOKCORTEX_S3_ACCESS_KEY, or OUTLOOKCORTEX_S3_SECRET_KEY, leading to boto3 client initialization with missing required parameters.",
      "file": "scripts/move_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 10,
      "description": "Same as above \u2013 missing None checks for AWS credentials.",
      "file": "scripts/move_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 11,
      "description": "Same as above \u2013 missing None checks for AWS secret key.",
      "file": "scripts/move_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 25,
      "description": "Catches a broad Exception and only prints an error message, which can mask specific failures and prevents proper error propagation or cleanup.",
      "file": "scripts/move_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 15,
      "description": "Hard\u2011coded source key string is a magic constant; should be configurable or at least defined as a constant with a descriptive name.",
      "file": "scripts/move_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 16,
      "description": "Hard\u2011coded destination key string is a magic constant; should be configurable or defined as a constant.",
      "file": "scripts/move_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 6,
      "description": "Function `run` lacks type hints for its signature and local variables, reducing readability and static analysis support.",
      "file": "scripts/move_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 14,
      "description": "Bucket name is hard\u2011coded as a default; exposing internal bucket naming conventions could be considered information leakage.",
      "file": "scripts/move_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 27,
      "description": "The result of `extractor.extract_graph(TEST_TEXT)` is assumed to be a NetworkX graph, but there is no check for `None`. If the method returns `None`, subsequent calls to `G.number_of_nodes()` and `G.number_of_edges()` will raise an `AttributeError`.",
      "file": "scripts/test_graph_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 27,
      "description": "The extraction call is not wrapped in any try/except block. Any exception raised by `GraphExtractor` (e.g., configuration errors, runtime failures) will cause the script to terminate abruptly without providing a clear error message or cleanup.",
      "file": "scripts/test_graph_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 4,
      "description": "The script loads environment variables from a hard\u2011coded \".env\" file using `load_dotenv(\".env\")`. If the repository is shared publicly, the presence of this file could unintentionally expose secrets, and the hard\u2011coded path may lead to accidental loading of sensitive data in unintended environments.",
      "file": "scripts/test_graph_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 30,
      "description": "The test function uses `print` statements and manual condition checks instead of a proper testing framework (e.g., `unittest` or `pytest`) and assertions, making automated test discovery and reporting difficult.",
      "file": "scripts/test_graph_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 31,
      "description": "`test_extraction` has no type hints for its parameters or return type, and the variable `G` is used without an explicit type annotation, which can hinder static type checking.",
      "file": "scripts/test_graph_extraction.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 34,
      "description": "`result.rowcount` may be `None` for a DELETE statement; assigning it to `count` and later adding to `total_deleted_convs` can raise a TypeError.",
      "file": "scripts/run_db_cleanup.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 71,
      "description": "`result.rowcount` is compared to `0` without checking for `None`; if the driver returns `None` the comparison will raise a TypeError.",
      "file": "scripts/run_db_cleanup.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 22,
      "description": "The async DB operations are performed without any try/except or finally block, so unexpected exceptions could abort the script leaving the engine undisposed or the transaction uncommitted.",
      "file": "scripts/run_db_cleanup.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 9,
      "description": "Appending a hard\u2011coded relative path (`backend/src`) to `sys.path` can unintentionally shadow standard modules and expose the process to malicious code if the directory is compromised.",
      "file": "scripts/run_db_cleanup.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 56,
      "description": "Fetching all orphan node IDs into a Python list (`orphan_ids = result.scalars().all()`) may load a large number of rows into memory; a bulk DELETE using a sub\u2011query would be more efficient.",
      "file": "scripts/run_db_cleanup.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 11,
      "description": "Directly using `print` for status messages instead of the `logging` module makes the script harder to configure and inconsistent with the rest of the codebase.",
      "file": "scripts/run_db_cleanup.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 31,
      "description": "The `keyword_filters` list contains hard\u2011coded magic strings; extracting them to a constant or configuration would improve readability and maintainability.",
      "file": "scripts/run_db_cleanup.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 20,
      "description": "`cleanup_db` is defined without type hints for its return value or for local variables, which reduces static type checking usefulness.",
      "file": "scripts/run_db_cleanup.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 10,
      "description": "Environment variables for access key, secret key, and bucket are read without checking for None; if any are missing the boto3 client and pagination will receive None and raise runtime errors.",
      "file": "scripts/count_s3.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 15,
      "description": "AWS client creation and pagination are performed without any try/except block, so network or credential errors will cause the script to crash without a clear message or cleanup.",
      "file": "scripts/count_s3.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 31,
      "description": "The constant PROGRESS_PAGE_INTERVAL is redefined inside every loop iteration, adding unnecessary overhead; it should be defined once outside the loop.",
      "file": "scripts/count_s3.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 31,
      "description": "Magic number 5 is embedded directly in the loop; defining a named constant at module level would improve readability.",
      "file": "scripts/count_s3.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 24,
      "description": "Variable name `count` shadows the function name `count`, which can be confusing and may hinder static analysis.",
      "file": "scripts/count_s3.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 40,
      "description": "Hard\u2011coded S3 prefix string is a magic constant; should be externalised or documented.",
      "file": "scripts/list_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 43,
      "description": "Hard\u2011coded S3 bucket name is a magic constant; should be configurable.",
      "file": "scripts/list_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 38,
      "description": "Hard\u2011coded AWS region \"tor1\" is a magic value; consider making it configurable.",
      "file": "scripts/list_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 6,
      "description": "Function `run` lacks type hints for parameters (none) and return type; public API should be annotated.",
      "file": "scripts/list_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 35,
      "description": "Repeated calls to `os.getenv` for the same environment variables (endpoint, access key, secret key) instead of reusing the already\u2011fetched values.",
      "file": "scripts/list_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 33,
      "description": "No exception handling around `boto3.client` creation; network or credential errors will cause the script to crash without a clear message.",
      "file": "scripts/list_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 42,
      "description": "Paginator iteration is not wrapped in try/except; AWS service errors (e.g., throttling, permission denied) will propagate uncaught.",
      "file": "scripts/list_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 35,
      "description": "`endpoint_url` is taken directly from an environment variable without validation, which could allow an attacker to inject a malicious endpoint (potential SSRF).",
      "file": "scripts/list_blocker.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 28,
      "description": "Catches a broad ``Exception`` which can mask unexpected errors and makes it harder to differentiate between recoverable (e.g., ``TimeoutExpired``) and critical failures.",
      "file": "scripts/apply_patches.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 18,
      "description": "Executes an external ``patch`` command with a file path taken directly from the filesystem without validation; maliciously crafted patch files could exploit the command or affect unintended files.",
      "file": "scripts/apply_patches.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 22,
      "description": "Magic number ``30`` used for the subprocess timeout; should be defined as a named constant for readability and configurability.",
      "file": "scripts/apply_patches.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 33,
      "description": "Only checks ``PATCHES_DIR.exists()`` but does not verify that the path is a directory; if a regular file with that name exists, ``glob`` will raise an error.",
      "file": "scripts/apply_patches.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 36,
      "description": "Catches a broad `Exception`, which may hide unexpected errors (including system\u2011level ones) and prevents proper propagation; also uses `exit(1)` inside the function, bypassing normal cleanup.",
      "file": "scripts/reset_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 34,
      "description": "Database cursor and connection are only closed on the successful path; if an exception occurs before `cur.close()` / `conn.close()`, resources remain open, leading to potential leaks.",
      "file": "scripts/reset_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 24,
      "description": "Hard\u2011coded role name `doadmin` (and schema name `public` elsewhere) are magic strings; they should be defined as constants or configurable parameters.",
      "file": "scripts/reset_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 14,
      "description": "Uses `print` statements for operational output instead of a proper logging framework, which limits configurability and log level control.",
      "file": "scripts/reset_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 24,
      "description": "Executes raw SQL commands without parameterization; while the statements contain no user input, using parameterized queries is a safer pattern and guards against future modifications that might introduce injection vectors.",
      "file": "scripts/reset_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 30,
      "description": "The test decorator's wrapper catches only Exception; SystemExit (and KeyboardInterrupt) are subclasses of BaseException and will escape, potentially aborting the entire benchmark run.",
      "file": "scripts/verify_reorganized_cli.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 30,
      "description": "Using a broad `except Exception as e` hides specific error types and can mask programming errors; more granular exception handling is advisable.",
      "file": "scripts/verify_reorganized_cli.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 9,
      "description": "The script mutates `sys.path` with relative directories (`backend/src`, `cli/src`), which can introduce unintended import precedence and enable execution of malicious code placed in those paths.",
      "file": "scripts/verify_reorganized_cli.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 151,
      "description": "Accesses to nested config attributes (e.g., `config.database.url`) assume `config.database` is always present; if the section is missing, an AttributeError will be raised.",
      "file": "scripts/verify_reorganized_cli.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 144,
      "description": "`test_config_s3_alias` compares `config.s3 == config.storage` without confirming that either attribute is not `None`, which could cause an AttributeError if the alias is not defined.",
      "file": "scripts/verify_reorganized_cli.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 13,
      "description": "Long import block and many lines exceed the 79\u2011character PEP8 limit, reducing readability.",
      "file": "scripts/verify_reorganized_cli.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 63,
      "description": "Magic numbers (e.g., `limit=5`, `batch_size=64`) are used directly in test arguments without explanation or named constants.",
      "file": "scripts/verify_reorganized_cli.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 21,
      "description": "The `test` decorator and all test functions lack type annotations, which makes static type checking harder for public APIs.",
      "file": "scripts/verify_reorganized_cli.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 7,
      "description": "Hardcoded admin password (PWD) is embedded in source code, exposing credentials.",
      "file": "scripts/setup_sonar_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 6,
      "description": "Hardcoded SonarQube server URL; should be configurable via environment or arguments.",
      "file": "scripts/setup_sonar_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 25,
      "description": "Hardcoded absolute path to the .env file; may expose filesystem layout and is not portable.",
      "file": "scripts/setup_sonar_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 6,
      "description": "Magic string literals used for configuration values; better to load from environment variables or a config file.",
      "file": "scripts/setup_sonar_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 25,
      "description": "Magic absolute file path; using a relative path or configurable location improves maintainability.",
      "file": "scripts/setup_sonar_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 26,
      "description": "Appending the token to the .env file on every execution can create duplicate entries, leading to credential clutter and potential confusion.",
      "file": "scripts/setup_sonar_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 33,
      "description": "Using the built\u2011in exit() function inside a script; sys.exit() is more appropriate for non\u2011interactive use.",
      "file": "scripts/setup_sonar_auth.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 31,
      "description": "Calls os.path.getsize on the downloaded file without catching potential OSError (e.g., if the file is missing or inaccessible), which could cause the script to crash.",
      "file": "scripts/download_gguf.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 36,
      "description": "Creates a symbolic link with Path.symlink_to without handling possible OSError (e.g., insufficient permissions, unsupported platform), leading to an unhandled exception.",
      "file": "scripts/download_gguf.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 22,
      "description": "Invokes hf_hub_download without any try/except block, so network failures, authentication errors, or repository issues will raise uncaught exceptions and abort the script.",
      "file": "scripts/download_gguf.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": null,
      "description": "The script executes its logic at module import time; it lacks an \"if __name__ == '__main__':\" guard, which is a common best\u2011practice to prevent side effects when imported.",
      "file": "scripts/download_gguf.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 21,
      "description": "Magic numbers are embedded in the user\u2011facing message (\"~7GB\", \"5-15 minutes\"); these values should be defined as named constants or derived from actual file metadata for clarity and maintainability.",
      "file": "scripts/download_gguf.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 58,
      "description": "Broad `except Exception:` in `call_llm_fix` silently swallows all errors and returns an empty string, making debugging impossible.",
      "file": "scripts/apply_per_issue_patches.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 131,
      "description": "Broad `except Exception:` in `group_patches_by_file` discards any errors while reading patch files, potentially hiding I/O or parsing problems.",
      "file": "scripts/apply_per_issue_patches.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 108,
      "description": "Unvalidated `file_path` extracted from a patch is concatenated with `PROJECT_ROOT` using `Path / file_path`; if the patch contains an absolute path or path traversal (`../`), the script could read or modify files outside the intended project directory.",
      "file": "scripts/apply_per_issue_patches.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 27,
      "description": "`API_KEY` may be `None` if environment variables are missing, but it is still interpolated into the `Authorization` header as `Bearer None`, leading to malformed requests.",
      "file": "scripts/apply_per_issue_patches.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 161,
      "description": "When `dry_run` mode is enabled, the code sets `result[\"applied\"] = True` after a successful dry\u2011run, which conflates \u201capplied\u201d with \u201cvalidated\u201d. This inflates the applied\u2011patch count in the final report.",
      "file": "scripts/apply_per_issue_patches.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 10,
      "description": "Unconditionally importing `HalfVector` after a failed attribute lookup can raise an ImportError at runtime, making the script crash despite the earlier exception handling.",
      "file": "scripts/legacy/inspect_pgvector.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 10,
      "description": "The import of `HalfVector` is not wrapped in a try/except block, so any ImportError is not caught, contradicting the earlier attempt to handle missing `HalfVector`.",
      "file": "scripts/legacy/inspect_pgvector.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 10,
      "description": "Import statement is placed after executable code (violates PEP8 E402) even though it is suppressed with `# noqa`; this reduces readability and may cause circular import issues.",
      "file": "scripts/legacy/inspect_pgvector.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 3,
      "description": "Top\u2011level `print` statements execute on import, which is generally discouraged outside of a `if __name__ == \"__main__\":` guard in scripts.",
      "file": "scripts/legacy/inspect_pgvector.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 4,
      "description": "Directly accessing module attributes without guarding against `AttributeError` (aside from the try block) can produce uncaught errors if `Vector` is missing.",
      "file": "scripts/legacy/inspect_pgvector.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 12,
      "description": "Printing documentation of `HalfVector` at import time may expose internal details unintentionally; such output should be confined to a main guard.",
      "file": "scripts/legacy/inspect_pgvector.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 9,
      "description": "Catches a broad Exception, which can mask unexpected errors and suppress important traceback information.",
      "file": "scripts/check/check_tools_script.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 7,
      "description": "Uses subprocess.run with shell=True, which can lead to command injection if the cmd argument ever originates from untrusted input.",
      "file": "scripts/check/check_tools_script.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 5,
      "description": "Function lacks a docstring and type hints for its parameter and return value, reducing readability and static analysis support.",
      "file": "scripts/check/check_tools_script.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 13,
      "description": "Hard\u2011coded output file name ('tool_check_output.txt') is a magic string; should be configurable or defined as a constant.",
      "file": "scripts/check/check_tools_script.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 23,
      "description": "The result of `get_config()` is assumed to be non\u2011None and to have a `database.url` attribute; if `get_config()` returns None or a malformed object, an AttributeError will be raised.",
      "file": "scripts/legacy/inspect_json.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 25,
      "description": "The check `if \"sslmode\" not in db_url:` looks for a substring, which can produce false negatives/positives if the string \"sslmode\" appears in a password or other parameter.",
      "file": "scripts/legacy/inspect_json.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 33,
      "description": "SQL query is constructed with an f\u2011string that interpolates `EMPTY_JSON_OBJECT` directly into the statement, which could lead to SQL injection if the variable were ever sourced from user input.",
      "file": "scripts/legacy/inspect_json.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 31,
      "description": "`EMPTY_JSON_OBJECT` is named in ALL_CAPS (constant style) but is defined inside a function and is not a true module\u2011level constant.",
      "file": "scripts/legacy/inspect_json.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 37,
      "description": "Magic number `5` is hard\u2011coded in the SQL LIMIT clause; it would be clearer to define a named constant.",
      "file": "scripts/legacy/inspect_json.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 57,
      "description": "Magic number `5` is also hard\u2011coded in the second SQL LIMIT clause.",
      "file": "scripts/legacy/inspect_json.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 67,
      "description": "A broad `except Exception` clause catches all exceptions and merely prints the error, potentially swallowing important tracebacks and hindering proper error handling.",
      "file": "scripts/legacy/inspect_json.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 12,
      "description": "The result of get_config() is used without verifying that 'config' or 'config.storage' is not None; accessing attributes may raise AttributeError if configuration loading fails.",
      "file": "scripts/check/check_s3.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 36,
      "description": "A bare 'except Exception' clause catches all exceptions, potentially hiding unexpected errors and preventing the script from exiting with a non\u2011zero status code.",
      "file": "scripts/check/check_s3.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 6,
      "description": "Manipulating sys.path at runtime can introduce arbitrary code execution risks if an attacker can influence the resolved path.",
      "file": "scripts/check/check_s3.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 14,
      "description": "Printing the endpoint URL (and other configuration details) may leak sensitive infrastructure information when the script is run in insecure environments.",
      "file": "scripts/check/check_s3.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 6,
      "description": "Modifying sys.path for import side\u2011effects is considered poor style; a proper package structure or relative imports should be used instead.",
      "file": "scripts/check/check_s3.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": null,
      "description": "The script uses print statements for logging; using the standard logging module would be more appropriate and configurable.",
      "file": "scripts/check/check_s3.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 11,
      "description": "The public function 'check_s3' lacks type hints for its parameters and return type, reducing static analysis clarity.",
      "file": "scripts/check/check_s3.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 12,
      "description": "`if not manifests:` has an empty body, which is a syntax error and prevents proper handling of the case where no manifest files are found.",
      "file": "scripts/legacy/inspect_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 14,
      "description": "`target = manifests[0]` assumes the list is non\u2011empty; if `manifests` is empty this will raise an IndexError.",
      "file": "scripts/legacy/inspect_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 30,
      "description": "Catches a broad `Exception` and only prints the error, which can mask unexpected failures and makes debugging harder.",
      "file": "scripts/legacy/inspect_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 12,
      "description": "Missing `pass` or appropriate handling after the `if not manifests:` statement; leads to a dangling colon and violates PEP8 style.",
      "file": "scripts/legacy/inspect_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 11,
      "description": "Accesses `config.database` and `config.database.url` without checking if `config` or `config.database` could be `None`, which may raise an AttributeError.",
      "file": "scripts/check/check_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 27,
      "description": "Catches a broad `Exception`, potentially swallowing unrelated errors (including `KeyboardInterrupt`), and does not preserve the original traceback.",
      "file": "scripts/check/check_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 4,
      "description": "Manipulates `sys.path` with a hard\u2011coded relative path (`backend/src`) at runtime, which is considered poor practice and can lead to import side\u2011effects.",
      "file": "scripts/check/check_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 13,
      "description": "Uses `print` statements for logging instead of the standard `logging` module, reducing configurability and consistency with the rest of the codebase.",
      "file": "scripts/check/check_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 9,
      "description": "`check_db` is defined without type hints for its parameters or return type, making static analysis and documentation harder.",
      "file": "scripts/check/check_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 16,
      "description": "Passes `db_url` directly to `create_engine`; if the URL contains credentials, they may be logged by SQLAlchemy internals, exposing sensitive information.",
      "file": "scripts/check/check_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 22,
      "description": "Environment variables ENDPOINT, REGION, and BUCKET are used later without checking for None, which could cause boto3 client initialization to fail if they are missing.",
      "file": "scripts/check/check_s3_structure_v2.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 38,
      "description": "A broad `except Exception` clause catches all exceptions, potentially swallowing important errors and making debugging harder.",
      "file": "scripts/check/check_s3_structure_v2.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 30,
      "description": "Calls to `exit()` are used instead of `sys.exit()`, which is less explicit and can be problematic in some execution contexts.",
      "file": "scripts/check/check_s3_structure_v2.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 45,
      "description": "Magic number `100` is hard\u2011coded when limiting the folder scan; it should be defined as a named constant for clarity.",
      "file": "scripts/check/check_s3_structure_v2.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 18,
      "description": "Magic number `20` for SAMPLE size is hard\u2011coded; consider defining a descriptive constant.",
      "file": "scripts/check/check_s3_structure_v2.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 14,
      "description": "Assumes `config.s3` is always present; if the S3 configuration is missing or None, accessing `endpoint_url` will raise an AttributeError.",
      "file": "scripts/utils/temp_check_do_spaces.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 15,
      "description": "Same assumption for `config.s3.region`; lack of a None check could cause runtime errors when the configuration is incomplete.",
      "file": "scripts/utils/temp_check_do_spaces.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 16,
      "description": "Assumes `config.s3.bucket_raw` exists; without validation, a missing bucket attribute leads to an AttributeError.",
      "file": "scripts/utils/temp_check_do_spaces.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 31,
      "description": "`handler.stream_conversation_data(sample)` is expected to return a mapping, but the code does not verify the result is not None before calling `.get`, which could raise an AttributeError if the call fails or returns None.",
      "file": "scripts/utils/temp_check_do_spaces.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 31,
      "description": "Network or service errors inside `list_conversation_folders` or `stream_conversation_data` are not caught; the script will abort with an unhandled exception on any failure.",
      "file": "scripts/utils/temp_check_do_spaces.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 14,
      "description": "Printing the endpoint URL and bucket name may expose internal infrastructure details in logs or consoles; consider limiting exposure of configuration data.",
      "file": "scripts/utils/temp_check_do_spaces.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 19,
      "description": "Applies both a `limit=10` argument to `list_conversation_folders` and an `islice(..., 10)`; the redundant slicing adds unnecessary overhead.",
      "file": "scripts/utils/temp_check_do_spaces.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 19,
      "description": "Magic number `10` is repeated for limiting folder enumeration; should be defined as a named constant for readability.",
      "file": "scripts/utils/temp_check_do_spaces.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 38,
      "description": "Uses multiple `print` statements for logging; adopting the `logging` module would provide better control over log levels and output destinations.",
      "file": "scripts/utils/temp_check_do_spaces.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 31,
      "description": "The return type of `handler.stream_conversation_data` is not annotated; downstream code assumes a dict, which may lead to type mismatches if the actual return type changes.",
      "file": "scripts/utils/temp_check_do_spaces.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 44,
      "description": "The import\u2011injection logic only adds `from pathlib import Path` when the target file contains either `import os` or `import sys`. If a file matches the regex but has neither of those imports, the required import is never added, resulting in a NameError for `Path` after the replacement.",
      "file": "scripts/utils/fix_paths.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 19,
      "description": "File I/O operations (`path.read_text` and `path.write_text`) are performed without any try/except blocks, so any filesystem errors (permission issues, missing files, etc.) will cause the whole script to crash.",
      "file": "scripts/utils/fix_paths.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 39,
      "description": "The regular\u2011expression pattern string spans more than the recommended 79 characters, violating PEP\u202f8 line\u2011length guidelines.",
      "file": "scripts/utils/fix_paths.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 31,
      "description": "The replacement string contains a magic number (`parents[2]`) that encodes an assumed directory depth without explanation, making the code harder to maintain.",
      "file": "scripts/utils/fix_paths.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 35,
      "description": "Direct use of `print` for status output is not ideal for library\u2011style scripts; a logging framework would be more appropriate.",
      "file": "scripts/utils/fix_paths.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 15,
      "description": "Accesses config.storage attributes (endpoint_url, region, access_key, secret_key) without verifying that config.storage is not None, which could raise an AttributeError if the storage configuration is missing.",
      "file": "scripts/utils/debug_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 26,
      "description": "Uses response[\"Body\"] assuming the key exists; if the S3 response is malformed, this will raise a KeyError.",
      "file": "scripts/utils/debug_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 24,
      "description": "Catches a broad Exception for the entire S3 fetch block, which can mask unexpected errors and makes debugging harder.",
      "file": "scripts/utils/debug_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 29,
      "description": "Catches a broad Exception while decoding and parsing JSON, swallowing all parsing errors without distinguishing between decode failures and JSON syntax errors.",
      "file": "scripts/utils/debug_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 8,
      "description": "Modifies sys.path at runtime with a hard\u2011coded relative path, which can unintentionally import untrusted modules if the directory contents are compromised.",
      "file": "scripts/utils/debug_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 15,
      "description": "Passes AWS secret_key directly from configuration to boto3 client; if the configuration contains plaintext credentials, they may be exposed in logs or memory.",
      "file": "scripts/utils/debug_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 26,
      "description": "Reads the entire S3 object into memory with response[\"Body\"].read(), which can be inefficient or cause memory pressure for large manifest files.",
      "file": "scripts/utils/debug_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 22,
      "description": "Hard\u2011coded S3 object key contains spaces and special characters; such literals should be externalised or constructed dynamically to improve maintainability.",
      "file": "scripts/utils/debug_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 34,
      "description": "Applies ad\u2011hoc string replacements to \"fix\" malformed JSON (replacing ':\"\"\"' etc.); this is brittle and should be replaced with proper validation or preprocessing logic.",
      "file": "scripts/utils/debug_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": null,
      "description": "Script lacks an if __name__ == '__main__': guard, making imports execute side\u2011effects (e.g., S3 calls) unintentionally.",
      "file": "scripts/utils/debug_manifest.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 19,
      "description": "Environment variables (S3_ENDPOINT, S3_REGION, S3_ACCESS_KEY, S3_SECRET_KEY) are accessed without checking for None; passing None to boto3.client may cause runtime errors.",
      "file": "scripts/utils/sample_validate.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 45,
      "description": "Object keys from S3 are directly concatenated to a local path (dest / rel) without sanitisation; a malicious key containing '../' could lead to path traversal and write outside the intended temporary directory.",
      "file": "scripts/utils/sample_validate.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 48,
      "description": "A bare \"except Exception as e\" catches all exceptions during file download and only prints the error, potentially swallowing critical failures and making debugging harder.",
      "file": "scripts/utils/sample_validate.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 73,
      "description": "The code accesses report.manifests_updated and report.problems, but ManifestValidationReport (defined earlier) does not declare those fields; this will raise an AttributeError at runtime if the returned object does not include them.",
      "file": "scripts/utils/sample_validate.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 31,
      "description": "Use of print statements for logging instead of the configured logger; this mixes output channels and makes it harder to control verbosity.",
      "file": "scripts/utils/sample_validate.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 27,
      "description": "Magic number \"10\" is used multiple times to limit the number of folders; it should be defined as a named constant for readability and maintainability.",
      "file": "scripts/utils/sample_validate.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 41,
      "description": "The inner function download_folder lacks type annotations for its parameter and return value, reducing type\u2011checking clarity.",
      "file": "scripts/utils/sample_validate.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 47,
      "description": "The script prints the length of the secret key, which can aid an attacker in enumerating or validating credentials.",
      "file": "scripts/utils/list_space_files_simple.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 75,
      "description": "A bare `except Exception` catches all exceptions, including KeyboardInterrupt and SystemExit, potentially hiding important errors and preventing proper termination.",
      "file": "scripts/utils/list_space_files_simple.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 66,
      "description": "After reaching the requested `--limit`, the code continues to iterate over all remaining objects and pages, causing unnecessary API calls and processing.",
      "file": "scripts/utils/list_space_files_simple.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 34,
      "description": "Magic number `200` is used as the default limit; extracting it to a named constant would improve readability and maintainability.",
      "file": "scripts/utils/list_space_files_simple.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 6,
      "description": "Function `check_nodes` is annotated to return `None` but actually returns boolean values.",
      "file": "scripts/ops/wait_for_node.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 19,
      "description": "`return True` returns a bool despite the declared `None` return type.",
      "file": "scripts/ops/wait_for_node.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 34,
      "description": "`return False` returns a bool despite the declared `None` return type.",
      "file": "scripts/ops/wait_for_node.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 9,
      "description": "Magic number `600` (timeout seconds) is used directly; should be a named constant.",
      "file": "scripts/ops/wait_for_node.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 33,
      "description": "Magic number `10` (sleep interval) is used directly; should be a named constant.",
      "file": "scripts/ops/wait_for_node.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 6,
      "description": "Missing docstring for `check_nodes` function.",
      "file": "scripts/ops/wait_for_node.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 5,
      "description": "Magic number used for sleep interval (10 seconds) without a named constant; makes the value less discoverable and harder to adjust.",
      "file": "scripts/ops/wait_for_pod.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 1,
      "description": "File lacks a module docstring describing its purpose and usage.",
      "file": "scripts/ops/wait_for_pod.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 31,
      "description": "Direct use of `print` for logging; consider using the `logging` module for configurable log levels and better testability.",
      "file": "scripts/ops/wait_for_pod.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 23,
      "description": "Hard\u2011coded namespace string \"emailops\" could be extracted to a constant or made configurable.",
      "file": "scripts/ops/wait_for_pod.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 38,
      "description": "Assumes the `text` column (`row[1]`) is always non\u2011null; calling `len(txt)` will raise a TypeError if the value is `None`.",
      "file": "scripts/ops/fix_nulls.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 43,
      "description": "Assumes the OpenAI response contains at least one embedding (`resp.data[0]`) without checking the list length, which can raise an IndexError on empty responses.",
      "file": "scripts/ops/fix_nulls.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 57,
      "description": "Catches a broad `Exception` and only prints the error, effectively swallowing failures and making debugging harder.",
      "file": "scripts/ops/fix_nulls.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 18,
      "description": "Hard\u2011codes an API key (`api_key=\"dummy\"`) directly in the source; embedding secrets (even placeholders) in code is a security risk.",
      "file": "scripts/ops/fix_nulls.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 46,
      "description": "Executes a separate `UPDATE` statement and `commit` for each chunk inside the loop, resulting in N+1 database writes; batching updates would be more efficient.",
      "file": "scripts/ops/fix_nulls.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 55,
      "description": "Calls `conn.commit()` on a SQLAlchemy `Connection` object without an explicit transaction; this may raise an error or have no effect depending on the engine configuration.",
      "file": "scripts/ops/fix_nulls.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 11,
      "description": "Imports and `sys.path.insert` occur after module\u2011level constants; PEP8 recommends all imports be placed at the top of the file.",
      "file": "scripts/ops/fix_nulls.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 49,
      "description": "Magic number `3840` is embedded in the SQL cast (`halfvec(3840)`) without a named constant or comment explaining its significance.",
      "file": "scripts/ops/fix_nulls.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 4,
      "description": "The `run` helper uses `subprocess.run` with `shell=True` and a plain string, allowing command injection if any part of the command string is derived from untrusted input.",
      "file": "scripts/ops/merge_all.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 31,
      "description": "The merge\u2011base check interpolates `pr` directly into a shell command (`git merge-base --is-ancestor {pr} main`) without any sanitisation, creating an injection vector for malicious branch names.",
      "file": "scripts/ops/merge_all.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 38,
      "description": "The actual merge command (`git merge --no-edit {pr}`) also interpolates the branch name into a shell string, exposing the script to command injection.",
      "file": "scripts/ops/merge_all.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 4,
      "description": "The `run` function lacks type hints for its parameter and return value, reducing static analysis usefulness.",
      "file": "scripts/ops/merge_all.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 10,
      "description": "`main` has no return type annotation and the public API (the script entry point) is not typed.",
      "file": "scripts/ops/merge_all.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": null,
      "description": "The module contains no module\u2011level docstring describing its purpose, which is a PEP 257 style violation.",
      "file": "scripts/ops/merge_all.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 15,
      "description": "The except block catches ImportError and AttributeError, logs the error, and then continues execution without re\u2011raising or handling the failure, which can hide import problems and leave the script in an inconsistent state.",
      "file": "scripts/verification/check_model_load.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 5,
      "description": "The script manipulates `sys.path` by inserting a directory derived from a relative path (`parents[2] / \"backend\" / \"src\"`) without validation, which could unintentionally expose the process to import of untrusted modules if the directory contents are compromised.",
      "file": "scripts/verification/check_model_load.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 5,
      "description": "The use of the magic index `parents[2]` to locate the backend source directory is a hidden constant; extracting this into a named constant or adding a comment would improve readability and maintainability.",
      "file": "scripts/verification/check_model_load.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "The script lacks type annotations for any public\u2011facing functions or variables, which reduces static type checking usefulness in larger codebases.",
      "file": "scripts/verification/check_model_load.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 32,
      "description": "The fallback in `core = parts[1] if len(parts) > 1 else parts[0]` is unreachable because the earlier validation (`len(parts) < 2`) guarantees `len(parts) >= 2`. This redundant logic may mask future changes or misunderstandings.",
      "file": "scripts/ops/provision_retry.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 58,
      "description": "Only `subprocess.CalledProcessError` is caught. Other possible exceptions such as `FileNotFoundError` (if `doctl` is missing) or generic `OSError` will propagate and crash the script, leaving no cleanup or user\u2011friendly message.",
      "file": "scripts/ops/provision_retry.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 18,
      "description": "The cluster UUID is hard\u2011coded in the source. If this identifier is sensitive, it should be obtained from a secure source (environment variable, config file, secret manager) rather than being plain\u2011text in code.",
      "file": "scripts/ops/provision_retry.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 69,
      "description": "The retry back\u2011off delay (`time.sleep(2)`) is a magic number. It should be defined as a named constant or configurable parameter for readability and easier tuning.",
      "file": "scripts/ops/provision_retry.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 18,
      "description": "Embedding a UUID directly in the source can be considered a hard\u2011coded configuration value; moving it to a configuration module or environment variable improves maintainability.",
      "file": "scripts/ops/provision_retry.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 64,
      "description": "`main` lacks a return type annotation. While not functionally required, adding `-> None` clarifies that the function does not return a value and aligns with type\u2011checking practices.",
      "file": "scripts/ops/provision_retry.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 30,
      "description": "Function `validate_ingestion_results` is annotated to return `None` but actually returns boolean values (`True`/`False`).",
      "file": "scripts/verification/validate_ingestion_results.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 124,
      "description": "The code slices `row[0]` (`folder_name`) with `row[0][:40]` without checking for `None`, which could raise a `TypeError` if the column is null.",
      "file": "scripts/verification/validate_ingestion_results.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 38,
      "description": "Catches a broad `Exception` when loading configuration, masking the specific error type and potentially hiding useful traceback information.",
      "file": "scripts/verification/validate_ingestion_results.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 46,
      "description": "Catches a broad `Exception` when creating the database engine and inspector, which can obscure connection\u2011specific errors.",
      "file": "scripts/verification/validate_ingestion_results.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 41,
      "description": "Prints a partially masked database URL (`...@{masked}`); if the URL contains a password before the `@`, the password may be exposed in logs.",
      "file": "scripts/verification/validate_ingestion_results.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 18,
      "description": "Manipulates `sys.path` at runtime to import project modules; this is generally discouraged and can lead to import\u2011resolution issues.",
      "file": "scripts/verification/validate_ingestion_results.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 66,
      "description": "Uses magic numbers (e.g., 1% tolerance, expected record counts) directly in the code instead of defining named constants.",
      "file": "scripts/verification/validate_ingestion_results.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 5,
      "description": "The configuration is fetched twice (`config = get_config()` followed by another identical call), overwriting the first result unnecessarily and potentially causing side\u2011effects if `get_config` is not idempotent.",
      "file": "scripts/verification/check_schema.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 56,
      "description": "`defn` may be `None` if the query returns no row; calling `.lower()` on it would raise an `AttributeError`. The code should guard against a `None` result before using string methods.",
      "file": "scripts/verification/check_schema.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 5,
      "description": "Redundant call to `get_config()` results in an extra, likely unnecessary, load of configuration data, adding avoidable overhead.",
      "file": "scripts/verification/check_schema.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 4,
      "description": "The public function `check_schema` lacks type hints for parameters and return type, reducing readability and static analysis support.",
      "file": "scripts/verification/check_schema.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 64,
      "description": "The script uses `print` for logging and error reporting instead of the `logging` module, which is the conventional practice for production\u2011level Python code.",
      "file": "scripts/verification/check_schema.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 66,
      "description": "A broad `except Exception` catches all exceptions, prints a message, and then silently continues, potentially hiding critical failures and making debugging harder.",
      "file": "scripts/verification/check_schema.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 55,
      "description": "The index definition (`defn`) is printed to stdout, which may expose internal database schema details that could be sensitive in certain environments.",
      "file": "scripts/verification/check_schema.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 50,
      "description": "Calls `summarizer.embed_summary(summary)`, but `ConversationSummarizer` (imported from `cortex.intelligence.summarizer`) does not define an `embed_summary` method, leading to an AttributeError at runtime.",
      "file": "scripts/verification/verify_summary.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 11,
      "description": "Modifies `sys.path` by inserting a directory derived from a relative path (`backend/src`). If the repository layout is compromised, this could cause unwanted modules to be imported, posing a security risk.",
      "file": "scripts/verification/verify_summary.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 24,
      "description": "`logging.basicConfig` is called at module import time, which globally configures logging and may interfere with applications that import this script as a module.",
      "file": "scripts/verification/verify_summary.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 28,
      "description": "`test_conversation_summarizer` and `verify_db_schema` lack type annotations for parameters and return values, reducing static type\u2011checking usefulness for public functions.",
      "file": "scripts/verification/verify_summary.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 73,
      "description": "The code accesses `report.manifests_updated`, but `ManifestValidationReport` (the expected return type from `scan_and_refresh`) does not define a `manifests_updated` field, leading to an AttributeError at runtime.",
      "file": "scripts/verification/verify_idempotency.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 73,
      "description": "Accessing a non\u2011existent attribute (`manifests_updated`) also constitutes a type mismatch between the assumed interface of the returned object and its actual definition.",
      "file": "scripts/verification/verify_idempotency.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 1,
      "description": "`hashlib` is imported twice (once at the top of the file and again implicitly via usage later); the duplicate import is unnecessary.",
      "file": "scripts/verification/verify_idempotency.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 16,
      "description": "`setup_test_env` lacks a return type annotation; public functions should specify return types for clarity.",
      "file": "scripts/verification/verify_idempotency.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 38,
      "description": "The manifest dictionary contains hard\u2011coded timestamps and string literals (e.g., \"2025-01-01T10:00:00Z\"); these magic values should be defined as constants or generated dynamically.",
      "file": "scripts/verification/verify_idempotency.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 61,
      "description": "`run_test` also lacks a return type annotation and a docstring, which reduces readability and consistency with the rest of the codebase.",
      "file": "scripts/verification/verify_idempotency.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 9,
      "description": "Modifying `sys.path` at runtime to prepend a relative backend source directory can inadvertently introduce import hijacking vulnerabilities if the directory contents are not trusted.",
      "file": "scripts/verification/verify_idempotency.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 82,
      "description": "The code accesses `report.manifests_updated`, but the `ManifestValidationReport` model defined elsewhere does not contain a `manifests_updated` field, leading to an AttributeError at runtime.",
      "file": "scripts/verification/verify_participants.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 33,
      "description": "`config.storage` is accessed without checking whether `config` or its `storage` attribute is `None`, which could raise an AttributeError if the configuration is incomplete.",
      "file": "scripts/verification/verify_participants.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 98,
      "description": "A broad `except Exception as e` clause catches all exceptions, potentially masking unexpected errors and making debugging harder; no cleanup or re\u2011raising is performed.",
      "file": "scripts/verification/verify_participants.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 36,
      "description": "AWS credentials (`aws_access_key_id` and `aws_secret_access_key`) are passed directly from configuration to the client without any validation or redaction, which could lead to accidental exposure if logs or errors include the client object.",
      "file": "scripts/verification/verify_participants.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 45,
      "description": "The code assumes that the first `list_objects_v2` call returns all folder prefixes; if there are more than 1,000 prefixes, pagination is not handled, potentially missing many folders.",
      "file": "scripts/verification/verify_participants.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 10,
      "description": "Modifying `sys.path` at runtime to import project modules is considered a poor practice and can cause import conflicts; a proper package layout or test runner should be used.",
      "file": "scripts/verification/verify_participants.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 20,
      "description": "Magic number `20` is hard\u2011coded when selecting `target_prefixes`; it should be defined as a named constant for clarity.",
      "file": "scripts/verification/verify_participants.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 82,
      "description": "The script uses `print` statements for status reporting instead of the `logging` module, reducing configurability of output verbosity.",
      "file": "scripts/verification/verify_participants.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 24,
      "description": "The `artifacts_root` directory is created but never used, indicating dead code or an incomplete implementation.",
      "file": "scripts/verification/verify_participants.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 33,
      "description": "`s3_config` is used without a type hint, making static analysis harder; the same applies to `client` and `report` variables.",
      "file": "scripts/verification/verify_participants.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 52,
      "description": "Assumes graph node identifiers are strings when calling `.lower()`. If nodes are non\u2011string types (e.g., integers or custom objects), this will raise an AttributeError.",
      "file": "scripts/verification/verify_graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 7,
      "description": "Modifies `sys.path` at runtime to add a relative directory, which is brittle and can cause import side\u2011effects for other modules.",
      "file": "scripts/verification/verify_graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 13,
      "description": "Calls `logging.basicConfig` in a library/script context, potentially overriding logging configuration of the host application.",
      "file": "scripts/verification/verify_graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 17,
      "description": "`test_graph_extractor_live` has no type hints for parameters or return value, reducing static\u2011type checking clarity.",
      "file": "scripts/verification/verify_graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 59,
      "description": "`verify_db_schema` lacks type annotations for its signature, making its contract implicit.",
      "file": "scripts/verification/verify_graph.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 28,
      "description": "Calling `expanded.lower()` without verifying that `expanded` is not None can raise an AttributeError if `QueryExpander.expand` returns None.",
      "file": "scripts/verification/verify_query_expansion.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 38,
      "description": "Calling `expanded_live.lower()` without a None check may raise an AttributeError if the LLM fallback returns None or a non\u2011string value.",
      "file": "scripts/verification/verify_query_expansion.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 27,
      "description": "Using a bare `assert` for test verification means the check disappears when Python is run with optimizations (`-O`), potentially allowing silent failures.",
      "file": "scripts/verification/verify_query_expansion.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 9,
      "description": "Appending a hard\u2011coded relative path (`\"backend/src\"`) to `sys.path` at runtime can unintentionally expose the process to importing unintended modules and may be exploited if the working directory is manipulated.",
      "file": "scripts/verification/verify_query_expansion.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 13,
      "description": "Adding a `NullHandler` directly to the module logger each import can result in multiple identical handlers if the module is imported more than once, leading to duplicate log entries.",
      "file": "scripts/verification/verify_query_expansion.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 48,
      "description": "The script mixes test logic with a `if __name__ == \"__main__\"` runner and prints directly to stdout; this makes the module unsuitable for import as a library and violates separation of concerns.",
      "file": "scripts/verification/verify_query_expansion.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 15,
      "description": "The public function `test_query_expansion_live` lacks type annotations for its parameters and return type, reducing static analysis usefulness.",
      "file": "scripts/verification/verify_query_expansion.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 6,
      "description": "The computation `Path(__file__).resolve().parents[2]` assumes the file is at least three directories deep; if the file path is shallower, an IndexError will be raised at import time.",
      "file": "scripts/verification/verify_correctness.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 48,
      "description": "The test accesses `chunks[0]` without verifying that `chunks` is non\u2011empty, which can raise an IndexError if `chunk_text` returns an empty list.",
      "file": "scripts/verification/verify_correctness.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 2,
      "description": "`Path` is imported twice (once at the top and again after `unittest`), resulting in a redundant import.",
      "file": "scripts/verification/verify_correctness.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 41,
      "description": "Use of `print` statements inside unit tests clutters test output and is generally discouraged; testing frameworks provide assertion messages instead.",
      "file": "scripts/verification/verify_correctness.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 8,
      "description": "Appending `Path.cwd() / \"backend\" / \"src\"` to `sys.path` at runtime can unintentionally expose the interpreter to malicious code if the working directory is compromised.",
      "file": "scripts/verification/verify_correctness.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 61,
      "description": "When constructing `base_url` for the \"list\" command, the code removes everything after the last '/' and appends '/defaultdb'. This discards any query parameters (e.g., `?sslmode=require`) or port specifications that may be part of the original URL, potentially resulting in an invalid connection string.",
      "file": "scripts/verification/inspect_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 97,
      "description": "The function `check_vector` assumes the `chunks` table always exists. If the table is missing, `insp.get_columns(\"chunks\")` will raise an exception that is caught only as a generic error, hiding the specific cause and preventing a clear diagnostic.",
      "file": "scripts/verification/inspect_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 36,
      "description": "`get_config()` may return a configuration object whose `database` attribute could be `None` (e.g., mis\u2011configuration). The code accesses `config.database.url` without checking for `None`, which could raise an AttributeError.",
      "file": "scripts/verification/inspect_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 43,
      "description": "The `except Exception as e` block in `check_connection` prints the error and calls `sys.exit(1)`. This terminates the whole process even when the function might be called programmatically (e.g., from another script or test), making it hard to handle failures upstream.",
      "file": "scripts/verification/inspect_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 82,
      "description": "`list_databases` and `check_vector` catch all exceptions, print a generic message, and then continue silently. This swallows useful traceback information that would aid debugging.",
      "file": "scripts/verification/inspect_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 40,
      "description": "The password\u2011masking logic only hides the part before the '@' but still prints the host, port, and database name, which may be considered sensitive information in some environments.",
      "file": "scripts/verification/inspect_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "PERFORMANCE",
      "line": 71,
      "description": "Row counts for each required table are fetched with separate `SELECT count(*)` queries inside a loop, causing N round\u2011trips to the database. A single query using `UNION ALL` could retrieve all counts more efficiently.",
      "file": "scripts/verification/inspect_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 22,
      "description": "Modifying `sys.path` at runtime to import internal modules is considered poor practice; it can lead to import collisions and makes the script harder to understand.",
      "file": "scripts/verification/inspect_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 1,
      "description": "The script lacks type hints for its public functions (`check_connection`, `list_databases`, `check_vector`, `main`), reducing clarity and static analysis support.",
      "file": "scripts/verification/inspect_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 30,
      "description": "Magic strings such as table names (`\"conversations\"`, `\"chunks\"`, `\"ingest_jobs\"`) and the extension name (`\"vector\"`) are hard\u2011coded without being defined as constants.",
      "file": "scripts/verification/inspect_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 9,
      "description": "`db_url` may be `None` if the environment variable is missing; calling `split` on it would raise an `AttributeError`.",
      "file": "scripts/verification/verify_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 9,
      "description": "The code assumes the database URL contains an '@' character and accesses index\u202f1 after `split('@')`; if the URL format differs, an `IndexError` will occur.",
      "file": "scripts/verification/verify_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 18,
      "description": "A broad `except Exception` catches all exceptions, potentially hiding unexpected errors and preventing proper cleanup (e.g., ensuring the connection is closed in a `finally` block).",
      "file": "scripts/verification/verify_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "SECURITY",
      "line": 9,
      "description": "Printing the connection string (even partially) can expose host or credential information; logging should avoid revealing any part of the DB URL.",
      "file": "scripts/verification/verify_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": null,
      "description": "The script executes on import without an `if __name__ == \"__main__\":` guard, which can lead to side\u2011effects when the module is imported elsewhere.",
      "file": "scripts/verification/verify_db.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "LOGIC_ERRORS",
      "line": 22,
      "description": "Treats any non\u2011zero returncode from `git branch -r` as \u201cNo PRs found\u201d, conflating actual git errors (e.g., repository missing) with an empty PR list.",
      "file": "scripts/verification/check_prs.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 32,
      "description": "Mutates `res.stdout` of a `CompletedProcess` object to reuse the variable, which is unconventional and can lead to confusing state.",
      "file": "scripts/verification/check_prs.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 52,
      "description": "Catches a broad `Exception` when retrieving the commit message, potentially swallowing unrelated errors and making debugging harder.",
      "file": "scripts/verification/check_prs.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 15,
      "description": "Missing module\u2011level docstring and a docstring for `main`; reduces readability and does not follow typical documentation conventions.",
      "file": "scripts/verification/check_prs.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "TYPE_ERRORS",
      "line": 3,
      "description": "`run` is annotated to return `subprocess.CompletedProcess` without specifying the generic type (`CompletedProcess[str]`), which may cause type\u2011checking mismatches when callers expect string attributes.",
      "file": "scripts/verification/check_prs.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 10,
      "description": "The database connection is opened without a try/finally block or a context manager; if any query raises an exception before `conn.close()` is reached, the connection (and cursor) may remain open.",
      "file": "scripts/ingestion/analyze_no_embed.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "EXCEPTION_HANDLING",
      "line": 11,
      "description": "The cursor is never explicitly closed; relying on `conn.close()` to close it can leak resources if an early exception occurs.",
      "file": "scripts/ingestion/analyze_no_embed.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "NULL_SAFETY",
      "line": 61,
      "description": "The `AVG` and `MAX` aggregate query can return `NULL` when no rows match, resulting in `avg_len`, `max_len`, or `avg_span` being `None`. Subsequent formatting with `:.1f` will raise a `TypeError`.",
      "file": "scripts/ingestion/analyze_no_embed.py",
      "found_by": "openai-gpt-oss-120b"
    },
    {
      "category": "STYLE",
      "line": 15,
      "description": "Hard\u2011coded tenant identifier (`\"deep-dive-tenant\"`) is stored in a constant but then immediately copied to `tenant_id`; the extra assignment is unnecessary and can be confusing.",
      "file": "scripts/ingestion/analyze_no_embed.py",
      "found_by": "openai-gpt-oss-120b"
    }
  ]
}