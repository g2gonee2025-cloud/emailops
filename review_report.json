{
  "timestamp": "2025-12-31T02:19:35.230237",
  "summary": {
    "total_files": 143,
    "reviewed": 108,
    "skipped": 5,
    "failed": 30,
    "files_with_issues": 96,
    "total_issues": 902
  },
  "issues": [
    {
      "file": "backend/src/main.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "File ends with an unterminated string literal (logger.info(\"\u2713 OpenTelemetry F...), resulting in a SyntaxError and preventing the application from starting.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ed37347c355c",
      "status": "resolved",
      "resolution": "file parses without syntax errors",
      "validation_method": "parse_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "SECURITY",
      "line": null,
      "description": "JWT decoding failures in _extract_identity are caught and only logged (warning) before falling back to header/default identities, enabling authentication bypass and header spoofing (e.g., attacker-supplied X-Tenant-ID/X-User-ID).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4c665771584a",
      "status": "resolved",
      "resolution": "invalid JWTs now raise",
      "validation_method": "auth_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_extract_identity swallows HTTPException and SecurityError raised by decoders, degrading authentication to anonymous instead of propagating an auth error.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fd9be80b53a6",
      "status": "resolved",
      "resolution": "auth exceptions propagated",
      "validation_method": "auth_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "SECURITY",
      "line": null,
      "description": "Trusting X-Tenant-ID and X-User-ID headers without validation or environment gating allows client-controlled impersonation/privilege escalation in all environments.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "219dbbe48a1b",
      "status": "resolved",
      "resolution": "header fallback gated by environment",
      "validation_method": "auth_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "create_error_response calls correlation_id_ctx.get() without a default; if the middleware hasn\u2019t set a value (e.g., early failures), this can raise a LookupError inside the error handler.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8ef0590025f4",
      "status": "resolved",
      "resolution": "correlation ID default applied",
      "validation_method": "context_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_create_dev_secret_decoder assumes config.SECRET_KEY exists; AttributeError or misconfiguration errors are not handled and will surface as unexpected exceptions.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d153f22c7635",
      "status": "resolved",
      "resolution": "secret presence validated",
      "validation_method": "auth_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_create_jwks_decoder wraps all non-PyJWT errors as 'Failed to load JWKS', conflating token validation failures with JWKS retrieval issues and obscuring root causes.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "65f437cefc7d",
      "status": "resolved",
      "resolution": "JWKS errors differentiated",
      "validation_method": "auth_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "_jwt_decoder is annotated as Callable[[str], Any] | None but is used to return either an awaitable or a dict; this inconsistent typing can confuse callers and static analysis.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6e9237b2d6c0",
      "status": "resolved",
      "resolution": "decoder type clarified",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "SECURITY",
      "line": null,
      "description": "create_error_response only filters a small set of keys ('password', 'api_key', 'secret', 'token', 'credential'); other common sensitive fields (e.g., access_token, id_token, authorization) may be leaked in error contexts.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ded71193f8c5",
      "status": "resolved",
      "resolution": "sensitive keys filtered",
      "validation_method": "redact_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "SECURITY",
      "line": null,
      "description": "StructuredLoggingMiddleware logs raw exception messages on failures, which may expose sensitive information in logs contrary to the stated 'Never log secrets' guidance.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0efd14e912b4",
      "status": "resolved",
      "resolution": "exception message removed from logs",
      "validation_method": "log_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "StructuredLoggingMiddleware pre-serializes log entries with json.dumps before passing to logger, adding unnecessary serialization overhead and limiting structured logging features.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7ce3af57a449",
      "status": "resolved",
      "resolution": "structured log helper used",
      "validation_method": "log_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "STYLE",
      "line": null,
      "description": "Multiple imports are unused (e.g., CORSMiddleware, StaticFiles, FileResponse, validate_email_format), indicating dead code and reduced readability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "94123092ecd5",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "SECURITY",
      "line": null,
      "description": "JWT decoders do not require standard claims like exp/nbf; tokens without expiration may be accepted, weakening token validity guarantees.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "feb65b31df1f",
      "status": "resolved",
      "resolution": "exp required for JWTs",
      "validation_method": "auth_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "cortex_error_handler relies on exc.message; if a CortexError subclass does not define this attribute, the handler will raise an AttributeError during error handling.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5e34c7af172e",
      "status": "resolved",
      "resolution": "fallback message handling added",
      "validation_method": "handler_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/main.py",
      "category": "SECURITY",
      "line": null,
      "description": "If _configure_jwt_decoder is never called, _jwt_decoder remains None and the app will always accept fallback identities, effectively disabling JWT authentication.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ef9927af7164",
      "status": "resolved",
      "resolution": "prod fallback decoder configured",
      "validation_method": "auth_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/observability.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "Accesses to configuration fields assume nested attributes always exist (e.g., config.core.env and config.gcp.gcp_project) and can raise AttributeError when those sections are missing or None.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b30fd3e59078",
      "status": "resolved",
      "resolution": "config access guarded with safe getters",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/observability.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "Span.set_status is called with a StatusCode enum (StatusCode.OK/ERROR) instead of a Status object; in current OpenTelemetry APIs set_status expects a Status, which can cause runtime errors or no-op behavior depending on version.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9ac4765b15e5",
      "status": "resolved",
      "resolution": "span status uses Status objects",
      "validation_method": "otel_status_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/observability.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "Tracing can be initialized without any span exporter/processor (when neither GCP nor OTLP is configured), yet the code logs successful initialization; spans will be created but never exported, which is misleading operationally.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8e92f95bd749",
      "status": "resolved",
      "resolution": "no-exporter warning added",
      "validation_method": "tracing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/observability.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "init_observability() does not handle exceptions from get_config(); any failure during configuration loading will bubble up and crash initialization without contextual logging here.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c5b43e17f003",
      "status": "resolved",
      "resolution": "config load failures logged",
      "validation_method": "config_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/observability.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "Broad except Exception blocks in _init_tracing, _init_metrics, and _init_structured_logging swallow specific errors and only log generic warnings, potentially masking root causes and leaving the system in a partially initialized state.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c993de12a837",
      "status": "resolved",
      "resolution": "exceptions logged with context",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/observability.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "No shutdown/flush of tracer or meter providers/exporters is performed; buffered spans/metrics may be lost on process exit due to missing cleanup.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c58c759bcc1d",
      "status": "resolved",
      "resolution": "shutdown hook added",
      "validation_method": "shutdown_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/observability.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "record_metric logs a warning on every 'gauge' recording, which can flood logs and degrade performance for frequently updated gauges.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "28dd5d010430",
      "status": "resolved",
      "resolution": "observable gauges used without per-call warnings",
      "validation_method": "gauge_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/observability.py",
      "category": "STYLE",
      "line": null,
      "description": "The 'gauge' metric path uses an UpDownCounter and explicitly behaves like a counter, producing semantically incorrect metrics that can mislead dashboards and alerts.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f77dc31973ce",
      "status": "resolved",
      "resolution": "observable gauges implemented",
      "validation_method": "gauge_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/observability.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "record_metric annotates labels as dict[str, str], but OpenTelemetry attributes support multiple primitive types (str, bool, int, float); this overly narrow annotation can cause type mismatches for valid attribute values in callers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4a45f9f965b9",
      "status": "resolved",
      "resolution": "label types widened",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/observability.py",
      "category": "STYLE",
      "line": null,
      "description": "Auto-instrumenting the global requests library in _init_tracing introduces global side effects across the process, which may be undesirable in some embedding contexts and is not documented here.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5305ee3cb7e1",
      "status": "resolved",
      "resolution": "requests instrumentation documented and gated",
      "validation_method": "doc_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/routes_admin.py",
      "category": "SECURITY",
      "line": 26,
      "description": "Admin endpoint is exposed without any authentication/authorization, potentially leaking configuration details to unauthenticated clients.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "13bcf54e38ec",
      "status": "resolved",
      "resolution": "admin dependency enforced",
      "validation_method": "auth_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/routes_admin.py",
      "category": "SECURITY",
      "line": 45,
      "description": "Admin status endpoint is exposed without access control, revealing service and environment information to unauthenticated clients.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "33f6402a8f65",
      "status": "resolved",
      "resolution": "admin dependency enforced",
      "validation_method": "auth_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/routes_admin.py",
      "category": "SECURITY",
      "line": 55,
      "description": "Diagnostics (/doctor) endpoint is exposed without access control, potentially disclosing internal health details to unauthenticated clients.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7b885aadc1c7",
      "status": "resolved",
      "resolution": "admin dependency enforced",
      "validation_method": "auth_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/routes_admin.py",
      "category": "SECURITY",
      "line": 35,
      "description": "The /config response exposes internal metadata (environment, provider, log level, and presence of a database URL) which can aid reconnaissance even if the URL value is masked.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0da03e440921",
      "status": "resolved",
      "resolution": "admin dependency enforced",
      "validation_method": "auth_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/routes_admin.py",
      "category": "EXCEPTION_HANDLING",
      "line": 67,
      "description": "asyncio.gather is used without return_exceptions and no try/except; any single failing check will raise and abort the whole request instead of returning partial results.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "634758c75cff",
      "status": "resolved",
      "resolution": "gather captures exceptions and returns partial results",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/routes_admin.py",
      "category": "EXCEPTION_HANDLING",
      "line": 29,
      "description": "get_config() is called without error handling; any loader failure will propagate as a 500 and the endpoint provides no graceful fallback or context.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "43bf42611323",
      "status": "resolved",
      "resolution": "config load guarded with HTTPException",
      "validation_method": "config_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/routes_admin.py",
      "category": "TYPE_ERRORS",
      "line": 67,
      "description": "Results of asyncio.gather are typed as list[DoctorCheckResult], but typeshed/mypy treat gather\u2019s result as a tuple, creating a static type mismatch with the variable annotation and the DoctorReport.checks field.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8cad8661c71f",
      "status": "resolved",
      "resolution": "gather results normalized to list",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/routes_admin.py",
      "category": "TYPE_ERRORS",
      "line": 23,
      "description": "DoctorReport.checks is annotated as list[DoctorCheckResult]; if DoctorCheckResult is not a Pydantic-compatible model/type, FastAPI response validation/serialization may fail at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "58aec0aaa699",
      "status": "resolved",
      "resolution": "DoctorCheckResult is a Pydantic model",
      "validation_method": "model_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/routes_admin.py",
      "category": "STYLE",
      "line": 18,
      "description": "Declared logger is never used (dead code).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "877c139955ce",
      "status": "resolved",
      "resolution": "logger used for admin error reporting",
      "validation_method": "style_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/routes_admin.py",
      "category": "STYLE",
      "line": 22,
      "description": "Allowed values for overall_status are only documented in a comment and not enforced by type (e.g., Enum/Literal), increasing risk of inconsistent strings.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "72b04d45119b",
      "status": "resolved",
      "resolution": "overall_status constrained via Literal",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/context.py",
      "category": "TYPE_ERRORS",
      "line": 11,
      "description": "Using contextvars.ContextVar as a generic (ContextVar[...]) may not be subscriptable in some Python versions, which can raise a TypeError at import time when evaluating the annotation (also applies to lines 12\u201314).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e1dbd71e2259",
      "status": "resolved",
      "resolution": "runtime supports subscripted ContextVar",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/context.py",
      "category": "TYPE_ERRORS",
      "line": 11,
      "description": "PEP 604 union syntax (str | None) requires Python 3.10+; in earlier versions this is a SyntaxError (also applies to lines 12\u201314).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "72c2a51c46b1",
      "status": "resolved",
      "resolution": "runtime supports PEP 604 unions",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/context.py",
      "category": "TYPE_ERRORS",
      "line": 14,
      "description": "Use of built-in generic types (dict[str, Any]) requires Python 3.9+; in earlier versions this is invalid syntax.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ec6ff74c1901",
      "status": "resolved",
      "resolution": "runtime supports built-in generics",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/context.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "All ContextVars default to None; downstream code that assumes a value is always set risks NoneType/TypeError if not guarded.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "62419b6ad3d3",
      "status": "resolved",
      "resolution": "context defaults set to safe values",
      "validation_method": "null_safety_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/queue_registry.py",
      "category": "TYPE_ERRORS",
      "line": 11,
      "description": "Uses PEP 585 built-in generics (list[str]) which are only valid on Python 3.9+; on older interpreters this will be a SyntaxError at import time.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f736c20a54c3",
      "status": "resolved",
      "resolution": "runtime supports built-in generics",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/queue_registry.py",
      "category": "TYPE_ERRORS",
      "line": 18,
      "description": "Function return annotation uses list[str], which is invalid syntax on Python <3.9 and will break import on older runtimes.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "926311ac1a9b",
      "status": "resolved",
      "resolution": "runtime supports built-in generics",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/queue_registry.py",
      "category": "STYLE",
      "line": 11,
      "description": "Module exposes a mutable global list as a public constant; external code can mutate it directly, risking unintended side effects and undermining the intended single source of truth.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "60e79657fa68",
      "status": "resolved",
      "resolution": "immutable job types tuple used",
      "validation_method": "style_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "enqueued_count is incremented unconditionally after calling _enqueue_ingest_job, even when the enqueue fails internally (exceptions are caught inside _enqueue_ingest_job). This causes inflated 'enqueued' and downstream stats.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1262244c70a8",
      "status": "resolved",
      "resolution": "enqueue count increments only on success",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "folders_found and folders_processed are set to enqueued_count, conflating 'discovered' with 'successfully enqueued' and 'processed'. The method only enqueues jobs, so 'processed' is misleading and can be incorrect when enqueues fail.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cb89ec2d75f1",
      "status": "resolved",
      "resolution": "found/enqueued tracked separately",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "PipelineStats is instantiated once in __init__ and reused; counters are not reset and start_time is fixed at construction. duration_seconds measures from object creation, and repeated runs will accumulate counts/time unintentionally.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a8a5e8407122",
      "status": "resolved",
      "resolution": "stats reset per run",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "folders_skipped is never updated anywhere, yet is reported in the final log, leading to permanently zero 'Skipped' and inconsistent reporting.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "70a1c8a86447",
      "status": "resolved",
      "resolution": "skipped folders tracked",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "_enqueue_ingest_job is annotated as accepting folder: str, but it relies on attributes like 'name' and 'prefix', indicating it actually expects a non-str object. The annotation is misleading and can confuse type checkers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c91f75cc87cc",
      "status": "resolved",
      "resolution": "enqueue accepts S3 folder types",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "job_id is set to a uuid.UUID; depending on IngestJobRequest schema and queue serialization, this may be an incompatible type (e.g., if a string is expected), risking downstream serialization errors in payload=job_request.dict().",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "08f6dbd9f142",
      "status": "resolved",
      "resolution": "UUIDs serialized in payload",
      "validation_method": "serialization_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "Discovery via self.s3_handler.list_conversation_folders is not wrapped in exception handling; any failure during listing aborts the entire run without updating stats or errors_list.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "422d812863fe",
      "status": "resolved",
      "resolution": "discovery failures handled",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "When exceptions occur in run (outside the internal try of _enqueue_ingest_job), only folders_failed is incremented; no entry is added to errors_list, leading to incomplete error tracking compared to failures handled inside _enqueue_ingest_job.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b28df01f041b",
      "status": "resolved",
      "resolution": "run errors captured in errors_list",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "IngestionProcessor and Indexer are instantiated in __init__ but are not used in run; this incurs unnecessary construction cost (and potential side effects), including in dry_run mode.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "123944ed352d",
      "status": "resolved",
      "resolution": "unused processors removed",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "Imports inside _enqueue_ingest_job are executed on each call (although cached by Python), adding avoidable overhead on hot paths.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b1c594a15156",
      "status": "resolved",
      "resolution": "imports moved to module scope",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "STYLE",
      "line": null,
      "description": "auto_embed parameter is accepted and stored but never used; Indexer and IngestionProcessor are created but unused. This indicates dead/unimplemented code paths and can confuse maintainers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "35a5395b203a",
      "status": "resolved",
      "resolution": "auto_embed propagated in job options",
      "validation_method": "style_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "STYLE",
      "line": null,
      "description": "Magic number priority=5 is used directly in queue.enqueue without a named constant, reducing readability and configurability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "21d04032c922",
      "status": "resolved",
      "resolution": "enqueue priority constant added",
      "validation_method": "style_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "STYLE",
      "line": null,
      "description": "logger.exception uses an f-string with the exception value (\u2026: {e}); logger.exception already logs the stack trace and message, leading to redundant information in logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "36f8a9162006",
      "status": "resolved",
      "resolution": "logger.exception uses format args",
      "validation_method": "style_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "PipelineStats.errors_list is typed as a bare list, but stores dicts with specific keys; the lack of a precise element type hinders static analysis and clarity.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "dad01328db3b",
      "status": "resolved",
      "resolution": "errors_list typed with dict entries",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestrator.py",
      "category": "STYLE",
      "line": null,
      "description": "The class/docstring claims to orchestrate end-to-end ingestion and embedding, but the implementation only discovers and enqueues ingestion jobs; metrics like chunks_created and embeddings_generated are never updated here, suggesting an incomplete implementation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ddc89e48a870",
      "status": "resolved",
      "resolution": "docstring aligned to enqueueing scope",
      "validation_method": "doc_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/text_extraction.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "File ends with an incomplete function definition (`def _extract_word_document(path: Path, suffix: str, max_`), which results in a SyntaxError and prevents the module from importing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1f9a6ef35586",
      "status": "resolved",
      "resolution": "file parses without syntax errors",
      "validation_method": "parse_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/text_extraction.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_extract_with_tika wraps the Tika parse call in contextlib.suppress(Exception), swallowing all parsing/connection errors and returning an empty string with only a generic debug log, making failures hard to diagnose.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "35d2cf38a918",
      "status": "resolved",
      "resolution": "tika parse errors logged",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/text_extraction.py",
      "category": "SECURITY",
      "line": null,
      "description": "SSRF mitigation for TIKA_SERVER_URL relies on a permissive regex and still allows internal or loopback addresses; setting TIKA_SERVER_ENDPOINT directly from environment input could enable server-side requests to unintended hosts if the environment is compromised.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d88237b06df4",
      "status": "resolved",
      "resolution": "tika URL validation hardened",
      "validation_method": "security_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/text_extraction.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "Multiple imports are wrapped in broad except Exception blocks (Pillow, pytesseract, pdf2image, extract_msg, BeautifulSoup, pdfplumber), conflating ImportError with runtime import-time errors and potentially masking genuine issues during module loading.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c5c8c1975749",
      "status": "resolved",
      "resolution": "import errors separated from runtime failures",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/text_extraction.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_extract_pdf_with_ocr suppresses all per-page OCR exceptions with contextlib.suppress(Exception), losing visibility into repeated or systemic OCR failures on specific pages.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "68fa2235d4d7",
      "status": "resolved",
      "resolution": "per-page OCR errors logged",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/text_extraction.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "_extract_pdf_with_ocr uses pdf2image.convert_from_path to rasterize all pages into memory before processing, which can cause very high memory usage on large PDFs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3fdaf61af2a5",
      "status": "resolved",
      "resolution": "PDF OCR paged to limit memory",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/text_extraction.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_extract_pdf_tables uses contextlib.suppress(Exception) around the pdfplumber open/extraction block, which can silently hide errors encountered during file opening or table extraction.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0b10d5ce4e09",
      "status": "resolved",
      "resolution": "pdfplumber errors logged",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/text_extraction.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "_extract_pdf_tables with pdfplumber uses page.extract_table(), which returns only a single table; this likely misses additional tables present on the same page.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "683834cff16f",
      "status": "resolved",
      "resolution": "all tables extracted per page",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/text_extraction.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "_extract_pdf_tables builds CSV lines by joining cells with commas without escaping quotes, commas, or newlines, producing malformed CSV when cell content contains such characters.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2077e91c6446",
      "status": "resolved",
      "resolution": "CSV rows are quoted safely",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/text_extraction.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_extract_text_from_doc_win32 may leak a Word COM instance if an exception occurs after instantiating the application but before entering the inner try/finally (e.g., failure on setting word.Visible), since word.Quit() is only guaranteed inside the inner finally.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8b55fc8105cf",
      "status": "resolved",
      "resolution": "COM cleanup moved to outer finally",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/text_extraction.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "_extract_eml reads the entire message into memory via path.read_bytes(); for very large email files this can be memory-inefficient.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2f2745ffc680",
      "status": "resolved",
      "resolution": "EML parsing streams from file handle",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/text_extraction.py",
      "category": "STYLE",
      "line": null,
      "description": "Global cache variables (_extraction_cache, _extraction_cache_lock, _CACHE_TTL) are declared but not used in the provided code snippet, indicating potential dead or incomplete code paths.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c3f45f60edcd",
      "status": "resolved",
      "resolution": "cache is exercised in extract_text",
      "validation_method": "usage_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "LOGIC_ERRORS",
      "line": 65,
      "description": "Using zip(chunk_ids, embeddings) silently truncates on length mismatch; if embed_batch returns fewer/more embeddings than requested, some chunks won't be updated while the success log still reports len(rows).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b67e9c02edfd",
      "status": "resolved",
      "resolution": "embedding length mismatch guarded",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "LOGIC_ERRORS",
      "line": 38,
      "description": "No protection against enqueuing the same conversation concurrently; multiple workers can process the same conversation_id, causing duplicate work and race conditions updating the same rows.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b3ffafb3cb4e",
      "status": "resolved",
      "resolution": "inflight guard added",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "NULL_SAFETY",
      "line": 60,
      "description": "No check for NULL texts; if chunks.text contains NULL, embed_batch may raise due to None values in chunk_texts.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "84360a0c4ea8",
      "status": "resolved",
      "resolution": "null/empty texts skipped",
      "validation_method": "null_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "NULL_SAFETY",
      "line": 30,
      "description": "db_url is used without validation; if config.database.url is None or empty, create_engine will fail at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b12def778ead",
      "status": "resolved",
      "resolution": "db_url validated before engine creation",
      "validation_method": "config_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "EXCEPTION_HANDLING",
      "line": 76,
      "description": "Broad catch-all logs the exception but swallows it, providing no signaling to callers or retry mechanism for failed jobs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "180ef3fc6d41",
      "status": "resolved",
      "resolution": "errors logged and re-raised with rollback",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "EXCEPTION_HANDLING",
      "line": 46,
      "description": "No explicit transaction rollback on error; if an exception occurs after some statements, behavior relies on Session context manager semantics and may leave the transaction state unclear until the session closes.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "bd738ebe608d",
      "status": "resolved",
      "resolution": "explicit rollback added",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "PERFORMANCE",
      "line": 65,
      "description": "Per-row UPDATE in a loop results in N round-trips to the database; this is inefficient for large batches.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f8854feb8c7c",
      "status": "resolved",
      "resolution": "batch updates via executemany",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "PERFORMANCE",
      "line": 47,
      "description": "fetchall loads all eligible chunks into memory; for large conversations this can be memory-heavy and slow; no batching or streaming.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d4f21886c475",
      "status": "resolved",
      "resolution": "rows fetched in batches",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "PERFORMANCE",
      "line": 26,
      "description": "ThreadPoolExecutor uses an unbounded work queue; excessive enqueue_conversation calls can grow the queue without limit, increasing memory usage.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6310cc2c564c",
      "status": "resolved",
      "resolution": "inflight semaphore bounds queue",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "PERFORMANCE",
      "line": 63,
      "description": "embed_batch is invoked with the entire chunk_texts list; if very large, it may cause high latency or memory pressure due to lack of batching.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2a452171eb97",
      "status": "resolved",
      "resolution": "embedding requests batched",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "STYLE",
      "line": 44,
      "description": "Logging uses f-strings, incurring string formatting cost even when the log level is disabled; recommended style is lazy formatting with logger arguments.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ff0cf86d3135",
      "status": "resolved",
      "resolution": "logging uses lazy formatting",
      "validation_method": "style_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "TYPE_ERRORS",
      "line": 70,
      "description": "The 'embedding' parameter type is unspecified; if embed_batch returns non-DB-serializable types (e.g., list/ndarray), binding to the SQL parameter may fail at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "bb4790bdb0bf",
      "status": "resolved",
      "resolution": "embeddings normalized before DB write",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "TYPE_ERRORS",
      "line": 51,
      "description": "Passing a UUID directly as a bound parameter may not be supported by all database drivers/dialects without explicit adaptation; potential type mismatch depending on backend.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ad7f327f2b9c",
      "status": "resolved",
      "resolution": "conversation_id cast to string",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/indexer.py",
      "category": "EXCEPTION_HANDLING",
      "line": 79,
      "description": "shutdown only closes the executor; there is no explicit cleanup for the SQLAlchemy engine or the EmbeddingsClient, which may hold network/IO resources across the lifetime of the process.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f464ab9eebba",
      "status": "resolved",
      "resolution": "engine disposed on shutdown",
      "validation_method": "shutdown_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/grounding.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "File ends with an incomplete f-string/log statement in check_grounding_llm (truncated 'logger.warning(...)'), causing a SyntaxError and preventing the module from importing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "51d7975a27a0",
      "status": "resolved",
      "resolution": "module parses without syntax errors",
      "validation_method": "parse_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/grounding.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "GroundingAnalysisResult.claims is typed as list[ClaimAnalysis], but ClaimAnalysis requires 'method'. LLM output is unlikely to include 'method', causing Pydantic validation to fail when constructing GroundingAnalysisResult.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5a3edec66aad",
      "status": "resolved",
      "resolution": "LLM claim inputs allow missing method",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/grounding.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "In check_grounding_llm, claim_analyses_with_method rebuilds ClaimAnalysis via ClaimAnalysis(**c.model_dump(), method='llm'). If items already include 'method' (per schema), this passes 'method' twice and raises a TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "97ca9d520c9f",
      "status": "resolved",
      "resolution": "method default applied only when missing",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/grounding.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "extract_claims_simple splits text on punctuation including '?', then checks `if '?' in sentence` to skip questions. This condition is ineffective because '?' has been removed by the split.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2499ed66fd9e",
      "status": "resolved",
      "resolution": "question detection preserved after split",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/grounding.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "HEDGE_PATTERNS contains r\"\\bIt\\'s possible\\b\" as a raw string with an escaped apostrophe, which matches a backslash + apostrophe rather than \"It's possible\", causing missed detection of that hedged phrase.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "44ef9e3ff3c3",
      "status": "resolved",
      "resolution": "hedge pattern corrected",
      "validation_method": "pattern_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/grounding.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "check_grounding_llm falls back to check_grounding_embedding on ImportError, but no such function is defined in this file, leading to a NameError at runtime if that path is taken.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8d812337afea",
      "status": "resolved",
      "resolution": "embedding fallback defined",
      "validation_method": "presence_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/grounding.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "In check_claim_against_facts_embedding, iterating with zip(facts, fact_embeddings) silently ignores any extra facts or embeddings if lengths differ, potentially skipping data without warning.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "25927cd4e3e6",
      "status": "resolved",
      "resolution": "fact embedding length mismatch handled",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/grounding.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "grounding_ratio is set to 1.0 when there are zero claims, which can misrepresent an answer with no verifiable claims as fully grounded.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "94239e15ef5c",
      "status": "resolved",
      "resolution": "empty-claim grounding ratio set to 0.0",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/grounding.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "Multiple broad `except Exception` blocks (e.g., in extract_claims_llm, check_claim_against_facts_embedding, check_grounding_llm) swallow all exceptions and only log a generic warning, which can mask underlying bugs and omit stack traces.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ed1b57b4219b",
      "status": "resolved",
      "resolution": "exceptions logged with tracebacks",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/grounding.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "Assumes construct_prompt_messages returns at least two entries and accesses messages[0] and messages[1] without checks; if the contract changes, this will raise IndexError that is only generically handled, making diagnosis difficult.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "908d5cd5af5d",
      "status": "resolved",
      "resolution": "prompt message length validated",
      "validation_method": "validation_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/grounding.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "check_claim_against_facts_embedding computes the claim embedding before checking for empty facts, incurring an unnecessary embedding API call when facts is empty.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "445595bf232e",
      "status": "resolved",
      "resolution": "empty facts short-circuit before embedding",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/grounding.py",
      "category": "STYLE",
      "line": null,
      "description": "DEFAULT_EMBEDDING_GROUNDING_THRESHOLD is defined but never used (dead constant).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7ee4825a3186",
      "status": "resolved",
      "resolution": "grounding threshold used in API",
      "validation_method": "usage_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/grounding.py",
      "category": "STYLE",
      "line": null,
      "description": "GroundingCheckInput.use_llm is defined but not used in this module (unused configuration parameter).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "595ad53c3a69",
      "status": "resolved",
      "resolution": "use_llm flag respected",
      "validation_method": "usage_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/__init__.py",
      "category": "EXCEPTION_HANDLING",
      "line": 10,
      "description": "Top-level from-import of cortex.safety.grounding will cause the entire package import to fail with ImportError if the submodule or any of the specified symbols are unavailable or have been renamed; no guarding is present.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0e380ddf687c",
      "status": "resolved",
      "resolution": "grounding imports loaded lazily",
      "validation_method": "import_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/__init__.py",
      "category": "EXCEPTION_HANDLING",
      "line": 17,
      "description": "Top-level from-import of cortex.safety.policy_enforcer will raise ImportError at package import time if the module or symbols are missing, making all consumers fail on import.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "73661051dda8",
      "status": "resolved",
      "resolution": "policy imports loaded lazily",
      "validation_method": "import_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/__init__.py",
      "category": "EXCEPTION_HANDLING",
      "line": 18,
      "description": "Top-level from-import of cortex.security.injection_defense can fail at import time and break package initialization if the submodule or its dependencies are not present; there is no handling for optional features.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8a5f5c0ecf06",
      "status": "resolved",
      "resolution": "injection defense imports loaded lazily",
      "validation_method": "import_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/__init__.py",
      "category": "PERFORMANCE",
      "line": 10,
      "description": "Eagerly importing multiple submodules at package import time increases startup latency and memory usage even when only a subset of symbols is needed by consumers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "83d5cae45ba7",
      "status": "resolved",
      "resolution": "lazy import map avoids eager loading",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/__init__.py",
      "category": "PERFORMANCE",
      "line": 17,
      "description": "Aggregating imports in __init__ introduces import-time overhead and potential side effects from the submodules for any import of cortex.safety.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3f35a954affe",
      "status": "resolved",
      "resolution": "lazy __getattr__ reduces import overhead",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/__init__.py",
      "category": "STYLE",
      "line": 5,
      "description": "Docstring claims the module provides 'Guardrails for LLM output repair (\u00a79.3)', but no related functions or classes are imported or exported, indicating documentation drift/inaccuracy.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f17c8dd24344",
      "status": "resolved",
      "resolution": "guardrails exports added",
      "validation_method": "doc_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/__init__.py",
      "category": "STYLE",
      "line": 10,
      "description": "Imported names are not referenced within this module beyond being re-exported via __all__; some linters may flag these as unused imports, causing noise in static analysis.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "da6d538bc4c8",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "EXCEPTION_HANDLING",
      "line": 17,
      "description": "Instantiating PolicyConfig at import time can raise and abort module import; no handling for configuration load failures or I/O errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6fa9e889c052",
      "status": "resolved",
      "resolution": "policy config loaded lazily",
      "validation_method": "config_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "TYPE_ERRORS",
      "line": 54,
      "description": "len(recipients) assumes a sized iterable; if metadata['recipients'] is a truthy non-sequence (e.g., int or an iterator without __len__), this will raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a1729889e283",
      "status": "resolved",
      "resolution": "recipients normalized before length checks",
      "validation_method": "validation_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "TYPE_ERRORS",
      "line": 94,
      "description": "Attachments are assumed to be dict-like; calling attachment.get(...) will raise AttributeError if any element is not a dict.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "96bfea8afb90",
      "status": "resolved",
      "resolution": "attachment metadata validated",
      "validation_method": "validation_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "TYPE_ERRORS",
      "line": 100,
      "description": "Summing a.get('size', 0) assumes numeric sizes; non-numeric values (e.g., strings) will raise TypeError during summation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ec2374c9f876",
      "status": "resolved",
      "resolution": "attachment sizes validated",
      "validation_method": "validation_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "SECURITY",
      "line": 102,
      "description": "Allowing metadata['max_attachment_size'] to override policy size enables a user-controlled bypass of attachment size limits if metadata is untrusted.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3ff1a6e79f00",
      "status": "resolved",
      "resolution": "attachment size override removed",
      "validation_method": "security_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "SECURITY",
      "line": 129,
      "description": "The trace_operation decorator may capture and record the full action and metadata, potentially leaking sensitive content/PII in traces if not redacted.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5cb2376c6733",
      "status": "resolved",
      "resolution": "tracing uses static span name only",
      "validation_method": "observability_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "TYPE_ERRORS",
      "line": 130,
      "description": "Signature types declare metadata: dict[str, Any], but the function accepts None via 'metadata or {}', causing a mismatch that can mislead callers and static analyzers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "74e0acbd1572",
      "status": "resolved",
      "resolution": "metadata optional in signature",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "LOGIC_ERRORS",
      "line": 193,
      "description": "Using truthiness for 'force_deny' treats any truthy non-boolean (e.g., the string 'false') as a deny flag, leading to unintended denials.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ab18c738e5be",
      "status": "resolved",
      "resolution": "force_deny requires explicit True",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "LOGIC_ERRORS",
      "line": 202,
      "description": "roles may be a non-list truthy value (e.g., a string), so '\"admin\" in roles' performs substring membership and can erroneously grant admin bypass.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "764272f28fbe",
      "status": "resolved",
      "resolution": "roles normalized to list of strings",
      "validation_method": "validation_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "LOGIC_ERRORS",
      "line": 204,
      "description": "Appending safe_meta['role'] to roles mutates the original metadata['user_roles'] list, introducing side effects outside this function.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6c19f003e6ae",
      "status": "resolved",
      "resolution": "roles list rebuilt without mutation",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "SECURITY",
      "line": 202,
      "description": "Trusting 'user_roles'/'role' from metadata without verification allows privilege escalation by forging an 'admin' role to bypass approval.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3fea42a2f497",
      "status": "resolved",
      "resolution": "admin bypass gated on verified roles",
      "validation_method": "security_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "NULL_SAFETY",
      "line": 217,
      "description": "list(metadata.keys()) assumes metadata is a dict; if None is passed, this raises AttributeError despite earlier guarding with 'metadata or {}'.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "dd9167717ae1",
      "status": "resolved",
      "resolution": "metadata keys derived from safe dict",
      "validation_method": "null_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "SECURITY",
      "line": 177,
      "description": "Logging violations at warning level may include sensitive details (e.g., recipient addresses or content indicators), leading to PII leakage in logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8089f8f85e50",
      "status": "resolved",
      "resolution": "warning log avoids sensitive details",
      "validation_method": "logging_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "SECURITY",
      "line": 215,
      "description": "Returning detailed 'violations' in the result metadata can propagate sensitive information (e.g., emails, content patterns) to downstream consumers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f2e6feefc869",
      "status": "resolved",
      "resolution": "metadata returns violation codes only",
      "validation_method": "privacy_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/policy_enforcer.py",
      "category": "LOGIC_ERRORS",
      "line": 227,
      "description": "is_action_allowed returns True for 'require_approval'; callers may misinterpret this as immediate allowance, potentially bypassing required approval flows.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "17e72736dd2f",
      "status": "resolved",
      "resolution": "is_action_allowed only true for allow",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/config.py",
      "category": "LOGIC_ERRORS",
      "line": 49,
      "description": "external_domain_pattern uses '@(?!internal\\.company\\.com$)' which is not anchored to the start of the domain and only guards against an exact end-of-string match; when evaluated against strings containing trailing characters (e.g., commas, display names, multiple recipients) it will incorrectly classify an internal address as external.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d91752fcfecd",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/config.py",
      "category": "SECURITY",
      "line": 49,
      "description": "Misclassification risk in external_domain_pattern can cause internal recipients to be treated as external (or vice versa) when parsing broader strings, potentially weakening recipient safety checks.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9f00ed0402eb",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/config.py",
      "category": "EXCEPTION_HANDLING",
      "line": 70,
      "description": "get_sensitive_patterns compiles user-configurable regex strings without handling re.error; invalid patterns will raise unhandled exceptions.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fee1ab44f1f2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/config.py",
      "category": "EXCEPTION_HANDLING",
      "line": 74,
      "description": "get_external_domain_pattern compiles a user-configurable regex without handling re.error; invalid patterns will raise unhandled exceptions.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f7a96ac262a9",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/config.py",
      "category": "PERFORMANCE",
      "line": 70,
      "description": "get_sensitive_patterns recompiles all regexes on every call, causing avoidable overhead if invoked frequently.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8175b28b3794",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/config.py",
      "category": "PERFORMANCE",
      "line": 74,
      "description": "get_external_domain_pattern recompiles the regex on every call, causing repeated work that could be avoided.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fbce63fa2f21",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/config.py",
      "category": "TYPE_ERRORS",
      "line": 12,
      "description": "The model relies on Pydantic type validation at creation time but has no validate-on-assignment; fields (e.g., sensitive_patterns) can be reassigned to incompatible types (e.g., None or non-iterables) post-instantiation, leading to runtime errors in methods that assume correct types.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0324387548ed",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/guardrails_client.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "In validate_with_repair, when JSON parsing of a markdown code block fails, the raised LLMOutputSchemaError message references the outer exception variable from the initial parse failure rather than the inner code-block parse exception, leading to misleading error messages.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "708df8546b63",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/guardrails_client.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "GuardrailsClient.validate_output claims to catch all exceptions and return None on failure, but it only catches LLMOutputSchemaError from validate_with_repair; other exceptions can propagate, violating the documented behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f29f50703fcf",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/guardrails_client.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "In GuardrailsClient.validate_output, when output is a dict, json.dumps(output) is not wrapped in a try/except; TypeError/ValueError from non-serializable content can escape, unlike the else branch which handles serialization errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7e1174a9d084",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/guardrails_client.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "validate_with_repair re-validates the repaired output with target_model.model_validate after attempt_llm_repair already validated it and returned a model_dump; this redundant validation adds unnecessary compute.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1aae8bd68c27",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/safety/guardrails_client.py",
      "category": "STYLE",
      "line": null,
      "description": "logger.error uses a generic constant message 'LLM_OUTPUT_SCHEMA_ERROR' without embedding context in the message itself, which may reduce log readability in systems that do not capture the 'extra' fields.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3bdf7084e025",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/models.py",
      "category": "TYPE_ERRORS",
      "line": 17,
      "description": "_PII_FIELDS is annotated as a regular model field (set[str]) rather than a non-field attribute (e.g., ClassVar/PrivateAttr). Pydantic will treat it as a model field, which is likely unintended and changes validation/schema/serialization behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6cf009519f48",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/models.py",
      "category": "SECURITY",
      "line": 17,
      "description": "Because _PII_FIELDS is a Pydantic field, it can be supplied or modified via model construction or parsing, allowing external input to alter which fields are redacted (or disable redaction), weakening the intended protection.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "67b1faf59730",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/models.py",
      "category": "SECURITY",
      "line": 17,
      "description": "As a model field, _PII_FIELDS will be included in the model representation/serialization unless excluded; its contents (the names of PII fields) can be exposed in logs or API outputs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "64f6e4693442",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/models.py",
      "category": "STYLE",
      "line": 17,
      "description": "Mutable default (set()) used for a class attribute that is being treated as a Pydantic field; this can lead to shared state across instances if used as a field, which is generally discouraged.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a2c33eb71d70",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/models.py",
      "category": "TYPE_ERRORS",
      "line": 17,
      "description": "Docstring says children may define a tuple or set, but the type annotation is set[str]; assigning a tuple in subclasses will violate the annotation and may cause type-checker warnings or implicit coercion.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4a978dd6dc62",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/models.py",
      "category": "SECURITY",
      "line": 8,
      "description": "Redaction only applies to the __repr__ output via __repr_args__; other common serialization/logging paths (e.g., dict()/json()/model_dump()) remain unredacted and can leak PII if used in logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "602de664049a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/models.py",
      "category": "STYLE",
      "line": 19,
      "description": "Relies on overriding Pydantic's internal __repr_args__ hook; this is a private/unstable API across Pydantic versions and may break with upgrades.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ee7b175273ec",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/models.py",
      "category": "LOGIC_ERRORS",
      "line": 25,
      "description": "Redaction checks membership by the key names returned from __repr_args__; if field aliases are used and __repr__ emits aliases or different keys, intended PII fields may not be redacted.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "69c896af17ef",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/redis.py",
      "category": "NULL_SAFETY",
      "line": 10,
      "description": "Unprotected access to request.app.state.redis; if the application state does not have a 'redis' attribute or it is None, this can raise AttributeError or return None unexpectedly.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "be5ce1937768",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/redis.py",
      "category": "EXCEPTION_HANDLING",
      "line": 10,
      "description": "No handling for the case where 'request.app.state.redis' is missing; an AttributeError would propagate and result in a 500 response instead of a controlled error.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "74cbc1a51807",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/redis.py",
      "category": "TYPE_ERRORS",
      "line": 5,
      "description": "The function is annotated to return redis.Redis, but it returns a dynamically attached application state attribute of unknown type; static type checkers cannot verify this (state is effectively Any), and at runtime it may not be a redis.Redis instance.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "548778745864",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/redis.py",
      "category": "PERFORMANCE",
      "line": 5,
      "description": "The function is async but performs no await or I/O, incurring unnecessary coroutine overhead for a simple attribute access in a high-frequency dependency.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "43d31cd26043",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 26,
      "description": "Use of PEP 604 unions (str | None) requires Python 3.10+; this will be a SyntaxError on older interpreters.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c6ce88603903",
      "status": "resolved",
      "resolution": "runtime supports PEP 604 unions",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 27,
      "description": "Use of built-in generic types (dict[str, Any]) requires Python 3.9+; this will be a SyntaxError on Python <3.9.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "636e517377c8",
      "status": "resolved",
      "resolution": "runtime supports built-in generics",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "LOGIC_ERRORS",
      "line": 37,
      "description": "to_dict returns the internal context dict by reference, exposing mutable internal state to external mutation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e67600b721f3",
      "status": "resolved",
      "resolution": "context copy returned",
      "validation_method": "context_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 62,
      "description": "EmbeddingError forwards **kwargs along with an explicit retryable argument to super().__init__; if kwargs contains 'retryable', it will raise TypeError: multiple values for keyword argument 'retryable'.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "16b4e7c5c225",
      "status": "resolved",
      "resolution": "duplicate retryable removed",
      "validation_method": "kwargs_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 76,
      "description": "ProcessingError forwards **kwargs along with an explicit retryable argument; a 'retryable' key in kwargs will cause TypeError due to duplicate keyword.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "aacf15e354c9",
      "status": "resolved",
      "resolution": "duplicate retryable removed",
      "validation_method": "kwargs_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 92,
      "description": "ValidationError forwards **kwargs along with explicit 'field' and 'rule' arguments; if kwargs includes these keys, it will cause TypeError for multiple values.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3166839092bd",
      "status": "resolved",
      "resolution": "duplicate field/rule removed",
      "validation_method": "kwargs_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 109,
      "description": "ProviderError forwards **kwargs with explicit 'provider' and 'retryable' arguments; duplicate keys in kwargs will raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d7ddd1eddaed",
      "status": "resolved",
      "resolution": "duplicate provider/retryable removed",
      "validation_method": "kwargs_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 126,
      "description": "FileOperationError forwards **kwargs with explicit 'file_path' and 'operation' arguments; duplicate keys in kwargs will raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "90a689558604",
      "status": "resolved",
      "resolution": "duplicate file_path/operation removed",
      "validation_method": "kwargs_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 142,
      "description": "TransactionError forwards **kwargs with explicit 'transaction_id'; a duplicate key in kwargs will raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "48d08a82bb3d",
      "status": "resolved",
      "resolution": "duplicate transaction_id removed",
      "validation_method": "kwargs_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 157,
      "description": "SecurityError forwards **kwargs with explicit 'threat_type'; a duplicate key in kwargs will raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9d0ed427ece4",
      "status": "resolved",
      "resolution": "duplicate threat_type removed",
      "validation_method": "kwargs_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 176,
      "description": "LLMOutputSchemaError forwards **kwargs with explicit 'schema_name', 'raw_output', and 'repair_attempts'; duplicate keys in kwargs will raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "35729404fc2f",
      "status": "resolved",
      "resolution": "duplicate schema fields removed",
      "validation_method": "kwargs_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 199,
      "description": "RetrievalError forwards **kwargs with explicit 'query'; a duplicate key in kwargs will raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c5eb7d4e2052",
      "status": "resolved",
      "resolution": "duplicate query removed",
      "validation_method": "kwargs_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 217,
      "description": "RateLimitError forwards **kwargs with explicit 'provider', 'retry_after', and forces 'retryable=True'; if kwargs includes any of these keys (especially 'retryable'), it will raise TypeError due to duplicate keyword arguments.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6f9791c0c30f",
      "status": "resolved",
      "resolution": "duplicate provider/retry_after removed",
      "validation_method": "kwargs_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 239,
      "description": "CircuitBreakerOpenError forwards **kwargs with explicit 'provider', 'reset_at', and 'retryable=False'; duplicate keys in kwargs will raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "93a6afa17181",
      "status": "resolved",
      "resolution": "duplicate provider/reset_at removed",
      "validation_method": "kwargs_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "TYPE_ERRORS",
      "line": 261,
      "description": "PolicyViolationError forwards **kwargs with explicit 'threat_type', 'action', and 'policy_name'; duplicate keys in kwargs will raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "13b478c60b21",
      "status": "resolved",
      "resolution": "duplicate policy fields removed",
      "validation_method": "kwargs_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/common/exceptions.py",
      "category": "SECURITY",
      "line": 37,
      "description": "to_dict serializes the entire context, which may include sensitive values such as raw_output (LLMOutputSchemaError), query text (RetrievalError), and file paths (FileOperationError), increasing risk of sensitive data leakage in logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1efcc1364c5e",
      "status": "resolved",
      "resolution": "sensitive keys redacted",
      "validation_method": "redact_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "LOGIC_ERRORS",
      "line": 23,
      "description": "SearchRequest.query has no min_length; empty search queries are allowed, which is likely invalid.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "acfc7582d541",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "TYPE_ERRORS",
      "line": 34,
      "description": "SearchRequest.fusion_method is typed as Optional[str] with default 'rrf' and a description restricting values, but the type allows None and arbitrary strings without validation, enabling invalid inputs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e3c44cf4e705",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "STYLE",
      "line": null,
      "description": "Inconsistent extra-field handling: some models forbid extras (e.g., SearchRequest, AnswerRequest, DraftEmailRequest, DraftEmailResponse, SummarizeThreadRequest, SummarizeThreadResponse) while others omit this (SearchResponse line 39, ChatMessage line 136, ChatRequest line 143, ChatResponse line 157), causing unexpected keys to be silently ignored in some payloads.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8ab52b0188ab",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "LOGIC_ERRORS",
      "line": 146,
      "description": "ChatRequest.messages does not enforce a minimum number of items; an empty message list is accepted, which likely makes the request invalid.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "eeacd80e4842",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "LOGIC_ERRORS",
      "line": 140,
      "description": "ChatMessage.content lacks a minimum length; empty message content is permitted, which is likely unintended.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7f909c5ba267",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "STYLE",
      "line": 149,
      "description": "ChatRequest.max_length description says 'Max summary length in words' which is misleading in the chat context (likely copy-paste).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0545559eefa1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "LOGIC_ERRORS",
      "line": 157,
      "description": "ChatResponse does not enforce consistency between 'action' and the presence of corresponding fields (answer for 'answer', summary for 'summarize', search_results for 'search').",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "eb54b10a54d9",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "SECURITY",
      "line": 25,
      "description": "SearchRequest exposes tenant_id in the request body; if not overridden server-side, clients could spoof tenant context.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "abba79861727",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "SECURITY",
      "line": 28,
      "description": "SearchRequest exposes user_id in the request body; if not overridden server-side, clients could spoof user identity.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8f4a362081ed",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "SECURITY",
      "line": 62,
      "description": "AnswerRequest exposes tenant_id in the request body; potential spoofing risk if trusted by the server.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1871105d41aa",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "SECURITY",
      "line": 63,
      "description": "AnswerRequest exposes user_id in the request body; potential spoofing risk if trusted by the server.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2568a0858862",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "SECURITY",
      "line": 93,
      "description": "DraftEmailRequest exposes tenant_id in the request body; potential spoofing risk if trusted by the server.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ac5b19f57c7c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "SECURITY",
      "line": 94,
      "description": "DraftEmailRequest exposes user_id in the request body; potential spoofing risk if trusted by the server.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "558edd02673d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "SECURITY",
      "line": 120,
      "description": "SummarizeThreadRequest exposes tenant_id in the request body; potential spoofing risk if trusted by the server.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "54379972719e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/models.py",
      "category": "SECURITY",
      "line": 121,
      "description": "SummarizeThreadRequest exposes user_id in the request body; potential spoofing risk if trusted by the server.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "61351a22707c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_ingest.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "File ends with an incomplete statement ('aw'), causing a syntax error that prevents the module from importing and any endpoint from loading.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c1f907c56e02",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_ingest.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "push_ingest references _process_push_ingest, which is not defined or imported, leading to a NameError at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9557d942b4db",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_ingest.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "BackgroundTasks.add_task is given an async function (_process_s3_folders_with_embeddings); Starlette BackgroundTasks do not await coroutine functions, which can result in the task never actually running and 'coroutine was never awaited' warnings.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "214adfddc44f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_ingest.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "A request-scoped Redis client (injected via Depends(get_redis)) is passed into a background task and used after the response is sent; this risks using a closed connection/pool with no explicit lifecycle management or reinitialization.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d87a2e4709bc",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_ingest.py",
      "category": "SECURITY",
      "line": null,
      "description": "tenant_id_ctx.get() is used without validation; if it returns None (or an unexpected value), job keys are created under 'tenant:None:...' which can cause cross-tenant collisions and potential data exposure between tenants.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "254c553f37a2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_ingest.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "In _process_s3_folders_with_embeddings, when the job key is missing in Redis, the function logs an error and returns without updating the job status, leaving the job in a non-terminal state ('started') with no failure indicator.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f18cb8c70709",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_ingest.py",
      "category": "STYLE",
      "line": null,
      "description": "current_user is injected but never used in the endpoints, leaving unused variables and unclear authorization/business logic linkage.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "014851415997",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_ingest.py",
      "category": "SECURITY",
      "line": null,
      "description": "The tenant context (tenant_id_ctx) is set in the background task without using a token/reset; this risks leaking tenant context to other tasks/calls in the same worker via contextvars.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "69c3cd593a8d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_ingest.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "In _process_s3_folders_with_embeddings, the code assumes the result of processor.process_batch has attributes like folders_processed, threads_created, chunks_created, embeddings_generated, errors, skipped; if the processor returns a dict or incompatible type, this will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ea421f1134e8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "get_summarize_graph checks only for the presence of app.state.graphs using hasattr, then unconditionally calls .get on it; if the attribute exists but is None or not a dict-like object, this will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "dc4cda9b2ab6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "_handle_search builds 'snippets' using results.results[:5] without guarding against results.results being None, which can raise a TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5b713579a0d2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "_run_search constructs KBSearchInput with tenant_id_ctx.get() and user_id_ctx.get(); if these context values are None but KBSearchInput expects non-optional strings, this can cause validation/type errors at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f3658265eae7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "_run_search receives request.k directly; if request.k is None but KBSearchInput.k expects an int, this may fail validation or cause downstream errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c09e7fdb34b1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "_handle_summarize passes request.max_length (possibly None) into the summarize graph initial_state; if the graph expects an int, this can cause runtime errors inside the graph execution.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e3f8a81bfe01",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "chat_endpoint catches all Exceptions and re-raises an HTTPException with detail=str(exc), potentially masking original error types and losing stack context.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ba2ac0b1c5e8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "SECURITY",
      "line": null,
      "description": "chat_endpoint returns str(exc) in HTTP 500 responses, which can leak internal error details to clients.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "73fbe7479246",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "SECURITY",
      "line": null,
      "description": "_handle_search includes raw search result 'highlights' directly in the LLM prompt without sanitization or delimiting, exposing the system to prompt injection via retrieved content.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "96cfdc0945d2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "SECURITY",
      "line": null,
      "description": "_decide_action and the non-thread summarize path send full conversation history to the LLM without sanitizing prior messages, allowing adversarial instructions in earlier turns to influence routing/summarization (prompt injection risk).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ec457790f50d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_handle_summarize assumes final_state['summary'] has attribute 'summary_markdown'; if 'summary' is present but of an unexpected type, an AttributeError will occur and is not handled locally.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "43178a6c4eea",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "STYLE",
      "line": null,
      "description": "Unused imports: build_summarize_graph and QueryClassificationInput are imported but never used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f7cc7a54d43e",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "STYLE",
      "line": null,
      "description": "The 'current_user' dependency is injected but the variable is not used within chat_endpoint, resulting in an unused parameter.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4e4e06144d41",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "SECURITY",
      "line": null,
      "description": "When request.debug is true, debug_info includes the LLM's routing reason, which may reveal internal decision rationale to end users without checking trust level.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a508e8ac49a5",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_chat.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "_log_chat_audit uses tenant_id_ctx.get() and user_id_ctx.get() without verifying non-None values; passing None into audit logging may break downstream logging or produce ambiguous audit records.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8a421f54d2cf",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_summarize.py",
      "category": "PERFORMANCE",
      "line": 43,
      "description": "Graph compilation is performed synchronously inside the request path and can block the event loop if compile() is CPU-bound, causing latency spikes under load.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6ad34ff347cd",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_summarize.py",
      "category": "NULL_SAFETY",
      "line": 70,
      "description": "final_state is assumed to be a dict; calling final_state.get(...) will raise if ainvoke() returns None or a non-mapping, leading to AttributeError/TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "15548189abbc",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_summarize.py",
      "category": "NULL_SAFETY",
      "line": 75,
      "description": "Access to final_state.get('summary') assumes a mapping; missing validation of final_state shape risks runtime errors if ainvoke() returns unexpected types.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "936d2180eee8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_summarize.py",
      "category": "TYPE_ERRORS",
      "line": 93,
      "description": "SummarizeThreadResponse is constructed with correlation_id potentially None; if the response model requires a non-optional string, this can trigger a validation error at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "20ae4128da2c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_summarize.py",
      "category": "SECURITY",
      "line": 60,
      "description": "No explicit authorization/ownership check for request.thread_id; relies on downstream logic, which can lead to broken access control if not enforced elsewhere.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0e98bfbec3cb",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_summarize.py",
      "category": "SECURITY",
      "line": 72,
      "description": "Logs full error content from the graph (final_state['error']) which may include sensitive data; comment indicates sanitation is pending but not implemented.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c0cdea3e61ad",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_summarize.py",
      "category": "EXCEPTION_HANDLING",
      "line": 90,
      "description": "Audit logging failures are caught with a broad except and only logged, effectively swallowing errors that might be compliance-critical without surfacing them to callers or metrics.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "88e825e98ef9",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_summarize.py",
      "category": "NULL_SAFETY",
      "line": 58,
      "description": "tenant_id_ctx.get() and user_id_ctx.get() are used without validation; None values may propagate into the workflow or audit logger, risking downstream failures or incomplete auditing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2434ebbf3006",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_summarize.py",
      "category": "NULL_SAFETY",
      "line": 82,
      "description": "Audit call uses tenant_id and user_or_agent from context without checking for None, which may cause internal errors or incomplete audit records depending on implementation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "aef8982b22e7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_summarize.py",
      "category": "LOGIC_ERRORS",
      "line": 76,
      "description": "Condition `if not summary:` treats empty strings or falsy-but-valid summaries as errors; may incorrectly flag legitimate outputs as failures.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c4c403f22667",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_summarize.py",
      "category": "STYLE",
      "line": 15,
      "description": "Leftover TODO-style comments (e.g., 'P2 Fix') and placeholder comments ('... (docstring same)') reduce code clarity and indicate unfinished work.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "378a47783392",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_summarize.py",
      "category": "SECURITY",
      "line": 77,
      "description": "Different error messages ('No summary generated' vs generic 500) may disclose internal workflow states to clients, providing minor information leakage.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "02c78cdfa8e1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_draft.py",
      "category": "SECURITY",
      "line": 123,
      "description": "Generic exception handler returns str(e) to clients, potentially leaking internal error details.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b5d71b132428",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_draft.py",
      "category": "TYPE_ERRORS",
      "line": 112,
      "description": "correlation_id may be None; if DraftEmailResponse expects a non-null string, FastAPI/Pydantic response validation can fail.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "458fc172a855",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_draft.py",
      "category": "NULL_SAFETY",
      "line": 82,
      "description": "Assumes final_state is a mapping; if graph.ainvoke returns None or a non-mapping, final_state.get(...) will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "337068474e28",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_draft.py",
      "category": "EXCEPTION_HANDLING",
      "line": 31,
      "description": "get_draft_graph only handles AttributeError/KeyError; accessing graphs[\"draft\"] when graphs is an unexpected type (e.g., None or non-mapping) can raise unhandled TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "271fafa9a008",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_draft.py",
      "category": "TYPE_ERRORS",
      "line": 83,
      "description": "HTTPException detail uses final_state[\"error\"] which may be a non-serializable object (e.g., an Exception), causing response serialization issues.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ff98875ae1a3",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_draft.py",
      "category": "EXCEPTION_HANDLING",
      "line": 108,
      "description": "Audit logging wraps all exceptions in a broad except and only logs a simple error message, swallowing failures without traceback and potentially hiding critical audit failures.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f1fa32399ea4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_draft.py",
      "category": "NULL_SAFETY",
      "line": 62,
      "description": "tenant_id_ctx.get() and user_id_ctx.get() may return None; these values flow into initial_state and audit logging, risking downstream None-related errors or misattribution.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e0ddb83c5b47",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_draft.py",
      "category": "LOGIC_ERRORS",
      "line": 87,
      "description": "The check 'if not draft' treats empty strings as errors, which may incorrectly flag a valid but empty draft as a failure.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d3856ea89fbb",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "category": "NULL_SAFETY",
      "line": 92,
      "description": "results is not checked for None before accessing results.results; if result_wrapper.unwrap() returns None, this will raise AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3adf555fd2a1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "category": "NULL_SAFETY",
      "line": 81,
      "description": "request.query is used unguarded with .encode(); if the model allows query to be None, this will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4fc2bab0e2eb",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "category": "TYPE_ERRORS",
      "line": 45,
      "description": "KBSearchInput is constructed with tenant_id_ctx.get() and user_id_ctx.get() (lines 46\u201347) which may return None; if KBSearchInput expects non-optional strings, this can cause type/validation errors at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1a1417657295",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "category": "NULL_SAFETY",
      "line": 73,
      "description": "log_audit_event is called with tenant_id and user_id potentially being None (lines 73\u201374), which may violate expected types for the audit system or produce misleading audit entries.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a002cd1433e4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "category": "EXCEPTION_HANDLING",
      "line": 58,
      "description": "Converts the underlying tool error to a generic CortexError using only str(result_wrapper.unwrap_err()), losing original error details and structure; combined with mapping all CortexError to a 400 response (lines 102\u2013103), this may misclassify server-side failures as client errors and reduce observability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "65b2d91ef7c1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "category": "PERFORMANCE",
      "line": 49,
      "description": "No bounds checking or throttling on request.k; large values can trigger expensive retrieval operations and degrade performance or enable DoS-like behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "119f8ec044e7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "category": "TYPE_ERRORS",
      "line": 96,
      "description": "correlation_id is passed through directly and may be None; if SearchResponse.correlation_id is not Optional in the schema, this violates the response_model contract.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "78e4b5d331c4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_search.py",
      "category": "STYLE",
      "line": 70,
      "description": "Inconsistent None checks for results: res_count is computed defensively (line 70), but later code (line 92) assumes results is non-None, reducing readability and increasing risk of errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cb5f6c8d6fb5",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_answer.py",
      "category": "STYLE",
      "line": 12,
      "description": "Unused import: Optional is imported but never referenced.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7ae5cdb46dba",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_answer.py",
      "category": "NULL_SAFETY",
      "line": 31,
      "description": "Assumes request.app.state.graphs exists and is a mapping; if 'state' or 'graphs' is missing or not a dict, AttributeError will be raised before the explicit HTTPException.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "838a01c30a9c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_answer.py",
      "category": "TYPE_ERRORS",
      "line": 43,
      "description": "Parameter annotated as StateGraph but later used with .ainvoke; depending on langgraph version, StateGraph may not implement ainvoke, creating a type mismatch and potential runtime error.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6c1c7fffcc20",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_answer.py",
      "category": "TYPE_ERRORS",
      "line": 67,
      "description": "Assumes final_state is a mapping (uses .get); if graph.ainvoke returns None or a non-mapping type, AttributeError will occur.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6a6faa4842fd",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_answer.py",
      "category": "SECURITY",
      "line": 68,
      "description": "Logs internal error details from the graph (final_state['error']), which may leak sensitive information into logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d26996b185fa",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_answer.py",
      "category": "EXCEPTION_HANDLING",
      "line": 96,
      "description": "Audit logging exceptions are caught and only logged, effectively swallowing failures and allowing the request to proceed without an audit trail.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "39ca67036895",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_answer.py",
      "category": "SECURITY",
      "line": 26,
      "description": "Debug gating relies solely on an environment variable (ENVIRONMENT == 'dev') evaluated at import time; misconfiguration could expose debug behavior in production.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b3d332f7c09d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_answer.py",
      "category": "SECURITY",
      "line": 108,
      "description": "When debug is enabled (in dev), the API returns retrieval_results and classification in the response, which may include sensitive data.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6cdbcf518389",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_answer.py",
      "category": "TYPE_ERRORS",
      "line": 110,
      "description": "retrieval_results is passed through to the response without ensuring JSON-serializability; non-serializable objects could cause response serialization errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "49a5eb6d9f40",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_answer.py",
      "category": "EXCEPTION_HANDLING",
      "line": 120,
      "description": "A broad except Exception converts any error into a generic 500 HTTPException, potentially obscuring meaningful error types (e.g., validation errors) and losing specific context.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0a3bcdb900ee",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_answer.py",
      "category": "NULL_SAFETY",
      "line": 51,
      "description": "tenant_id_ctx.get() and user_id_ctx.get() are used without checking for None; missing context values may cause downstream errors in the graph or audit logging.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "36053bc69ac7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_answer.py",
      "category": "NULL_SAFETY",
      "line": 46,
      "description": "request.query is assumed to be a non-null string; if None slips through model validation, .encode() will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7a330208871a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/rag_api/routes_answer.py",
      "category": "TYPE_ERRORS",
      "line": 117,
      "description": "debug_info is constructed as a plain dict; if AnswerResponse enforces a specific schema/type for debug_info, this may fail model validation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2a5cb613d16e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/utils/__init__.py",
      "category": "TYPE_ERRORS",
      "line": 66,
      "description": "scrub_json applies strip_control_chars to dictionary keys without ensuring they are strings; non-str keys (e.g., int, bytes) will cause TypeError in the regex substitution.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "20fd68362490",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/utils/__init__.py",
      "category": "LOGIC_ERRORS",
      "line": 65,
      "description": "scrub_json silently drops entries where the dict key is None (via `if k is not None`), which can lead to unexpected data loss and is not documented.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "90de40dfcc9a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/utils/__init__.py",
      "category": "LOGIC_ERRORS",
      "line": 65,
      "description": "Sanitizing dict keys can create collisions (e.g., 'a' and 'a\\x00' both become 'a'), causing later entries to overwrite earlier ones without warning.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "48d2c5b74a2d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/utils/__init__.py",
      "category": "EXCEPTION_HANDLING",
      "line": 51,
      "description": "read_text_file catches UnicodeDecodeError and returns an empty string, which swallows the error and makes it indistinguishable from an actually empty file.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0c59c02f19c7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/utils/__init__.py",
      "category": "PERFORMANCE",
      "line": 57,
      "description": "scrub_json is fully recursive with no depth checks; extremely deep or adversarially nested inputs can trigger a RecursionError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "94bae2961b6d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/utils/atomic_io.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "Path validation explicitly allows the resolved target path to equal the base directory (resolved_path == resolved_base). This permits attempting to write to the directory itself, causing guaranteed failures during os.replace and may trigger unintended operations on the base's parent directory.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "50390ed73809",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/utils/atomic_io.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "In the broad except block, the cleanup call temp_path.unlink(missing_ok=True) is not wrapped; if it raises (e.g., PermissionError on Windows), it can mask the original exception, obscuring the true failure cause.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6287374dd1ba",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/utils/atomic_io.py",
      "category": "SECURITY",
      "line": null,
      "description": "There is a TOCTOU window between path validation and use (mkdir, os.replace, and directory fsync). An attacker who can mutate symlinks or directory entries within the base between validation and use may redirect operations despite the initial resolved path check.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8fefeeebb98c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/utils/atomic_io.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "Opening and fsyncing a directory (fd = os.open(parent, os.O_RDONLY); os.fsync(fd)) is not portable and can raise on some platforms/filesystems (notably Windows), leading to unexpected OSError because these platform-specific errors are not handled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f1cb077e2301",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "_chunk_text can enter an infinite loop at the tail: when end == len(text), start is set to end - overlap (unchanged on the next iteration), causing the last overlapping slice to repeat forever.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b352583fe033",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "_chunk_text does not validate that overlap < chunk_size; if overlap >= chunk_size, start may move backwards or stay the same, causing incorrect chunking or infinite loops.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4e45b0629152",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "_merge_graphs loses node attributes when coalescing to canonical names: attributes from non-canonical variants mapped to the canonical name are not merged into the canonical node.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "91605e0977f6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "_merge_graphs silently ignores relation conflicts on duplicate edges; when an edge already exists, only the description is merged, and differing relation values are discarded without detection.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "57d332180d8a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "The deduplication strategy contradicts documented behavior (e.g., dedup \"Alice\" and \"Alice Smith\"): implementation only merges exact case-insensitive matches, not longer/shorter name variants, leading to missed coalescing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "17d0e6ac568d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "Exceptions raised inside _merge_graphs (executed via run_in_executor) are not caught in extract_graph, potentially bubbling up and failing the entire extraction without graceful degradation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9c75a5c4787a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_process_chunk and _parse_json_to_graph catch broad Exception and return empty/partial graphs, which can mask programming errors and hinder debugging/observability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6d9522ec42f1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "_parse_json_to_graph assumes node['name'], edge['source'], edge['target'] are present and strings (uses .strip()); malformed or unexpected types will raise KeyError/AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cfa99d272919",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "_normalize_relation assumes relation is a string (uses .strip()); if edge['relation'] is None or non-string, it will raise at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cacd6660863f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "logger.info uses f-string interpolation, incurring formatting cost even when the log level disables INFO; using lazy logging would avoid unnecessary string formatting.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2dfb2915b6f4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph.py",
      "category": "STYLE",
      "line": null,
      "description": "Unused imports/constants: collections.defaultdict, DEFAULT_CHUNK_SIZE, DEFAULT_OVERLAP are defined/imported but never used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a212c1c673d5",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph.py",
      "category": "STYLE",
      "line": null,
      "description": "Magic numbers: __init__ hardcodes chunk_size=8000 and overlap=500 instead of using the declared module-level constants, creating duplication and potential drift.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a11df5481c92",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph.py",
      "category": "STYLE",
      "line": null,
      "description": "Comment inconsistency: header mentions 'No System Prompt' but a system prompt is actually used; also claims 'fuzzy node matching' though only case-insensitive exact matching is implemented.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2436424c40cc",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph_discovery.py",
      "category": "PERFORMANCE",
      "line": 41,
      "description": "Using ORDER BY func.random() to sample conversations can be extremely expensive on large tables due to full-table sorting; likely to cause poor performance at scale.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "54292ff03b04",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph_discovery.py",
      "category": "PERFORMANCE",
      "line": 51,
      "description": "Potential N+1 query pattern: after selecting conversation IDs, a separate query is executed per conversation to fetch chunks, which can be inefficient for larger sample sizes.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "74a05b6410ed",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph_discovery.py",
      "category": "PERFORMANCE",
      "line": 54,
      "description": "Selecting Chunk.chunk_id even though it is not used adds unnecessary data transfer and processing overhead.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9b3cfdd80125",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph_discovery.py",
      "category": "LOGIC_ERRORS",
      "line": 57,
      "description": "Filtering by Chunk.position == 0 assumes position is relative to each file/section; if position is global per conversation, this may incorrectly restrict to only the very first chunk, contradicting the comment and biasing the sample.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0199ca48c698",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph_discovery.py",
      "category": "EXCEPTION_HANDLING",
      "line": 142,
      "description": "Calling asyncio.run inside a function without checking for an existing running event loop can raise RuntimeError in async contexts; this is not handled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "894bc68a0080",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph_discovery.py",
      "category": "EXCEPTION_HANDLING",
      "line": 99,
      "description": "Catching broad Exception in _process_with_sem and returning empty results swallows errors and only logs a message without traceback, obscuring root causes and silently degrading output quality.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "eacd43d8cac8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph_discovery.py",
      "category": "PERFORMANCE",
      "line": 102,
      "description": "Forcing gc.collect() in the finally block of every task can significantly degrade performance and is generally unnecessary, especially inside tight loops.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "71d5088bc97d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph_discovery.py",
      "category": "SECURITY",
      "line": 35,
      "description": "Printing potentially sensitive identifiers and data (tenant_id and sampled entity names) to console/logs may expose PII or confidential information; occurrences include the tenant ID in the fetch message and entity names in the final report.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b8637d9b29ea",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph_discovery.py",
      "category": "PERFORMANCE",
      "line": 74,
      "description": "Accumulating all entity names in a list before sampling can grow memory usage unnecessarily if many graphs produce large numbers of nodes.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f2bd1b0cf151",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph_discovery.py",
      "category": "STYLE",
      "line": 65,
      "description": "Magic numbers are used without named constants or configuration: 4000-character truncation, semaphore size of 5 (line 80), and sampling 10 entities (line 133), reducing clarity and configurability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6628b7b0cc68",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/graph_discovery.py",
      "category": "STYLE",
      "line": 30,
      "description": "Direct console printing within a library function mixes concerns and limits reuse in non-CLI contexts; no option to inject a logger or disable output.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b8b6fe412bb8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/summarizer.py",
      "category": "STYLE",
      "line": 15,
      "description": "CHARS_PER_TOKEN_ESTIMATE is defined but never used (dead constant).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8978a0f3699e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/summarizer.py",
      "category": "STYLE",
      "line": 41,
      "description": "Magic number 4 used for chars-per-token estimate despite having a named constant; leads to duplication and maintainability issues.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a8e820731f6a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/summarizer.py",
      "category": "LOGIC_ERRORS",
      "line": 41,
      "description": "Context truncation does not account for tokens consumed by the prompt itself, so the final prompt may still exceed the intended context window.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "af3d01b54d70",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/summarizer.py",
      "category": "EXCEPTION_HANDLING",
      "line": 64,
      "description": "Overly broad exception catch (except Exception) in generate_summary swallows all errors and may hide programming or system issues.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2737502d20d3",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/summarizer.py",
      "category": "EXCEPTION_HANDLING",
      "line": 78,
      "description": "Overly broad exception catch (except Exception) in embed_summary swallows all errors and may hide programming or system issues.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "99675c5568b4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/summarizer.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "Errors are logged without stack traces (no exc_info), reducing diagnosability (occurs at logger.error in generate_summary and embed_summary).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "247cb3399025",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/summarizer.py",
      "category": "PERFORMANCE",
      "line": 65,
      "description": "Using an f-string in logger.error causes eager string formatting even when the log level might suppress the message, incurring unnecessary overhead.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "28de0f10fcaa",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/summarizer.py",
      "category": "STYLE",
      "line": null,
      "description": "Inconsistent logging style: generate_summary uses f-string interpolation while embed_summary uses parameterized logging.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c9fb82cb59ef",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/intelligence/summarizer.py",
      "category": "LOGIC_ERRORS",
      "line": 68,
      "description": "embed_summary returns an empty list both for empty input and when an embedding error occurs, conflating 'no data' with 'failure' and making it hard for callers to distinguish cases.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "18bf8bbb44e8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/states.py",
      "category": "STYLE",
      "line": 10,
      "description": "Unused import: Optional is imported but never used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9366ae3f9fa0",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/states.py",
      "category": "STYLE",
      "line": 30,
      "description": "Attribute '_graph_type' is annotated as a normal field; in pydantic it will be included in model fields, dumps, and __repr__, which is likely unintended for internal metadata.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f0a3e1e6ebd5",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/states.py",
      "category": "SECURITY",
      "line": 35,
      "description": "Custom __repr__ only redacts top-level Redacted and SecretStr values; nested containers (e.g., lists of secrets) or domain model objects (Answer, EmailDraft, FactsLedger, SearchResults) may include sensitive content in logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "797657dd4fca",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/states.py",
      "category": "STYLE",
      "line": 4,
      "description": "Top-level docstring references \u00a710.1, while the module implements \u00a710.3 and \u00a710.4, indicating documentation drift/inconsistency.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8074a7437b1a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/states.py",
      "category": "TYPE_ERRORS",
      "line": 95,
      "description": "DraftEmailState.thread_id is typed as str | None while the docstring indicates Optional[UUID]; no validation ensures a UUID format.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5f333ca49e0f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/states.py",
      "category": "TYPE_ERRORS",
      "line": 119,
      "description": "SummarizeThreadState.thread_id is typed as str despite comment indicating a UUID string; lacks UUID validation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "dc0af5200cbd",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/states.py",
      "category": "TYPE_ERRORS",
      "line": 66,
      "description": "AnswerQuestionState.k has no constraints; zero or negative values are permitted and may cause downstream logic issues.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "091716cc1a48",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/states.py",
      "category": "TYPE_ERRORS",
      "line": 120,
      "description": "SummarizeThreadState.max_length has no bounds or validation; negative or excessively large values are allowed.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "96ef7a05b239",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/states.py",
      "category": "STYLE",
      "line": 66,
      "description": "Field name 'k' is a non-descriptive single-letter identifier, reducing readability of the public state API.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b806b45fcfad",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/states.py",
      "category": "TYPE_ERRORS",
      "line": 38,
      "description": "__repr__ relies on BaseModel iteration yielding (field_name, value); this is framework-specific and may be brittle across pydantic versions.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4f05dd90a66f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/__init__.py",
      "category": "PERFORMANCE",
      "line": 5,
      "description": "Eagerly importing submodules and many symbols at package import time can increase import latency and memory usage for any consumer that only needs a subset of functionality.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4c34168f40ce",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/__init__.py",
      "category": "PERFORMANCE",
      "line": 13,
      "description": "Bulk importing many node-level symbols in __init__ prevents lazy loading and may pull in heavy dependencies or trigger side effects during import.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0c0b55ac09b8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/__init__.py",
      "category": "PERFORMANCE",
      "line": 34,
      "description": "Importing state classes at package import time contributes to non-lazy loading; consider that consumers may not need all states on every import.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a6633a3b3e08",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/__init__.py",
      "category": "LOGIC_ERRORS",
      "line": 5,
      "description": "Potential circular import risk: importing graphs/nodes/states from __init__ can create cycles if those modules import from the package namespace, leading to partially initialized modules at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "55e707b4f5be",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/__init__.py",
      "category": "STYLE",
      "line": 11,
      "description": "Commenting is unclear/contradictory (two short comments chained across lines 11\u201312) which reduces readability and maintainability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6760e5977f0b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/__init__.py",
      "category": "STYLE",
      "line": 40,
      "description": "Very broad re-export via __all__ creates a large public API surface, making internal implementation details (nodes/tools) part of the stable API and increasing coupling for downstream users.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "acfdde23ebab",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/redacted.py",
      "category": "SECURITY",
      "line": null,
      "description": "Redacted is a plain str subclass with no overridden __str__/__repr__/serialization; its raw value will be emitted in logs, JSON, and exceptions by default, risking leakage of sensitive data unless every usage context applies external redaction.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "76bb8cfeaa7c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/redacted.py",
      "category": "STYLE",
      "line": null,
      "description": "The class name and docstring imply enforced redaction but the implementation is empty and relies on an external GraphState __repr__, creating brittle cross-module coupling and a misleading contract for consumers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7b4dca95cff6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/graphs.py",
      "category": "STYLE",
      "line": 10,
      "description": "Unused imports: Optional, Protocol.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4ca039b083e7",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/graphs.py",
      "category": "STYLE",
      "line": 38,
      "description": "Unused logger variable; the logging import is effectively unused since 'logger' is never referenced.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e1d91dbeb0c3",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/graphs.py",
      "category": "TYPE_ERRORS",
      "line": 41,
      "description": "_check_error assumes 'state' is a dict and calls state.get('error'), but elsewhere the graph uses typed state objects; if 'state' is not mapping-like, this will raise AttributeError at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2ccbf9e37972",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/graphs.py",
      "category": "TYPE_ERRORS",
      "line": 48,
      "description": "_route_by_classification assumes attribute-style access (state.error, state.classification.type); if the runtime state is dict-based, this will fail, indicating inconsistent state access patterns within the module.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3e36d9f73d26",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/graphs.py",
      "category": "LOGIC_ERRORS",
      "line": 212,
      "description": "Conditional edges for 'critique' only define routes for 'improve' and 'audit', but should_improve can return 'handle_error'; missing mapping can cause an unroutable transition at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5966f22dd1d9",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/graphs.py",
      "category": "TYPE_ERRORS",
      "line": 129,
      "description": "should_improve compares iteration_count to MAX_ITERATIONS without guarding against None or non-int values; if iteration_count is unset, this can raise a TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3f58a336ccb2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/graphs.py",
      "category": "LOGIC_ERRORS",
      "line": 121,
      "description": "The improvement loop's termination depends on external mutation of iteration_count by nodes; if iteration_count is not incremented, the graph may loop indefinitely when issues remain major.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5aab62174e98",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/graphs.py",
      "category": "LOGIC_ERRORS",
      "line": 270,
      "description": "Summarize graph always routes from 'critic' to 'improver' despite the comment marking improver as optional; there is no conditional path to skip the improver step.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2f236d4b98f5",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "Invalid syntax: stray identifier 'cc_add' inside tool_email_get_thread causes a SyntaxError, making the module unparsable.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "10772773fb4b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "STYLE",
      "line": null,
      "description": "tool_email_get_thread is truncated/incomplete (no construction of ThreadContext and no final return), indicating dead/incomplete code.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "41a89ab1bd02",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_select_attachments_from_mentions and _select_all_available_attachments use bare 'except Exception: continue' without logging or cleanup, silently swallowing errors and obscuring failures.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ba665a0d1fc9",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_safe_stat_mb catches all exceptions and returns 0.0 without logging, potentially masking file system errors and leading to incorrect size decisions.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e8212ac092d2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "_complete_with_guardrails accesses message dictionaries with m[\"role\"] and m[\"content\"] directly; missing key checks can raise KeyError if messages lack expected fields.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "aeeeb7fab96b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "Attachment size limit compares file size in MB against cfg.limits.max_attachment_text_chars divided by 1,048,576; this mixes bytes/MB with character count, leading to incorrect filtering thresholds.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "66434622aaa7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "Allowed file pattern checks use Path.match(pattern) on absolute paths; Path.match semantics can differ from expected allowlist behavior and may cause false negatives/positives depending on pattern anchoring.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "99fb4d3c3d87",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "extract_document_mentions claims to handle quoted filenames like 'report.pdf', but the quoted regex excludes dots and therefore will not capture filenames with extensions, conflicting with the documented behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "817c5f1f3bb7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "tool_email_get_thread imports SQLAlchemyError but does not handle database exceptions; DB errors will propagate and are not logged.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2d249fc76777",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "SECURITY",
      "line": null,
      "description": "_complete_with_guardrails concatenates raw system and user content into a single prompt for complete_json without any injection validation/sanitization, increasing exposure to prompt injection risks.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f984c5c53e98",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "_safe_stat_mb performs two filesystem operations per file (exists then stat), adding overhead inside loops that scan many files.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e62477632d04",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "STYLE",
      "line": null,
      "description": "Brittle/unused branch in _extract_patterns that relies on pattern.pattern.startswith('[\"\\']'); current callers do not pass such a pattern, making this check dead or misleading.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9503f6bb2f25",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "STYLE",
      "line": null,
      "description": "Multiple unused imports in the shown code (e.g., get_logger, complete_messages, complete_text, EmailOpsConfig, FactsLedger, CriticReview, SearchResults, sanitize_user_input, validate_for_injection, sanitize_retrieved_content, func, or_, select, aliased, SQLAlchemyError).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "293c3c9b2d93",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/orchestration/nodes.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "tool_email_get_thread assumes conversation.participants and conversation.messages are iterable collections of dicts; missing validation may lead to TypeError/KeyError if the JSONB shape is unexpected.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2b0f072d0687",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "LOGIC_ERRORS",
      "line": 427,
      "description": "Dangling 'if graph_boost_conv_ids:' with no body; the function is truncated, leading to a SyntaxError and preventing module import.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2c4754d2859a",
      "status": "resolved",
      "resolution": "graph boost block completed",
      "validation_method": "syntax_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "EXCEPTION_HANDLING",
      "line": 286,
      "description": "Top-level 'try:' block in tool_kb_search_hybrid has no matching except/finally and the function contains no return of Result[SearchResults, RetrievalError]; overall flow is incomplete and errors will not be wrapped as intended.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f8718d639b1d",
      "status": "resolved",
      "resolution": "try/except and Result return present",
      "validation_method": "flow_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "LOGIC_ERRORS",
      "line": 275,
      "description": "Docstring enumerates steps (recency boost, rerank, MMR, quoted history down-weighting) that are not implemented/invoked in the function body, causing behavioral mismatch with documented design.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7eb823fa18bf",
      "status": "resolved",
      "resolution": "documented steps implemented",
      "validation_method": "doc_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "LOGIC_ERRORS",
      "line": 416,
      "description": "RRF fusion is invoked with a hard-coded k=RRF_K_DEFAULT, ignoring any configuration-based hyperparameter, which may be unintended and reduces configurability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6d0512e7e03f",
      "status": "resolved",
      "resolution": "rrf_k configurable",
      "validation_method": "config_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "LOGIC_ERRORS",
      "line": 419,
      "description": "After applying summary boost to item scores, results are not re-sorted; list order may no longer reflect updated scores.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1da5359a73c0",
      "status": "resolved",
      "resolution": "re-sort after summary boost",
      "validation_method": "sort_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "NULL_SAFETY",
      "line": 115,
      "description": "Accessing item.metadata.get('content_hash') assumes metadata is a dict; if metadata is None, this will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8ee75223b78f",
      "status": "resolved",
      "resolution": "metadata null-guard added",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "NULL_SAFETY",
      "line": 137,
      "description": "Accessing item.metadata.get('chunk_type') assumes metadata is a dict; if metadata is None, this will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "007d793189a2",
      "status": "resolved",
      "resolution": "metadata null-guard added",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "NULL_SAFETY",
      "line": 139,
      "description": "Multiplying item.score by a factor assumes score is numeric; if score is None, this will raise a TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "50a5330b6fbe",
      "status": "resolved",
      "resolution": "score normalized before math",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "NULL_SAFETY",
      "line": 179,
      "description": "Calling into.metadata.update(...) assumes into.metadata is a dict; if it is None, this will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "62dee3ec92aa",
      "status": "resolved",
      "resolution": "metadata defaulted before update",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "NULL_SAFETY",
      "line": 121,
      "description": "Comparing item.score > existing.score in deduplication assumes both scores are numeric; if either is None, this will raise a TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ef2b1db90559",
      "status": "resolved",
      "resolution": "score normalized before compare",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "NULL_SAFETY",
      "line": 98,
      "description": "In apply_recency_boost, item.score is used in arithmetic; if score is None, this will raise a TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8a0f1414a5ec",
      "status": "resolved",
      "resolution": "recency boost uses safe score",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "STYLE",
      "line": 15,
      "description": "Unused imports: Err, Ok are imported but not referenced anywhere in the file.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7264319d8509",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "STYLE",
      "line": 27,
      "description": "Unused imports: apply_mmr, call_external_reranker, rerank_results are imported but not used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3731b81312ec",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "STYLE",
      "line": 351,
      "description": "Stray comment '# P1 Fix' left in production code; appears again at line ~371.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8718d638d4ff",
      "status": "resolved",
      "resolution": "stray comments removed",
      "validation_method": "style_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "SECURITY",
      "line": 329,
      "description": "Logging the full set of conversation IDs at info level may expose potentially sensitive identifiers in logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "29419592b5cd",
      "status": "resolved",
      "resolution": "summary boost log sanitized",
      "validation_method": "log_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "SECURITY",
      "line": 398,
      "description": "Logging raw error details from graph retrieval (graph_result.err()) at warning level may leak internal error information in logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7d4ed1df729e",
      "status": "resolved",
      "resolution": "graph error log sanitized",
      "validation_method": "log_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "TYPE_ERRORS",
      "line": 65,
      "description": "KBSearchInput uses 'QueryClassification | None' which relies on Python 3.10+ union syntax and Pydantic version compatibility; with Pydantic v1 this may not be evaluated as expected.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1a7c3ad9d8b6",
      "status": "resolved",
      "resolution": "runtime supports PEP 604 unions",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/hybrid_search.py",
      "category": "TYPE_ERRORS",
      "line": 392,
      "description": "graph_boost_conv_ids is annotated as set[str] but is populated from g.conversation_id; if any conversation_id is None, this becomes a set[Optional[str]], violating the declared type.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5d0837613b3f",
      "status": "resolved",
      "resolution": "filtered None conversation IDs",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_search.py",
      "category": "LOGIC_ERRORS",
      "line": 54,
      "description": "Mutates the caller-provided conversation_ids list in place via .extend(), causing unexpected side effects outside the function.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3a861a3ad7d7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_search.py",
      "category": "STYLE",
      "line": 56,
      "description": "Deduplication via set() discards ordering, yielding non-deterministic order of conversation_ids which can hinder reproducibility and debugging.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "09ae7a5156e3",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_search.py",
      "category": "NULL_SAFETY",
      "line": 44,
      "description": "Unprotected attribute access config.embedding.output_dimensionality may raise AttributeError if embedding config is missing or None.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ec2f01310d29",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_search.py",
      "category": "NULL_SAFETY",
      "line": 58,
      "description": "Accessing config.qdrant.enabled without verifying the existence of 'enabled' risks AttributeError when qdrant is present but lacks this attribute.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f5ed87a7d90b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_search.py",
      "category": "TYPE_ERRORS",
      "line": 65,
      "description": "No validation that 'embedding' is non-empty and matches the configured output_dim; downstream store.search may fail or misbehave with wrong-sized vectors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4e2bf3ea8afe",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_search.py",
      "category": "LOGIC_ERRORS",
      "line": 46,
      "description": "Coalescing limit <= 0 to 50 may violate caller intent (e.g., limit=0 to fetch no results) and alter expected behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "88122759fe77",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_search.py",
      "category": "PERFORMANCE",
      "line": 58,
      "description": "Instantiates a new vector store on every call; if construction is heavy (e.g., establishing connections), this can be inefficient without caching/reuse.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ddd4d8780e14",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_search.py",
      "category": "STYLE",
      "line": 21,
      "description": "Defined logger is unused in the module, indicating dead code or missing instrumentation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "779dbc9c4b51",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_search.py",
      "category": "STYLE",
      "line": 25,
      "description": "Function API requires a Session even when Qdrant is enabled and the session is unused; this can be misleading for callers and complicates testing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "322f7976efc8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "Raw SQL uses 'node_id NOT IN :existing_ids' with a tuple/list bind; SQLAlchemy text() will not expand this correctly, likely causing SQL errors or ineffective filtering.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c558af4546e0",
      "status": "resolved",
      "resolution": "ORM excludes existing IDs",
      "validation_method": "orm_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "Raw SQL uses 'source_id = ANY(:entity_ids) OR target_id = ANY(:entity_ids)' with a Python list of UUIDs; without explicit array typing this can raise Postgres operator/type errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3eb61b6cf5e0",
      "status": "resolved",
      "resolution": "ORM IN filter used for entity IDs",
      "validation_method": "orm_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "Exact-match results are not deduplicated before appending to matches, so duplicates can be returned and also count toward the limit, reducing unique results.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b33e0847b047",
      "status": "resolved",
      "resolution": "deduplication added",
      "validation_method": "dedupe_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "max_hops parameter is effectively ignored; expand_entity_neighbors always performs a single hop regardless of the provided value.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a2edbd995683",
      "status": "resolved",
      "resolution": "multi-hop expansion implemented",
      "validation_method": "hop_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "expand_entity_neighbors docstring claims to return (edge, target_node) but reverse-edge query returns the source node, making the tuple semantics inconsistent and error-prone.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c0ffb2221f98",
      "status": "resolved",
      "resolution": "docstring updated for neighbor nodes",
      "validation_method": "doc_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "Potential None values from database (e.g., EntityNode.name, EntityNode.type, EntityNode.pagerank) are passed into Pydantic models with non-optional fields, risking validation errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "eca230dc5d11",
      "status": "resolved",
      "resolution": "entity fields normalized",
      "validation_method": "normalize_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "Query orders by EntityNode.pagerank while later code guards with hasattr(node, 'pagerank'); if the column is absent in the model, the order_by will fail at SQL compilation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "19f9da5c52fc",
      "status": "resolved",
      "resolution": "pagerank order conditional",
      "validation_method": "order_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "Synchronous database operations are performed inside async graph_retrieve, which can block the event loop and degrade concurrency.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fd3a9b6b6063",
      "status": "resolved",
      "resolution": "graph retrieval moved to thread",
      "validation_method": "thread_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "SECURITY",
      "line": null,
      "description": "graph_retrieve returns Err with the raw exception message, potentially leaking internal details to callers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5f0e149640da",
      "status": "resolved",
      "resolution": "error message sanitized",
      "validation_method": "error_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "Trigram search exceptions are caught and only logged as warnings, silently degrading functionality without surfacing failure to the caller.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5a690b0cd1d1",
      "status": "resolved",
      "resolution": "trigram errors raised",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "Case-insensitive substring matching via func.lower(column).contains(func.lower(value)) prevents index usage and may cause full table scans.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "86e483611f97",
      "status": "resolved",
      "resolution": "ilike used for case-insensitive match",
      "validation_method": "ilike_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "Appending neighbor IDs checks membership against a list (entity_ids), resulting in O(n^2) behavior for large sets; a set would be more efficient.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "65d4ebec8d2e",
      "status": "resolved",
      "resolution": "entity IDs tracked as set",
      "validation_method": "set_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "STYLE",
      "line": null,
      "description": "Hardcoded magic numbers (e.g., limit=100 in neighbor queries) reduce configurability and clarity.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "716204db0475",
      "status": "resolved",
      "resolution": "neighbor limit constant added",
      "validation_method": "constant_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "STYLE",
      "line": null,
      "description": "Mixing ORM queries with raw SQL against hardcoded table/column names (e.g., 'entity_nodes') increases brittleness and coupling to schema details.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0de02f3d284c",
      "status": "resolved",
      "resolution": "raw SQL replaced with ORM",
      "validation_method": "orm_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "GraphSearchResult attribution uses the first matched entity for every conversation, ignoring which entities actually connect to each conversation, likely producing misleading metadata.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "00b443f42f4d",
      "status": "resolved",
      "resolution": "conversation entity attribution updated",
      "validation_method": "attribution_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "SECURITY",
      "line": null,
      "description": "Logging full extracted entity names and queries at info level may expose sensitive user data in logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c185da7d2628",
      "status": "resolved",
      "resolution": "sensitive logging removed",
      "validation_method": "log_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/graph_search.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "Trigram fallback runs one query per entity name, which can lead to multiple round-trips and latency when many names are provided.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "aef737a7fe63",
      "status": "resolved",
      "resolution": "trigram query consolidated",
      "validation_method": "trigram_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/results.py",
      "category": "LOGIC_ERRORS",
      "line": 81,
      "description": "from_fts_result uses an empty string as the fallback for conversation_id, while the model and comment indicate that None represents an 'unassigned' conversation; this introduces inconsistent semantics.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a2a465344ad5",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/results.py",
      "category": "LOGIC_ERRORS",
      "line": 85,
      "description": "from_fts_result defaults lexical_score to 0.0 when the attribute is absent, but the field is Optional[float] with default None, conflating 'not computed' with a real zero score.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "76f18e7dd1ca",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/results.py",
      "category": "EXCEPTION_HANDLING",
      "line": 52,
      "description": "__repr__ uses model_dump(), which is a Pydantic v2-only API; in environments using Pydantic v1 this will raise AttributeError during logging with no handling.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "10266b369e02",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/results.py",
      "category": "SECURITY",
      "line": 54,
      "description": "__repr__ redacts only 'content' and 'snippet' but leaves 'highlights' (which may contain text excerpts) and 'metadata' unredacted, risking sensitive data exposure in logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8b5638672af7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/results.py",
      "category": "PERFORMANCE",
      "line": 52,
      "description": "__repr__ serializes and includes the entire model (including potentially large 'metadata' and 'highlights') via model_dump(), which can cause unnecessary memory/CPU overhead and log bloat.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8085b76b9089",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/results.py",
      "category": "STYLE",
      "line": 100,
      "description": "Field name 'type' shadows the Python built-in 'type', which can be confusing and can hinder readability or tooling.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d677efa67277",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/results.py",
      "category": "STYLE",
      "line": 21,
      "description": "Documentation states conversation_id: str, while the field is declared Optional[str]; this doc/implementation mismatch can mislead consumers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "eb4cbb6c4cdc",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "STYLE",
      "line": 3,
      "description": "Unused import: Optional is imported but never used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b8b15ccb0b90",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "LOGIC_ERRORS",
      "line": 16,
      "description": "Creating an asyncio.Lock at module import time can bind it to the wrong event loop, causing RuntimeError if the module is used across multiple event loops (e.g., in multi-worker servers or reloader scenarios).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8d3e194344d0",
      "status": "resolved",
      "resolution": "runtime lock initialized lazily",
      "validation_method": "lock_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "TYPE_ERRORS",
      "line": 59,
      "description": "Function _resolve_target_conversations is annotated to return list[str] but can return None, which mismatches the declared return type.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b4fd3f2443cc",
      "status": "resolved",
      "resolution": "runtime supports built-in generics",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "LOGIC_ERRORS",
      "line": 94,
      "description": "Empty-intersection check is incorrect: it tests final_ids is None, but an empty intersection yields an empty list, so this condition never triggers and the intended 'no match' case is not returned.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fbcb2ab35c75",
      "status": "resolved",
      "resolution": "empty intersection handled",
      "validation_method": "intersection_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "NULL_SAFETY",
      "line": 34,
      "description": "Unguarded attribute access: config.embedding.model_name may raise AttributeError if config or embedding is missing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "364858e3a6ee",
      "status": "resolved",
      "resolution": "embedding config guard added",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "NULL_SAFETY",
      "line": 49,
      "description": "Unguarded attribute access when caching: config.embedding.model_name may raise AttributeError if config or embedding is missing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5cc4de1a840a",
      "status": "resolved",
      "resolution": "embedding config guard added",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "PERFORMANCE",
      "line": 42,
      "description": "Potential event loop blocking: calling synchronous runtime.embed_queries inside an async function can block the event loop if the operation is CPU/IO heavy.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2277c776a79d",
      "status": "resolved",
      "resolution": "embedding call moved to thread",
      "validation_method": "thread_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "EXCEPTION_HANDLING",
      "line": 52,
      "description": "Broad except Exception swallows all errors and only logs a message without traceback, potentially hiding root causes and making debugging difficult.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a1fe08194cf4",
      "status": "resolved",
      "resolution": "exception logging with traceback",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "NULL_SAFETY",
      "line": 65,
      "description": "Unguarded optional access: args.classification and args.classification.type assume attributes exist; missing attributes would raise AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c0d3914f107f",
      "status": "resolved",
      "resolution": "classification guard added",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "NULL_SAFETY",
      "line": 69,
      "description": "Unguarded attribute access: args.tenant_id is assumed to exist; missing attribute would raise AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6948474f134b",
      "status": "resolved",
      "resolution": "tenant_id guard added",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "LOGIC_ERRORS",
      "line": 70,
      "description": "limit is passed through min(limit, 200) without validating non-negativity; negative limits could propagate to search and cause unexpected behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "531154daf131",
      "status": "resolved",
      "resolution": "limit normalized with constant",
      "validation_method": "limit_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "NULL_SAFETY",
      "line": 43,
      "description": "Assumes embed_queries returns a non-empty sequence; indexing embedding_array[0] can raise IndexError if the result is empty.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ad33a46d8bd4",
      "status": "resolved",
      "resolution": "empty embedding guard added",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "TYPE_ERRORS",
      "line": 105,
      "description": "convert_fts_to_items relies on many attributes of res (e.g., snippet, text, score, etc.) while fts_results is typed as list[Any]; passing objects without these attributes will raise AttributeError at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "21804ba63ff3",
      "status": "resolved",
      "resolution": "fts result type specified",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "TYPE_ERRORS",
      "line": 115,
      "description": "highlights=[res.snippet] may include a None or non-string value if res.snippet is None or not a string, potentially violating expected types for SearchResultItem.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "206de9a04adc",
      "status": "resolved",
      "resolution": "snippet normalized to string",
      "validation_method": "snippet_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "TYPE_ERRORS",
      "line": 131,
      "description": "convert_vector_to_items relies on attributes of res (e.g., text, score, chunk_type) while vector_results is typed as list[Any]; passing incompatible objects will raise AttributeError at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ea6771bb3dce",
      "status": "resolved",
      "resolution": "vector result type specified",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "LOGIC_ERRORS",
      "line": 140,
      "description": "attachment_id=res.attachment_id or None coerces valid falsy values (e.g., 0, empty string) to None, potentially losing information.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f501a011cb4b",
      "status": "resolved",
      "resolution": "attachment_id preserved",
      "validation_method": "assignment_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "TYPE_ERRORS",
      "line": 142,
      "description": "Assumes res.text is a string for slicing; if it is bytes or another type, highlights/snippet may contain non-string types, conflicting with expected types.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "313c5225bd07",
      "status": "resolved",
      "resolution": "content normalized to string",
      "validation_method": "content_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "STYLE",
      "line": 70,
      "description": "Magic number 200 used for search limit without a named constant, reducing readability and maintainability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8f1753b5e9e5",
      "status": "resolved",
      "resolution": "limit constant added",
      "validation_method": "constant_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/_hybrid_helpers.py",
      "category": "STYLE",
      "line": 142,
      "description": "Magic number 200 used for snippet length without a named constant, reducing readability and maintainability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5495e64258ea",
      "status": "resolved",
      "resolution": "snippet length constant added",
      "validation_method": "constant_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/__init__.py",
      "category": "PERFORMANCE",
      "line": 7,
      "description": "Eager, top-level imports of intra-package modules and many symbols in __init__ can increase import time and memory usage by loading potentially heavy submodules even when consumers only import the package.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "dbf7bc77697e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/__init__.py",
      "category": "LOGIC_ERRORS",
      "line": 7,
      "description": "Direct intra-package imports from __init__ can create circular import risks if the imported submodules themselves import from the package or its __init__, potentially causing ImportError at import time.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9c79d4fc3b52",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/__init__.py",
      "category": "STYLE",
      "line": 26,
      "description": "The __all__ re-exports a large, specific surface from submodules, creating a brittle API boundary that can easily get out of sync with submodule definitions and complicate maintenance and discoverability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "340b6c67cadb",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/async_cache.py",
      "category": "STYLE",
      "line": 4,
      "description": "Module docstring claims 'thread-safe' while the implementation (asyncio.Lock) is only async-safe; this is misleading and contradicts the class docstring.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "05dd5c678ecd",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/async_cache.py",
      "category": "STYLE",
      "line": 16,
      "description": "Unused import: Optional is imported but not used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "937b5861f7f6",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/async_cache.py",
      "category": "EXCEPTION_HANDLING",
      "line": 129,
      "description": "Global asyncio.Lock is created at import time; using this lock across different event loops or threads can raise RuntimeError due to loop affinity.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d936c97b63c8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/async_cache.py",
      "category": "LOGIC_ERRORS",
      "line": 99,
      "description": "No validation of max_size; a negative value makes the eviction loop condition always true, causing repeated popitem() calls and eventual KeyError when the cache becomes empty.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b160ed1ff5c5",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/async_cache.py",
      "category": "LOGIC_ERRORS",
      "line": 49,
      "description": "No validation of ttl_seconds; non-positive TTLs lead to immediate expiration on access, which may be unintended behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c43a9fd07a88",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/async_cache.py",
      "category": "LOGIC_ERRORS",
      "line": 68,
      "description": "TTL calculations use time.time() (wall clock) which is subject to system clock changes; this can cause premature expiration or extended lifetimes.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a3d7ca3b1e49",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/async_cache.py",
      "category": "PERFORMANCE",
      "line": 81,
      "description": "Copying the numpy array on get (embedding.copy()) incurs additional memory and CPU overhead for large arrays; the same entry is also copied on put, leading to double copying.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f06f6f57bd9b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/async_cache.py",
      "category": "PERFORMANCE",
      "line": 96,
      "description": "Copying the numpy array on put (embedding.copy()) adds CPU/memory overhead; combined with the copy on get, this increases cost per access.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0e877c78621b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/async_cache.py",
      "category": "PERFORMANCE",
      "line": 48,
      "description": "Potentially heavy numpy array copying is performed while holding an asyncio.Lock, which can block the event loop and reduce concurrency.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6fa1828e45d0",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/async_cache.py",
      "category": "SECURITY",
      "line": 71,
      "description": "Logs include user-supplied query text (even truncated), which may leak sensitive information into logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "738775f3f0d0",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/async_cache.py",
      "category": "TYPE_ERRORS",
      "line": 80,
      "description": "Logging uses slicing on query (query[:LOG_QUERY_TRUNCATE_LEN]); if a non-str (e.g., None) is passed despite type hints, this will raise a TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "66e41563b528",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/async_cache.py",
      "category": "STYLE",
      "line": 120,
      "description": "stats() returns total_entries including expired entries, which may be misleading given valid_entries is also reported and expired entries are not proactively cleaned up.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "874e0e0d5fe4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filter_resolution.py",
      "category": "SECURITY",
      "line": 81,
      "description": "When only conv_ids are provided, the function returns them directly without verifying tenant ownership. This bypasses the tenant_id constraint applied elsewhere and risks cross-tenant data exposure if upstream conv_ids are untrusted.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "27ae23339b71",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filter_resolution.py",
      "category": "LOGIC_ERRORS",
      "line": 124,
      "description": "from_emails, to_emails, and cc_emails are merged into a single set and applied as a generic participants JSONB contains filter, losing role semantics. A filter intended for 'from' could match if the email appears only in 'to' or 'cc'.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b27988ef494e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filter_resolution.py",
      "category": "LOGIC_ERRORS",
      "line": 19,
      "description": "_sanitize_like_term does not escape the chosen escape character (backslash) while ilike is called with escape=\"\\\\\". Input containing backslashes can be misinterpreted by the LIKE engine, leading to incorrect matching.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d498ad4c943c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filter_resolution.py",
      "category": "TYPE_ERRORS",
      "line": 54,
      "description": "Return annotation uses the union operator (list[str] | None) which requires Python 3.10+. Combined with PEP 585 generics (set[str], list[str]), this constrains runtime version; inconsistency is suggested by the unused Optional import.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c2341c3ba7b1",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filter_resolution.py",
      "category": "STYLE",
      "line": 2,
      "description": "Unused import: Optional is imported but never used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f74f8690924f",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filter_resolution.py",
      "category": "STYLE",
      "line": 44,
      "description": "Redundant conditional: 'if clauses:' is always true when emails is non-empty (the only path to this point), making the check unnecessary and the else branch effectively unreachable.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d64102c04608",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filter_resolution.py",
      "category": "PERFORMANCE",
      "line": 40,
      "description": "_add_email_filters generates 2N OR conditions (email and smtp) for N emails. With large email sets this can produce large, slow queries despite indexing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ef206d68da25",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filter_resolution.py",
      "category": "TYPE_ERRORS",
      "line": 107,
      "description": "subject_contains terms are assumed to be strings. If SearchFilters.subject_contains contains non-str values (e.g., None), _sanitize_like_term will raise due to calling .replace on a non-str.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c3e6ee2678f1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filter_resolution.py",
      "category": "STYLE",
      "line": 110,
      "description": "The pattern f\"%%{sanitized_term}%%\" contains doubled percent signs which are redundant in SQL LIKE patterns and reduce readability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "31c3490acd80",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filter_resolution.py",
      "category": "STYLE",
      "line": 22,
      "description": "Type annotation uses sqlalchemy.orm.Query, which is a legacy construct in SQLAlchemy 2.x. Depending on the project's SQLAlchemy version policy, this may be considered a deprecated type reference.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c4efa64aeb36",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "STYLE",
      "line": 10,
      "description": "Unused import: Optional is imported but never used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ef6d9d40ec38",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "NULL_SAFETY",
      "line": 77,
      "description": "Unconditional write to item.metadata[\"rerank_score\"] without ensuring metadata is a dict may raise if metadata is None or non-mapping.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "906d77822383",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "TYPE_ERRORS",
      "line": 76,
      "description": "Arithmetic uses item.score directly; if score is None this will raise a TypeError (unsupported operand types).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c896b7058b91",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "LOGIC_ERRORS",
      "line": 74,
      "description": "alpha is not validated to [0,1]; values outside this range produce unintended weightings in the blend.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "815933fb5276",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "LOGIC_ERRORS",
      "line": 227,
      "description": "lambda_param is not validated to [0,1]; values outside this range can invert or exaggerate redundancy in MMR scoring.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fd6c071e327e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "LOGIC_ERRORS",
      "line": 133,
      "description": "Defaulting missing 'index' to 0 when parsing external reranker results can duplicate the first candidate and corrupt ordering if the response omits indices.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7d662df63063",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "LOGIC_ERRORS",
      "line": 99,
      "description": "top_n is not validated; a negative value will select candidates from the end via Python slicing semantics.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3d24bf860e3b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "SECURITY",
      "line": 161,
      "description": "HTTP scheme is allowed; sending query/documents over plain HTTP risks leaking sensitive data in transit.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "96cea055615a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "SECURITY",
      "line": 113,
      "description": "SSRF precheck is TOCTOU-prone: DNS/IP validation is done before the request, but the actual httpx request performs its own resolution, enabling potential DNS rebinding between validation and connection.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ceb702bad95f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "SECURITY",
      "line": 113,
      "description": "No allowlist or domain restriction for the external reranker endpoint; any globally routable host is permitted, enabling data exfiltration if the endpoint is user-controlled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5843dfaa635a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "SECURITY",
      "line": 178,
      "description": "Logs include the full URL on validation failure, which can expose credentials or tokens if embedded in the endpoint.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "11907de68337",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "EXCEPTION_HANDLING",
      "line": 150,
      "description": "Broad except Exception swallows all errors from the external call and silently falls back, obscuring specific failure modes and making detection/handling of non-transient issues harder.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1dbee9d206ed",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "PERFORMANCE",
      "line": 216,
      "description": "apply_mmr runs an O(n^2) selection with pairwise similarities; this can be slow for large result sets.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "36c048f69677",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "PERFORMANCE",
      "line": 116,
      "description": "No response size limits or streaming safeguards when calling the external reranker; a large response could cause excessive memory usage.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8c858782d21d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/reranking.py",
      "category": "STYLE",
      "line": 32,
      "description": "_candidate_summary_text mutates item.metadata (sets to {} when None) even though it is a formatter function, introducing a surprising side effect.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "01752f1259e7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filters.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "_parse_iso_date does not handle date-only strings like '2024-01-01' or naive datetimes: datetime.fromisoformat returns a naive datetime for such inputs and .astimezone(timezone.utc) raises ValueError, causing valid 'after:/before:' ISO dates to be ignored despite being documented as supported.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "503af0892496",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filters.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "SearchFilters.is_empty checks only for None, not for empty containers. Empty sets/lists (e.g., file_types set to empty when all extensions are invalid) will cause is_empty to incorrectly report filters are present.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5494f54654e4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filters.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "Subject and exclusion term matching use ILIKE with unescaped user input. '%' and '_' in terms will be treated as wildcards, which can broaden matches/exclusions beyond user intent.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9d4157b351f1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filters.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "Timezone-aware UTC datetimes are passed as SQL params for date filters. If the database columns (e.g., latest_date) are TIMESTAMP WITHOUT TIME ZONE, comparisons may yield incorrect results or adapter errors due to tz-aware vs tz-naive mismatch.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d0aa4a54a11d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filters.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "SQL uses '= ANY(:param)' with list parameters (file_types, from_emails, to_emails, cc_emails). Depending on the DB driver, unnamed array type inference may fail without explicit array casting, leading to binding/runtime errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c6baee4a47ea",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filters.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "Multiple EXISTS subqueries over jsonb_array_elements(participants) can be expensive for large datasets and repeated per-row expansions, potentially impacting query performance.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2664781e4390",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filters.py",
      "category": "STYLE",
      "line": null,
      "description": "Unused imports: json and Optional are imported but never used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f81620fff6fe",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/filters.py",
      "category": "STYLE",
      "line": null,
      "description": "The UTC compatibility shim (from datetime import UTC or UTC = timezone.utc) is defined but never used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "99b8366a5716",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/fts_search.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "In search_chunks_fts, an empty conversation_ids list is treated as falsy and the filter is skipped, potentially returning unfiltered results when a caller may expect no results.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "36d7ad8aba5e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/fts_search.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "User-provided query (after expand_for_fts) is passed to to_tsquery without validation; malformed tsquery strings can cause database syntax errors that are not handled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ccdc1b1d3fc6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/fts_search.py",
      "category": "SECURITY",
      "line": null,
      "description": "Debug logging includes the raw and expanded user query text, which may leak sensitive user input into logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "57f11bbe81bd",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/fts_search.py",
      "category": "SECURITY",
      "line": null,
      "description": "ts_headline output (snippet) may include unescaped content from the database; if rendered in a web context without proper escaping, it can lead to XSS risks.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cb0714424f00",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/fts_search.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "conversation_ids is typed as list[str] but used in SQL as UUID[]; non-UUID strings will cause database type errors at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d7ef35384487",
      "status": "resolved",
      "resolution": "runtime supports built-in generics",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/fts_search.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "file_types is bound to ANY(:file_types) without an explicit cast; depending on driver/type inference, this can result in operator resolution/type errors (e.g., text = ANY(unknown)).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "bd7fc9a96a5b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/fts_search.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "bool(row.is_attachment) coerces NULL to False, losing the distinction between unknown and false and potentially misrepresenting data.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d29fdbb11ba1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/fts_search.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "dict(row.extra_data) assumes extra_data is a mapping; if the JSON column contains a non-object (e.g., array or string), this will raise a TypeError or yield unintended results.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "51ee95bf3651",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/fts_search.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "On-the-fly to_tsvector/setweight computations in search_conversations_fts prevent reuse of precomputed tsvector columns and can hinder index usage, increasing CPU cost per row.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "edc20a800ffa",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/fts_search.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "In search_chunks_fts, selecting and returning the full c.text and computing ts_headline for matched rows can be expensive and bandwidth-heavy at scale.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a3a810c57ec3",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/fts_search.py",
      "category": "STYLE",
      "line": null,
      "description": "Magic number 32 is used as the ts_rank_cd normalization flag without a named constant or explanation, reducing readability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "89b8831a0b3a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/fts_search.py",
      "category": "STYLE",
      "line": null,
      "description": "Use of implicit cross join syntax (FROM conversations conv, q / FROM chunks c, q) reduces clarity compared to explicit JOINs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "43c40f167cbc",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/fts_search.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "Silently defaulting chunk_type to 'message_body' when NULL may misrepresent the actual data semantics in results.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "15ad14f7041f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_store.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "Qdrant response JSON parsing catches requests.JSONDecodeError, which does not exist; response.json() raises json.JSONDecodeError/ValueError instead. Invalid exception type means JSON decode failures will be unhandled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b20297c6b796",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_store.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "Postgres query uses CAST(:conversation_ids AS UUID[]) with a bound parameter. Casting a parameter to an array type like this commonly fails in PostgreSQL/SQLAlchemy text queries and may raise a database error at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "773d989def35",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_store.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "ANY(:file_types) with a Python list in a text() query may not be correctly typed to text[] by the driver, causing type inference errors at runtime depending on dialect/version.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fab5b09752fa",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_store.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "SET LOCAL hnsw.ef_search is executed without ensuring a transaction block; if no transaction is active this can raise an error, which is not caught or converted to a domain-specific exception.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ee9b406db916",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_store.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "Qdrant file_types filter is added as a nested object with only a 'should' clause inside 'must'. In Qdrant, 'should' is not a hard filter unless min_should is specified, so this may not actually constrain results by file_types and only bias scoring.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "84db0445f354",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_store.py",
      "category": "SECURITY",
      "line": null,
      "description": "SQL string uses f-string interpolation for the halfvec({self._output_dim}) type. While not user input, non-parameterized SQL fragments increase injection surface if configuration becomes attacker-controlled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d56147afaeda",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_store.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "Database errors from the pgvector search (session.execute/fetchall) are not handled or wrapped, leading to unhandled exceptions leaking internal errors to callers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "55d332d24542",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_store.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_validate_embedding uses a broad 'except Exception' when converting to numpy array, which can mask unrelated errors (e.g., MemoryError) and hinder diagnosis.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c5f4244df45c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_store.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "Qdrant result score is blindly clamped to [0,1] without accounting for the collection's distance metric. If the metric is dot-product or Euclidean, the returned 'score' may not represent similarity and can mis-rank results.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "723415dd8e57",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_store.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "Logs an info-level message on every Qdrant search ('Qdrant search returned %d chunks'), which can cause high-volume logging in hot paths.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "003a66eba256",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_store.py",
      "category": "STYLE",
      "line": null,
      "description": "Docstring for PgvectorStore.search mentions use of COALESCE and CASE statements that do not appear in the actual SQL, causing documentation/code mismatch.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8924e41b9c2c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_store.py",
      "category": "STYLE",
      "line": null,
      "description": "Imported Optional from typing but never used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0e43052504cf",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/vector_store.py",
      "category": "SECURITY",
      "line": null,
      "description": "On Qdrant non-200 responses, the error context includes response.text, which may leak sensitive backend details to logs or clients depending on how RetrievalError is handled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "084ac202ee89",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "category": "LOGIC_ERRORS",
      "line": 239,
      "description": "Function tool_classify_query is lru_cached but returns a mutable Pydantic model; the same cached instance can be returned across calls, so external mutation of the returned object may leak state between callers and subsequent requests.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "18db250e927b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "category": "PERFORMANCE",
      "line": 257,
      "description": "Cache key is computed on the raw input before normalization; query.strip() happens inside the function, causing logically equivalent inputs with different surrounding whitespace to miss the cache.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0f48f831d7ec",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "category": "PERFORMANCE",
      "line": 238,
      "description": "Decorator order applies trace_operation outside lru_cache; tracing overhead occurs even on cache hits, potentially creating unnecessary spans and overhead.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cf3d01faf179",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "category": "STYLE",
      "line": 45,
      "description": "QueryClassificationInput class is defined but never used (dead code).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a13f86dcdf4b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "category": "STYLE",
      "line": 183,
      "description": "Docstring for classify_query_llm references an argument 'args' of type QueryClassificationInput, which does not match the actual signature (query: str).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ed3fc90fd684",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "category": "STYLE",
      "line": 216,
      "description": "Deprecated API usage: complete_json is explicitly noted as deprecated yet still used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0a209f9e76ee",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "category": "LOGIC_ERRORS",
      "line": 211,
      "description": "classify_query_llm assumes messages[0] and messages[1] exist when reconstructing the prompt; if construct_prompt_messages changes its return structure, this can raise IndexError or KeyError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d89c871d28ff",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "category": "NULL_SAFETY",
      "line": 148,
      "description": "classify_query_fast calls query.strip() without guarding against None; if called externally with None, this will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "13f4297d42a0",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "category": "NULL_SAFETY",
      "line": 257,
      "description": "tool_classify_query calls query.strip() without guarding against None; external callers passing None will trigger an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d0e99752d47e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/retrieval/query_classifier.py",
      "category": "STYLE",
      "line": 25,
      "description": "Documentation inconsistency: class docstring references Blueprint \u00a78.1 while module-level docstring states \u00a78.2.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e468c3a85ea4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/rag.py",
      "category": "STYLE",
      "line": 10,
      "description": "Unused import: Optional is imported but not used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6becd2a1b818",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/rag.py",
      "category": "TYPE_ERRORS",
      "line": 21,
      "description": "_PII_FIELDS is type-annotated on a Pydantic model; in some Pydantic versions (e.g., v2) annotated underscore attributes are treated as fields, which can cause unintended validation/serialization exposure of this attribute.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cc275803fc3b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/rag.py",
      "category": "TYPE_ERRORS",
      "line": 135,
      "description": "attachments is typed as list[dict[str, str]], which provides no schema enforcement for required keys (e.g., 'path', 'filename') and weak validation, increasing risk of inconsistent data structures.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3d4663e32d32",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/rag.py",
      "category": "SECURITY",
      "line": 126,
      "description": "PII redaction set for EmailDraft does not include 'attachments'; attachment paths/filenames may expose sensitive information if redaction relies solely on _PII_FIELDS.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "51dc50f4e8c8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/rag.py",
      "category": "SECURITY",
      "line": 165,
      "description": "ThreadSummary only marks 'summary_markdown' as PII; other free-text fields like 'key_points', 'action_items', and potentially 'participants' content can carry PII and may be exposed if redaction depends on _PII_FIELDS.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "45cc878eb988",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/rag.py",
      "category": "STYLE",
      "line": 70,
      "description": "Inconsistent base classes across models: some use SecureBaseModel while others use BaseModel, which can lead to inconsistent behavior (e.g., security/redaction or config) within the same domain layer.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4616fab61af6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/rag.py",
      "category": "STYLE",
      "line": 167,
      "description": "Field named 'type' may be confusing as it shadows the built-in name, potentially reducing code clarity during introspection or debugging.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ba3a65ae2fe2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/__init__.py",
      "category": "STYLE",
      "line": 4,
      "description": "Docstring claims the package includes 'orchestration' models, but no orchestration-related modules or symbols are imported or re-exported, making the documentation inaccurate.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ee968368f40a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/__init__.py",
      "category": "EXCEPTION_HANDLING",
      "line": 7,
      "description": "Module-level re-exports import submodules at import time, which can surface circular import issues (ImportError) if those submodules import from the package namespace; there is no handling for such failures.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "aeafceb0e1c8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/__init__.py",
      "category": "PERFORMANCE",
      "line": 7,
      "description": "Eagerly importing all symbols from rag and facts_ledger on package import increases import time and memory use even when only a subset is needed.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "22d0f03fa344",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/__init__.py",
      "category": "STYLE",
      "line": 7,
      "description": "Symbols are imported solely to be re-exported via __all__; some linters may flag these as 'imported but unused' (F401) in __init__ without explicit suppression.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "04be623bcdf3",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/facts_ledger.py",
      "category": "STYLE",
      "line": 11,
      "description": "Unused import: Optional is imported from typing but never used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0e8b55dd1cc9",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/facts_ledger.py",
      "category": "LOGIC_ERRORS",
      "line": 80,
      "description": "The condition `if not other:` will not detect an 'empty' FactsLedger (BaseModel instances are truthy), so the intended early-return fast path for empty inputs is ineffective and may cause unnecessary work.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ecb5b9136c1a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/facts_ledger.py",
      "category": "LOGIC_ERRORS",
      "line": 115,
      "description": "get_participant_key checks truthiness before stripping; whitespace-only email/name values become empty keys like 'email:' or 'name:', causing unintended collisions and deduplication of distinct participants.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cabe9b6cd1ba",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/facts_ledger.py",
      "category": "LOGIC_ERRORS",
      "line": 124,
      "description": "Participants without a usable key (no email and no name) are dropped: they are excluded from the initial map and skipped when merging others, resulting in silent data loss.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f57956084006",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/facts_ledger.py",
      "category": "NULL_SAFETY",
      "line": 143,
      "description": "When merging participants, `p.role` is only updated if it equals 'other'; if `p.role` is None, it is not updated even if `other_p.role` has a meaningful value, and if `other_p.role` is None it can overwrite a non-None value, leading to loss of information.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "921a227307b2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/facts_ledger.py",
      "category": "NULL_SAFETY",
      "line": 145,
      "description": "Similar to role, `p.tone` is only updated when it equals 'neutral'; a None tone is not improved from `other_p`, and if `other_p.tone` is None it can overwrite a non-None value.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e3710be70db0",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/facts_ledger.py",
      "category": "LOGIC_ERRORS",
      "line": 97,
      "description": "Deduplication keys for model lists ignore potentially distinguishing fields: asks ignore `status`, commitments ignore `due_date` and `status`, and key_dates ignore `relevance`, which can conflate distinct records.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "73d6ad889ed8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain_models/facts_ledger.py",
      "category": "PERFORMANCE",
      "line": 110,
      "description": "Using `sorted(list(set(...)))` constructs an unnecessary intermediate list; the extra list conversion adds avoidable overhead.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0ec96a4f8c2c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/models.py",
      "category": "STYLE",
      "line": 12,
      "description": "Unused import: Optional is imported but never referenced.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ebae07138cce",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/models.py",
      "category": "TYPE_ERRORS",
      "line": 181,
      "description": "Column 'embedding' is defined without a Mapped[...] type annotation, reducing type safety and potentially confusing SQLAlchemy's typed declarative mapping.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8794ca5cae96",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/models.py",
      "category": "LOGIC_ERRORS",
      "line": 270,
      "description": "Both EntityNode.outgoing_edges and EntityNode.incoming_edges use delete-orphan cascade, but each EntityEdge has two parent nodes (source and target). This violates the single-parent assumption for delete-orphan and can cause ORM configuration errors or undefined deletion behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c2693be4cc43",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/models.py",
      "category": "LOGIC_ERRORS",
      "line": 91,
      "description": "Conversation declares an index on (tenant_id, folder_name) but not a unique constraint, despite the docstring stating each folder equals one conversation, allowing duplicate conversations for the same folder within a tenant.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "779b3864be37",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/models.py",
      "category": "LOGIC_ERRORS",
      "line": 169,
      "description": "Chunk allows attachment_id to be nullable and has a separate is_attachment flag without constraints tying them together, enabling inconsistent states (e.g., attachment_id set while is_attachment is False or vice versa).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4233a38a9513",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/models.py",
      "category": "LOGIC_ERRORS",
      "line": 185,
      "description": "Chunk char_start/char_end default to 0 and lack constraints ensuring valid ranges (e.g., char_start <= char_end and alignment with text), allowing invalid positional metadata.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "608a5799d628",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/models.py",
      "category": "PERFORMANCE",
      "line": 202,
      "description": "Index on boolean column chunks.is_attachment is likely low selectivity and may provide little benefit while incurring write and storage overhead.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "69b49196e27e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/models.py",
      "category": "TYPE_ERRORS",
      "line": 180,
      "description": "tsv_text is annotated as Any | None even though the column type is TSVECTOR, which weakens type checking and can hide incorrect usage.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2aaaf40ee41f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/models.py",
      "category": "STYLE",
      "line": 251,
      "description": "EntityNode defines a column named 'type', which shadows the built-in name and can cause readability issues or accidental confusion when referenced.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fdf129391315",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/models.py",
      "category": "STYLE",
      "line": 314,
      "description": "EntityEdge.weight explicitly specifies the column name 'weight' identical to the attribute, which is redundant and may reduce clarity.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d75da095c20f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/models.py",
      "category": "STYLE",
      "line": 255,
      "description": "EntityNode.pagerank explicitly specifies the column name 'pagerank' identical to the attribute, which is redundant and may reduce clarity.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1f9435f1481d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/session.py",
      "category": "SECURITY",
      "line": null,
      "description": "Raw exception details are propagated and logged via f-strings, bypassing the redaction filter. Examples: logger.error(f\"Rollback failed: {rollback_error}\") in exception paths and TransactionError messages like f\"Database transaction failed: {e}\" and f\"Transaction failed: {e}\" as well as context={\"original_error\": str(e)} leak underlying exception messages.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fe6fd0b96bed",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/session.py",
      "category": "SECURITY",
      "line": null,
      "description": "set_session_tenant wraps underlying errors with message f\"Failed to set RLS tenant: {e}\" which exposes the original exception text. This contradicts the stated security hardening to avoid propagating raw exception messages.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9fa53ac4966c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/session.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_RedactingExceptionFilter may assign record.exc_info to a tuple where the exception value is the exception class (not an instance) if instantiation fails. This violates logging's expected exc_info contract and risks handler/formatter errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "88ada0509c55",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/session.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "after_cursor_execute unconditionally does conn.info[\"query_start_time\"].pop() without guarding for missing/empty state. If before_cursor_execute was not called (e.g., error path) or the list was cleared elsewhere, this can raise IndexError and mask the original DB error.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2b552e068a74",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/session.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "Potential memory leak: query_start_time is appended in before_cursor_execute, but if execution fails before after_cursor_execute runs, entries may never be popped, accumulating per-connection state.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "056fa008bcba",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/session.py",
      "category": "STYLE",
      "line": null,
      "description": "SLOW_QUERY_THRESHOLD_SECONDS is defined but not used. The code hardcodes 1.0 in after_cursor_execute, creating a magic number and maintenance inconsistency.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "72d053413cf6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/session.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "Engine selection logic checks if \"sqlite\" is a substring of the URL to decide pooling args. This is brittle and case-sensitive; URLs or credentials containing \"sqlite\" could be misclassified, leading to incorrect engine configuration.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1fb339e026ff",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/session.py",
      "category": "SECURITY",
      "line": null,
      "description": "Slow query logging emits the SQL statement text (even if truncated to 200 chars). If literal binds are inlined or queries contain sensitive data, this can leak PII/secrets to logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9b0ed8353ae8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/session.py",
      "category": "STYLE",
      "line": null,
      "description": "Inconsistent import style: re is imported inside set_session_tenant rather than at module scope, reducing readability and consistency.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2b03fbb1eff3",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/session.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "Module-level configuration access (_config.database.url/pool_size/max_overflow) is unguarded. If configuration is missing or malformed, AttributeError/TypeError will be raised at import time, failing the application startup.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "db576463f39c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/db/session.py",
      "category": "SECURITY",
      "line": null,
      "description": "Debug log in set_session_tenant exposes tenant_id (logger.debug(f\"Set RLS tenant context: {tenant_id}\")). Tenant identifiers may be sensitive and should not be logged in plaintext.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "47303f8046fc",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/audit/__init__.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "Hash computation in log_audit_event uses truthiness checks (if input_data / if output_data). Falsy but valid values (e.g., empty dict/list/\"\", 0) will skip hashing, leading to inconsistent audit hashes.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8a85b6a80357",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/audit/__init__.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "tool_audit_log computes output_hash only if output_snapshot is truthy. An empty dict (valid \"no-change\" output) will be treated as \"no output\" and not hashed, causing inconsistent behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e21482f85c16",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/audit/__init__.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "log_audit_event commits a caller-provided db_session unconditionally, which can interfere with the caller's transaction management and lead to unexpected partial commits.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fe3d7a9bbe6e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/audit/__init__.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "log_audit_event broadly catches all exceptions and only logs them (logger.critical), potentially masking persistent failures and making them harder to detect programmatically.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d4844f92d9a8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/audit/__init__.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_write_audit_log does not perform a rollback on failure, which can leave the SQLAlchemy session (especially a caller-provided one) in a broken state.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b5ec0889a0e8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/audit/__init__.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "get_audit_trail catches all exceptions and returns an empty list, silently masking query errors and conflating \"no results\" with \"query failed\".",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9327ba2de1c9",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/audit/__init__.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "Use of datetime.UTC requires Python 3.11+. In environments on earlier Python versions, importing UTC will fail at import time.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b1eafc71a511",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/audit/__init__.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "risk_level is annotated as Literal[\"low\", \"medium\", \"high\"], but value is taken directly from policy_decision.risk_level without validation. A non-conforming value would violate the declared type (and possibly database constraints).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6d5be54e2238",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/audit/__init__.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "Filtering with AuditLog.audit_metadata[\"correlation_id\"].astext is dialect-specific (PostgreSQL JSONB) and uses a deprecated attribute in newer SQLAlchemy versions, leading to portability and runtime compatibility issues.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a2bf8b565c85",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/audit/__init__.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "The since parameter may be a naive datetime while stored timestamps are timezone-aware (UTC). Depending on database and SQLAlchemy configuration, this can cause comparison errors or unintended time interpretation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d3d9cfa3943c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/audit/__init__.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "Each audit log write opens a new session and immediately commits (or commits a provided session), which can be expensive at high throughput and precludes batching.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e9cb06a31d3e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/audit/__init__.py",
      "category": "STYLE",
      "line": null,
      "description": "get_audit_trail accepts an unvalidated limit parameter. Negative or nonsensical values could produce unexpected query behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "95c3e4f92099",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain/models.py",
      "category": "SECURITY",
      "line": 25,
      "description": "Defaulting tenant_id to the hard-coded string \"default\" when None may lead to unintended cross-tenant access or querying a global/default tenant, which can be a multi-tenant data exposure risk.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ecc260b7b7a8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain/models.py",
      "category": "SECURITY",
      "line": 26,
      "description": "Defaulting user_id to the hard-coded string \"cli-user\" when None can undermine auditability and effectively spoof a user identity in logs/metrics.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9b478356771d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain/models.py",
      "category": "PERFORMANCE",
      "line": 15,
      "description": "No upper bound on limit; very large values could trigger excessive retrieval and degrade performance or resource usage.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "814a1ec2b274",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain/models.py",
      "category": "LOGIC_ERRORS",
      "line": 14,
      "description": "No validation preventing empty string queries; an empty query may be invalid or produce unintended retrieval behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "703474be48e3",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain/models.py",
      "category": "LOGIC_ERRORS",
      "line": 17,
      "description": "Empty strings for tenant_id are not normalized; an empty string bypasses the defaulting logic (only checks for None) and may be invalid downstream.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3a0a41acd54a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain/models.py",
      "category": "LOGIC_ERRORS",
      "line": 18,
      "description": "Empty strings for user_id are not normalized; an empty string bypasses the defaulting logic and may be invalid or misleading downstream.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8a2042b01779",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain/models.py",
      "category": "STYLE",
      "line": 25,
      "description": "Use of magic string constants (\"default\", \"cli-user\") embeds policy in code and obscures intent; these should be centrally defined or configured.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2c9968ccaea7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain/models.py",
      "category": "STYLE",
      "line": 7,
      "description": "Domain model directly imports a retrieval-layer model, creating tight cross-layer coupling and potential for circular dependencies.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5db1a1e61145",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain/models.py",
      "category": "STYLE",
      "line": 21,
      "description": "Method returns a retrieval-layer model from a domain-layer model, further entangling layers and reducing modularity/testability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ddf1b0ff0f11",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain/models.py",
      "category": "TYPE_ERRORS",
      "line": 16,
      "description": "fusion_strategy is constrained to Literal[\"rrf\", \"weighted_sum\"], but the retrieval-layer field (fusion_method) may expect different values or an enum, risking validation/type mismatch at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e5d51b7752be",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain/models.py",
      "category": "TYPE_ERRORS",
      "line": 29,
      "description": "Mapping fusion_strategy to fusion_method assumes compatible types/allowed values in the retrieval model; mismatch would raise a pydantic validation error.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8525145c0368",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain/models.py",
      "category": "EXCEPTION_HANDLING",
      "line": 24,
      "description": "Construction of RetrievalKBSearchInput is not guarded; any pydantic ValidationError or TypeError will propagate without context, which may be undesirable in CLI/tooling paths.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c85cf70d5065",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/domain/models.py",
      "category": "LOGIC_ERRORS",
      "line": 19,
      "description": "filters dict is passed by reference to the retrieval model; if mutated downstream, it can cause unintended side effects on the original domain model instance.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cbeb9a7a82f6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/auth.py",
      "category": "STYLE",
      "line": 10,
      "description": "Unused import 'jwt'.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2d986dd9ccad",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/auth.py",
      "category": "STYLE",
      "line": 12,
      "description": "Unused import 'CortexError'.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "786fed80fad6",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/auth.py",
      "category": "STYLE",
      "line": 19,
      "description": "Unused import 'PyJWTError as JWTError' (imported but never used).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "535eccd138f4",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/auth.py",
      "category": "EXCEPTION_HANDLING",
      "line": 33,
      "description": "Potential unhandled LookupError: calling user_id_ctx.get() without a default may raise if the context var is unset.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ee3c845065c5",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/auth.py",
      "category": "LOGIC_ERRORS",
      "line": 58,
      "description": "Decoder await/try logic is inconsistent: the TypeError except block is redundant with the non-awaitable branch and will not correctly handle cases like a non-callable _jwt_decoder; it also re-invokes the decoder unnecessarily.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "06bf9882087d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/auth.py",
      "category": "EXCEPTION_HANDLING",
      "line": 59,
      "description": "JWT decoding errors (e.g., from PyJWT) are not caught or translated, likely resulting in 500 responses instead of a controlled auth error; 'JWTError' is imported but unused.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d9f43bfb40f0",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/auth.py",
      "category": "TYPE_ERRORS",
      "line": 60,
      "description": "Assumes the decoder returns a dict; if it returns an unexpected type, subsequent uses of claims.get(...) and item assignment will raise AttributeError/TypeError (see lines 69\u201390).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "69d39bcd16c7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/auth.py",
      "category": "SECURITY",
      "line": 65,
      "description": "Authorization is only enforced when config.core.env == 'prod'; any mismatch (e.g., 'production', case differences) would allow identity spoofing via headers in supposedly secure environments.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "140ac055ce69",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/auth.py",
      "category": "SECURITY",
      "line": 71,
      "description": "In non-'prod' environments, identity can be set from X-Tenant-ID and X-User-ID headers without verification, enabling easy spoofing if environment is misconfigured.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6dc105c0c5d7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/auth.py",
      "category": "LOGIC_ERRORS",
      "line": 81,
      "description": "Validates user_id as an email for any string value, including when derived from 'sub'; this may incorrectly flag non-email subjects and mutate claims with 'email_invalid'.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9c1e04eb6a56",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/auth.py",
      "category": "PERFORMANCE",
      "line": 61,
      "description": "Decoder is called twice on the same token in the TypeError except path, which can be expensive (e.g., signature verification) and introduces unnecessary work.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "def0fe96129f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/auth.py",
      "category": "TYPE_ERRORS",
      "line": 25,
      "description": "Public-facing FastAPI dependency get_current_user lacks a return type annotation, reducing type safety and clarity.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "866d92882506",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/defenses.py",
      "category": "EXCEPTION_HANDLING",
      "line": 34,
      "description": "Regex pattern uses a backreference (\\1) but there is no capturing group defined (only non-capturing groups are used), which will raise re.error: invalid group reference at runtime; no handling is present.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9414ce84a3c5",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/defenses.py",
      "category": "LOGIC_ERRORS",
      "line": 34,
      "description": "The tag-matching regex attempts to ensure the closing tag matches the opening tag via a backreference, but the opening tag name is inside a non-capturing group, so the intended logic cannot work; stripping of paired tags is therefore incorrect/unreliable.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f43373b49100",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/defenses.py",
      "category": "EXCEPTION_HANDLING",
      "line": 39,
      "description": "Using the supplied 'replacement' string directly in re.sub can cause errors if it contains backreference syntax (e.g., '\\1'), since these patterns have no capturing groups; this can raise 'invalid group reference' and is not handled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ddddd4263992",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/defenses.py",
      "category": "EXCEPTION_HANDLING",
      "line": 56,
      "description": "re.sub is called with dynamic patterns from 'jailbreak_patterns' and an arbitrary 'replacement'; if 'replacement' contains backreference escapes (e.g., '\\1'), the absence of capture groups in these patterns can raise 'invalid group reference' with no handling.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "42504e13d499",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/defenses.py",
      "category": "SECURITY",
      "line": 28,
      "description": "Truncating input before sanitization can cut tags or phrases mid-boundary, allowing crafted inputs (e.g., partial opening/closing tags) to evade the intended removal and undermine the stated prompt-injection mitigation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b3d2f2e8dcf3",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/defenses.py",
      "category": "STYLE",
      "line": 24,
      "description": "Silently returning an empty string for non-string input masks type errors and can hide upstream bugs; the function's annotation specifies str but invalid inputs are quietly coerced to an empty result.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c4fcdae41d33",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/test_injection_defense.py",
      "category": "TYPE_ERRORS",
      "line": 17,
      "description": "Parametrized case passes None to contains_injection; if the function expects a str, this can raise a TypeError rather than producing the asserted False, implicitly assuming Optional[str] support without a clear contract.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "777f4393859a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/test_injection_defense.py",
      "category": "LOGIC_ERRORS",
      "line": 34,
      "description": "The regex in pytest.raises uses a trailing '.' which is a regex wildcard, not a literal period; this can create false positives (matching any trailing character) and false negatives (if no trailing character exists), making the assertion logically unreliable.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b2cf31f32648",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/test_injection_defense.py",
      "category": "STYLE",
      "line": 34,
      "description": "Test assertion is brittle by matching the full error message including punctuation; small, non-semantic wording or punctuation changes will fail the test unnecessarily.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "38b9e2cf3ddc",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/dependencies.py",
      "category": "STYLE",
      "line": 6,
      "description": "Unused import: Optional is imported but never used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4535e140a3f9",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/dependencies.py",
      "category": "LOGIC_ERRORS",
      "line": 22,
      "description": "The None check for 'token' is effectively unreachable because HTTPBearer defaults to auto_error=True and will raise before this dependency is called when the Authorization header is missing or invalid.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2853b9ed6cd6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/dependencies.py",
      "category": "PERFORMANCE",
      "line": 17,
      "description": "Redundant work: HTTPBearer parses the Authorization header to produce 'token', but the result is not used and _extract_identity likely parses the header again from the Request, duplicating effort.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9e31dee2ab85",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/dependencies.py",
      "category": "EXCEPTION_HANDLING",
      "line": 32,
      "description": "Overly broad except Exception converts all unexpected errors (including programming errors) into HTTP 401 responses, potentially masking server-side issues and misclassifying errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b5838a3a1608",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/dependencies.py",
      "category": "EXCEPTION_HANDLING",
      "line": 33,
      "description": "Logging the exception message without stack trace (exc_info) loses critical debugging context and makes diagnosing failures difficult.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "87f0d4362581",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/dependencies.py",
      "category": "STYLE",
      "line": 30,
      "description": "Redundant catch-and-rethrow of HTTPException adds no behavior or context and unnecessarily complicates the control flow.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9f74472a89bd",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/dependencies.py",
      "category": "SECURITY",
      "line": 33,
      "description": "Logging raw exception messages from token validation may leak sensitive details (e.g., token contents or claims) into logs depending on the exception source.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "56d5649825b1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/dependencies.py",
      "category": "TYPE_ERRORS",
      "line": 18,
      "description": "Return type is annotated as dict[str, Any] but the code returns 'claims' without validating its type; if _extract_identity returns a non-dict or None, the declared contract is violated.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a20e6c45f1e9",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/dependencies.py",
      "category": "STYLE",
      "line": 8,
      "description": "Imports and relies on a private function (_extract_identity) from another module, creating tight coupling to internal implementation details.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5a44b4d4fbbb",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/dependencies.py",
      "category": "LOGIC_ERRORS",
      "line": 13,
      "description": "Potentially inconsistent HTTP status codes: HTTPBearer (auto_error=True) raises 403 for missing/invalid auth headers, while this function raises 401 for invalid/anonymous users, leading to inconsistent client-facing errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6f355f51088b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/dependencies.py",
      "category": "STYLE",
      "line": 17,
      "description": "The 'token' parameter is effectively unused in the function logic beyond the unreachable None check, suggesting dead/vestigial code.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d613ab860d77",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/injection_defense.py",
      "category": "TYPE_ERRORS",
      "line": 56,
      "description": "contains_injection is annotated to accept str but effectively allows None or other falsy non-str values due to 'if not text', masking invalid types and violating the type contract.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "832f7dd40acb",
      "status": "resolved",
      "resolution": "contains_injection enforces string input",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/injection_defense.py",
      "category": "NULL_SAFETY",
      "line": 67,
      "description": "Returning False when text is None means validate_for_injection will not raise for missing input, allowing a bypass if upstream passes None.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "18623ecdc5a4",
      "status": "resolved",
      "resolution": "None inputs raise TypeError",
      "validation_method": "validation_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/injection_defense.py",
      "category": "TYPE_ERRORS",
      "line": 77,
      "description": "Public function validate_for_injection lacks a return type annotation, reducing type clarity for consumers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "68ecbf6612d2",
      "status": "resolved",
      "resolution": "validate_for_injection annotated",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/injection_defense.py",
      "category": "LOGIC_ERRORS",
      "line": 20,
      "description": "Regex pattern uses '.*' without DOTALL; multi-line inputs with a newline after 'you are now a/an' will not match, creating false negatives.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "bf62fe6694c4",
      "status": "resolved",
      "resolution": "pattern updated for multiline matching",
      "validation_method": "pattern_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/injection_defense.py",
      "category": "SECURITY",
      "line": 15,
      "description": "Reliance on a static regex blocklist is inherently bypassable; adversaries can rephrase, obfuscate, or use variants not covered by the patterns, leaving gaps in injection defense.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7f73b7d2ca80",
      "status": "resolved",
      "resolution": "keyword heuristic added alongside blocklist",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/injection_defense.py",
      "category": "SECURITY",
      "line": 72,
      "description": "Logging the exact matched pattern ('pattern=pattern.pattern') may disclose detection heuristics; if logs are exposed, this can aid adversarial adaptation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d068a5f92149",
      "status": "resolved",
      "resolution": "logs omit exact pattern text",
      "validation_method": "logging_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/injection_defense.py",
      "category": "LOGIC_ERRORS",
      "line": 47,
      "description": "Overly broad patterns like 'print the following'/'output the following' are likely to flag benign content, leading to high false-positive rates.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b0a8788d84f8",
      "status": "resolved",
      "resolution": "print/output pattern narrowed",
      "validation_method": "pattern_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/injection_defense.py",
      "category": "STYLE",
      "line": 4,
      "description": "Docstring claims the module 'neutralizes' injections, but implementation only detects and raises; documentation does not match behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3df3e3451b5e",
      "status": "resolved",
      "resolution": "docstring reflects detection behavior",
      "validation_method": "doc_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/injection_defense.py",
      "category": "STYLE",
      "line": 28,
      "description": "Overlapping patterns ('you are now' alongside 'you are now (?:a|an) .*') introduce redundancy and increase maintenance complexity.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "797b63f65221",
      "status": "resolved",
      "resolution": "redundant pattern removed",
      "validation_method": "pattern_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/injection_defense.py",
      "category": "SECURITY",
      "line": 53,
      "description": "Case-insensitive regex without input normalization leaves room for mixed-script, normalization, or additional homoglyph bypasses; only a single homoglyph variant is covered.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a470593ab44f",
      "status": "resolved",
      "resolution": "unicode normalization and homoglyph mapping added",
      "validation_method": "normalization_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/injection_defense.py",
      "category": "PERFORMANCE",
      "line": 70,
      "description": "Sequentially evaluating all compiled regexes for every call is O(N_patterns * input_length); under large inputs or high throughput this can become a bottleneck.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5d3ac2a45467",
      "status": "resolved",
      "resolution": "single compiled regex used",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/security/injection_defense.py",
      "category": "EXCEPTION_HANDLING",
      "line": 88,
      "description": "validate_for_injection raises a generic ValueError, which may be caught unintentionally and loses security context compared to a more specific exception type.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e600d3f4e6e2",
      "status": "resolved",
      "resolution": "SecurityError raised for injection",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/models.py",
      "category": "STYLE",
      "line": null,
      "description": "Unused imports detected: socket, ip_address, urlparse, Optional.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "91c9088d59d2",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/models.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "_env swallows ValueError/TypeError during type conversion and silently returns the default, masking misconfiguration and making failures hard to diagnose.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9107a14c3aec",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/models.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "ProcessingConfig.overlap_less_than_size uses a field-level validator to compare chunk_overlap against chunk_size; in Pydantic v2 sibling field order/availability is not guaranteed for field validators, so this cross-field check may be unreliable or skipped.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "95a33b59fb6b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/models.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "Incorrect decorator stacking on overlap_less_than_size: combining @field_validator with @classmethod can prevent proper validator registration in Pydantic v2 (validators should not be additionally decorated as classmethods).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7ba71c8c609c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/models.py",
      "category": "STYLE",
      "line": null,
      "description": "Inconsistent extra field policy: several models forbid extra fields (extra='forbid') while DatabaseConfig and DigitalOceanScalerConfig do not, leading to inconsistent handling of unexpected configuration.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "dba644836b30",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/models.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "Weak typing/validation on URL-like fields: StorageConfig.endpoint_url, DatabaseConfig.url, and RedisConfig.url are plain strings rather than URL/DSN types (e.g., AnyHttpUrl/AnyUrl/RedisDsn), allowing invalid values to pass validation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "460e9b745687",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/models.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "Critical credential fields are optional with no validation (e.g., StorageConfig.access_key/secret_key, RedisConfig.password, DigitalOceanScalerConfig.token/ids), risking None values that may cause runtime errors when used downstream.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "53c7f4238096",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/models.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "DigitalOceanScalerConfig lacks cross-field validation such as ensuring min_nodes <= max_nodes, permitting logically invalid configurations.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1909d35bfcf6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/models.py",
      "category": "SECURITY",
      "line": null,
      "description": "Sensitive secrets (S3 secret_key/access_key, Redis password, DigitalOcean token) are stored as plain strings instead of secret types (e.g., SecretStr), increasing the risk of accidental logging or exposure.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9bafa0308eda",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/models.py",
      "category": "STYLE",
      "line": null,
      "description": "env_default helper is defined but unused within this module, which may indicate dead code in this file.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c85967512256",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/models.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "CoreConfig.env allows both 'prod' and 'production' without normalization, which can lead to inconsistent environment checks elsewhere.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b2561d20ebaf",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "Status comparison uses the redacted placeholder (\"***REDACTED***\") instead of the underlying value; for sensitive keys this can produce false MISMATCH statuses and misleading results.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a3fe8888f057",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "_normalize_value lowercases values before comparison. Many configuration values are case-sensitive (e.g., secrets, IDs, filesystem paths), so this may incorrectly treat different values as equal or vice versa.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2fc8675c8427",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "The comparison only considers values from the .env file and ignores process environment variables (os.environ), potentially missing active overrides and leading to incomplete or misleading audits.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7c4768a469dd",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "_get_env_value applies prefixes to the provided key even if the key already contains a prefix, then falls back to the original key. Combined with app_keys selection, this causes prefixed env vars to be treated as separate keys and labeled ENV_ONLY instead of being matched to their unprefixed model keys.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c1c894bb686f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "parse_models_via_introspection assumes models._env and models._env_list exist; accessing these attributes will raise AttributeError if they are missing, and this is not handled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b5ea04292d93",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "parse_models_via_introspection swallows all exceptions during model instantiation (except Exception: continue), hiding real errors and producing silently incomplete definitions.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e7be181fb2ff",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "parse_env_file only guards for missing files; open() can raise PermissionError/OSError which will terminate execution unhandled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0dab4835de9e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "Import of cortex.config.models is unguarded; ImportError (e.g., due to incorrect sys.path or missing package) will crash the script without a clear message or recovery.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3ad55932b9fe",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "SECURITY",
      "line": null,
      "description": "Secret redaction relies on a small set of substrings (key, secret, password, token, url, credentials). Secrets stored under other names (e.g., auth, jwt, private, cert) will be printed in clear text, risking sensitive data leakage.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fe160e5a240d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "SECURITY",
      "line": null,
      "description": "The script mutates sys.path based on a discovered directory structure. If executed from an untrusted directory that mimics the expected layout, it could import unintended modules (import hijacking risk).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c921ba81741e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "The mocked _env_list returns the provided default (often a string) while recording type as list, which can violate expected types during Pydantic validation and skew captured defaults.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ce8e6de2f55b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "STYLE",
      "line": null,
      "description": "Monkey-patching private internals (models._env, models._env_list) depends on non-public API and is brittle; changes to the models module will break the approach silently.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8b8519a10e6f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "STYLE",
      "line": null,
      "description": "setup_sys_path is executed at import time and calls sys.exit(1) on failures, making the module non-import-friendly and causing hard exits in contexts that import it.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6846faa33922",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/audit_config.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "Minor: app_keys is converted to a list and then re-sorted, performing redundant sorting work.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6951ab35ac4f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/loader.py",
      "category": "SECURITY",
      "line": null,
      "description": "SECRET_KEY falls back to a hardcoded default ('dev-secret-key-change-in-production') if OUTLOOKCORTEX_SECRET_KEY is unset, creating an insecure default in production.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "aadeb1d70e06",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/loader.py",
      "category": "NULL_SAFETY",
      "line": null,
      "description": "update_environment assigns many environment variables unconditionally (e.g., SENDER_LOCKED_NAME, S3_ENDPOINT, S3_BUCKET_RAW, S3_REGION, LOG_LEVEL, OUTLOOKCORTEX_DB_URL, DO_LLM_*), which will raise a TypeError if any corresponding config value is None (os.environ requires str).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5bcba421ad8a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/loader.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "Environment variable writes in update_environment assume string types; if any config field is not a string (e.g., optional fields or non-str types), os.environ assignment will fail at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4aa537f87dbe",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/loader.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "update_environment is documented to update environment variables from the config, but it also reads environment variables to override and mutate the config\u2019s processing fields, leading to surprising side effects and non-idempotent behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f11c1ef5c615",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/loader.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "EmailOpsConfig.load(path): When the config JSON validates syntactically but fails schema validation (pydantic.ValidationError), the exception is unhandled and will propagate, despite the function\u2019s intent to provide defaults.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0bdce24b635d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/loader.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "EmailOpsConfig.load(path): For the case where path exists, non-JSON-related I/O errors (e.g., PermissionError/OSError while opening/reading) are not handled, causing unhandled exceptions.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "da404e9f0a6e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/loader.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "In the JSONDecodeError branch, creating the default configuration (cls()) is not wrapped; if default construction fails due to environment-driven validation errors, the exception will propagate.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f58cf181e648",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/loader.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "EmailOpsConfig.load docstring claims \"loads from JSON file with env overrides\" but the implementation does not apply environment overrides to the loaded JSON (it just validates the JSON), which may mislead users and result in unexpected behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ae438d918ba6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/loader.py",
      "category": "SECURITY",
      "line": null,
      "description": "to_dict returns the full configuration without redaction, potentially exposing sensitive values (e.g., S3 keys, tokens) if serialized, logged, or shown in a UI.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d60bffc3c956",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/loader.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "set_rls_tenant does not handle database execution errors (e.g., invalid/closed connection, SQLAlchemy exceptions); these will propagate unhandled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4a2c3612d47a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/loader.py",
      "category": "STYLE",
      "line": null,
      "description": "Property name SECRET_KEY uses uppercase, which is unconventional for instance attributes/properties and can be confused with a module-level constant.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3b9163a49a64",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/loader.py",
      "category": "STYLE",
      "line": null,
      "description": "Module-level side effect load_dotenv() runs on import, which can cause unexpected behavior in library contexts and complicate testing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ad3099dc0452",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/config/loader.py",
      "category": "SECURITY",
      "line": null,
      "description": "update_environment propagates credentials (e.g., S3_ACCESS_KEY, S3_SECRET_KEY, DIGITALOCEAN_TOKEN) into process environment variables, increasing the exposure surface (e.g., to child processes).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "666009e50a03",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tests/chunker_test.py",
      "category": "LOGIC_ERRORS",
      "line": 66,
      "description": "With preserve_sentences=True, the expected first chunk includes a partial sentence (\"This is the third sentence\") without terminal punctuation, and the second chunk duplicates part of that sentence (\" the third sentence...\"). This contradicts the stated intent to split at sentence boundaries and suggests inconsistent or incorrect expectations.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d84b7f95cef8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tests/chunker_test.py",
      "category": "LOGIC_ERRORS",
      "line": 73,
      "description": "quoted_spans uses Span(start=29, end=50) for text \"This is a normal sentence. [QUOTE] This is a quote. [/QUOTE]\"; index 29 falls inside the \"[QUOTE]\" marker and 50 ends at the period of \"quote.\" before the closing tag. This span does not align with the quoted content boundaries, risking misclassification and flaky behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ba8edab9b517",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tests/chunker_test.py",
      "category": "STYLE",
      "line": 38,
      "description": "Brittle exact-string and character-offset assertions for chunks (lines 38\u201348) rely on specific tokenization, whitespace, and punctuation handling. Minor implementation changes (e.g., trimming or different tokenization rules) will cause false negatives.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "714d97127314",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tests/chunker_test.py",
      "category": "STYLE",
      "line": 21,
      "description": "Asserting exact char_end == len(text) (and similar strict offsets elsewhere) is a magic-number style assertion that couples tests to internal slicing conventions (exclusive vs inclusive) and whitespace handling, making tests fragile.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0b300ccad06b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tests/chunker_test.py",
      "category": "STYLE",
      "line": 68,
      "description": "Expected chunk texts include leading spaces (e.g., \" the third sentence...\") which makes the test sensitive to whitespace normalization or trimming behavior, increasing brittleness.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9f6ab11438dc",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tests/chunker_test.py",
      "category": "STYLE",
      "line": 85,
      "description": "The quoted span test only checks that both \"message_body\" and \"quoted_history\" appear somewhere, not that they are correctly aligned to the intended ranges or that all chunks are classified properly. This weak assertion can pass despite misclassifications.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f3fd05b81c2b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tests/test_validation_last_message.py",
      "category": "LOGIC_ERRORS",
      "line": 11,
      "description": "Using Path(__file__).resolve().parents[2] assumes a fixed directory depth; if the file is moved or layout changes this may select the wrong directory or raise IndexError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d21a36896add",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tests/test_validation_last_message.py",
      "category": "STYLE",
      "line": 13,
      "description": "Modifying sys.path at import time introduces global side effects across the test session and can mask packaging/import issues.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f00a14b7a0f9",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tests/test_validation_last_message.py",
      "category": "STYLE",
      "line": 11,
      "description": "Variable name 'project_root' is misleading; it actually points to the 'src' directory rather than the project root, reducing readability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "53e85ece5284",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tests/test_validation_last_message.py",
      "category": "PERFORMANCE",
      "line": 37,
      "description": "Calling scan_and_refresh on temp_convo_dir.parent broadens the scan scope and can degrade performance if the parent directory contains additional entries.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "843b27adf77b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tests/test_validation_last_message.py",
      "category": "TYPE_ERRORS",
      "line": 59,
      "description": "Assumes report.problems is an iterable of objects exposing an 'issue' attribute; if the API returns dicts or a different structure, this will raise AttributeError/TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "49d52d71ddcb",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/embeddings/client.py",
      "category": "STYLE",
      "line": 10,
      "description": "Unused import: Optional is imported from typing but never used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "674b8a9ce016",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/embeddings/client.py",
      "category": "TYPE_ERRORS",
      "line": 42,
      "description": "embed_texts assumes each item in 'texts' is a str and calls .strip(); if a truthy non-string (e.g., int) is present, this will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "207b1e4ba5e6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/embeddings/client.py",
      "category": "EXCEPTION_HANDLING",
      "line": 52,
      "description": "No error handling around _embed_texts(); any exception from the LLM runtime will propagate and prevent returning a shaped fallback result.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b19c9f208ea7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/embeddings/client.py",
      "category": "TYPE_ERRORS",
      "line": 60,
      "description": "Accessing embeddings_array.size assumes _embed_texts returns a numpy.ndarray; if it returns a list or other sequence, this will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f1c650c0de4f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/embeddings/client.py",
      "category": "TYPE_ERRORS",
      "line": 65,
      "description": "Calling embeddings_array.tolist() assumes a numpy.ndarray return; if _embed_texts returns an already-materialized list, .tolist() will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "432812688af6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/embeddings/client.py",
      "category": "LOGIC_ERRORS",
      "line": 61,
      "description": "The shape check compares len(embeddings_array) to the number of input texts; if a single input yields a 1D vector (shape (d,)), len(embeddings_array) == d, causing the code to incorrectly treat it as failure and return empty embeddings.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3254b84cef53",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/embeddings/client.py",
      "category": "STYLE",
      "line": 20,
      "description": "Docstring claims the class is a singleton, but instantiation is not restricted; this can be misleading and out of sync with actual behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ae2e7426d5d1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tools/search.py",
      "category": "TYPE_ERRORS",
      "line": 18,
      "description": "Parameter 'args' is annotated as a union of two non-Optional types, yet the function explicitly checks for None; this is inconsistent with the type signature and may mislead type checkers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b059b2c6ec20",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tools/search.py",
      "category": "EXCEPTION_HANDLING",
      "line": 23,
      "description": "Raises ValueError for invalid input despite the function\u2019s declared Result[SearchResults, RetrievalError] return contract; this introduces an unexpected exception type and bypasses the Result-based error channel.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cb94440c3c60",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tools/search.py",
      "category": "EXCEPTION_HANDLING",
      "line": 25,
      "description": "If 'args' is neither of the expected types and lacks 'to_tool_input', an AttributeError will be raised and is not handled, potentially leaking an unintended exception from this API.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "93c24b39e7be",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/tools/search.py",
      "category": "STYLE",
      "line": 14,
      "description": "Redundant alias 'RetrievalKBSearchInput = HybridSearchInput' adds indirection without clear benefit and can reduce readability by duplicating the same type under multiple names.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1f1b6779f74c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/prompts/__init__.py",
      "category": "SECURITY",
      "line": 56,
      "description": "construct_prompt_messages formats the system_prompt_template with **kwargs, allowing untrusted/user-controlled values to be injected into the 'system' role content, undermining the stated role separation and increasing prompt-injection risk.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a158f7b5da3e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/prompts/__init__.py",
      "category": "EXCEPTION_HANDLING",
      "line": 56,
      "description": "String formatting with .format(**kwargs) can raise KeyError/ValueError (e.g., missing placeholders or bad format specs) for both system and user templates; no handling is present, so calls may crash at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e5d6f3ff58e6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/prompts/__init__.py",
      "category": "TYPE_ERRORS",
      "line": 37,
      "description": "Return annotation uses built-in generics (list[...], dict[...]) which require Python 3.9+; this is incompatible with older runtimes if those are still targeted.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "beb7cf979329",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/prompts/__init__.py",
      "category": "TYPE_ERRORS",
      "line": 348,
      "description": "The annotation dict[str, str] | None uses PEP 604 union syntax requiring Python 3.10+; incompatible with older Python versions if supported.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ef915fd05857",
      "status": "resolved",
      "resolution": "runtime supports PEP 604 unions",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/prompts/__init__.py",
      "category": "STYLE",
      "line": 348,
      "description": "get_prompt defines an unused parameter 'prompts'; retaining unused parameters adds confusion and noise.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5b4c537e5f54",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/prompts/__init__.py",
      "category": "STYLE",
      "line": 332,
      "description": "Deprecated PROMPT_* constants are set to the literal string 'DEPRECATED' while comments say they are kept to avoid breaking the app; this mismatch between comments and behavior can mislead maintainers and degrade functionality where these constants are still referenced.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c7c429275451",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/prompts/__init__.py",
      "category": "SECURITY",
      "line": 363,
      "description": "get_prompt returns a string embedding raw kwargs (via f-string), which may inadvertently expose sensitive data if this shim output is logged or surfaced to unintended contexts.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "492956583b5e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/models.py",
      "category": "TYPE_ERRORS",
      "line": 45,
      "description": "Uses PEP 604 union syntax (str | None), which is invalid on Python < 3.10; this creates a hard dependency on Python 3.10+.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "28dc93e2635d",
      "status": "resolved",
      "resolution": "runtime supports PEP 604 unions",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/models.py",
      "category": "TYPE_ERRORS",
      "line": 23,
      "description": "Uses built-in generics (dict[str, Any] and list[Problem]) which require Python 3.9+; this is a version-compatibility risk on older interpreters.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7ea214176538",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/models.py",
      "category": "LOGIC_ERRORS",
      "line": 29,
      "description": "Count fields (messages_* , attachments_*, folders_processed, threads_created, chunks_created, embeddings_generated, errors, skipped) are unconstrained ints, allowing negative values and invalid states.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1df3fa445b2d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/models.py",
      "category": "LOGIC_ERRORS",
      "line": 29,
      "description": "No cross-field validation to ensure consistency (e.g., messages_ingested + messages_failed <= messages_total; attachments_parsed + attachments_failed <= attachments_total), allowing impossible summaries.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f1b5215368f2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/models.py",
      "category": "LOGIC_ERRORS",
      "line": 18,
      "description": "Pydantic models do not specify handling for extra/unknown fields; with default settings, unexpected fields may be silently ignored, potentially masking client input errors (applies to IngestJobRequest and IngestJobSummary).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "224652ff1729",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "STYLE",
      "line": 13,
      "description": "Unused import: os.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1052b21f5277",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "STYLE",
      "line": 22,
      "description": "Unused import: Optional from typing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c11af18dff09",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "LOGIC_ERRORS",
      "line": 141,
      "description": "list_conversation_folders groups by the immediate parent folder using rsplit('/', 1), which will split nested subdirectories (e.g., attachments) into separate 'folders' instead of grouping everything under the top-level conversation folder.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5ab7f2cfa4ad",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "LOGIC_ERRORS",
      "line": 153,
      "description": "limit handling relies on truthiness checks (e.g., 'if limit and ...' and 'if not limit or ...'), causing limit=0 to be treated as 'no limit' and yielding results unexpectedly.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6142aaf13da7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "LOGIC_ERRORS",
      "line": 171,
      "description": "Final-yield condition also uses truthiness for limit, so a limit of 0 still yields the last folder, contradicting the intended meaning of limit=0 (no results).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cd10742d1907",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "EXCEPTION_HANDLING",
      "line": 94,
      "description": "close() swallows all exceptions without logging, potentially hiding important cleanup failures or API incompatibilities (e.g., client lacking close()).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "67c7187bd5bf",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "EXCEPTION_HANDLING",
      "line": 297,
      "description": "conversation_exists() catches all exceptions and returns False, masking network/auth/permission errors as 'does not exist' and making failures hard to diagnose.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9b41b519ac99",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "EXCEPTION_HANDLING",
      "line": 263,
      "description": "get_object_content() reads from the StreamingBody without explicitly closing it, which can lead to connection/socket leaks or delayed resource release in long-running processes.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b61b729831d4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "EXCEPTION_HANDLING",
      "line": 269,
      "description": "get_json_object() may raise ClientError (S3), UnicodeDecodeError, or parsing errors from parse_manifest_text; these are unhandled, which can cause unexpected crashes during ingestion.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d8dff1369950",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "EXCEPTION_HANDLING",
      "line": 276,
      "description": "get_text_object() may raise ClientError (S3) or UnicodeDecodeError; exceptions are unhandled, potentially crashing the flow.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "71445f857d2e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "PERFORMANCE",
      "line": 121,
      "description": "list_conversation_folders paginates without using a Delimiter, forcing traversal of all nested keys even if only top-level conversation folders are desired, increasing API calls and processing time.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5713ab1b2823",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "STYLE",
      "line": 126,
      "description": "Docstring says default prefix is 'raw/outlook/' while the code default is 'Outlook/'; documentation mismatch can mislead users and maintainers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "181563cd0bda",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "TYPE_ERRORS",
      "line": 36,
      "description": "Use of the '|' union operator in type annotations (e.g., 'datetime | None') requires Python 3.10+; this reduces compatibility with Python 3.9 and earlier.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fad8d13432d7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/s3_source.py",
      "category": "NULL_SAFETY",
      "line": 57,
      "description": "No validation that critical connection parameters (endpoint_url, region, bucket) are non-empty before creating/using the client, risking None values propagating to boto3 and causing hard-to-trace runtime errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f2f07a91a48e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/quoted_masks.py",
      "category": "TYPE_ERRORS",
      "line": 48,
      "description": "Assumes Span is mutable by assigning to current_span.end; if Span is a namedtuple or frozen dataclass, this will raise an AttributeError at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fdb0468cdfda",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/quoted_masks.py",
      "category": "TYPE_ERRORS",
      "line": 61,
      "description": "Mutates span.end during trailing-whitespace consumption; relies on Span having writable attributes, which may not hold depending on its implementation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3ae3ab21709a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/quoted_masks.py",
      "category": "LOGIC_ERRORS",
      "line": 23,
      "description": "QUOTE_PATTERNS uses broad alternatives (e.g., 'Subject: .*', 'Sent: .*', 'From: .*@.*', 'To: .*@.*', 'On .* wrote:') that can match legitimate non-quoted content lines in the body, leading to false positives and over-masking.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "826143c47ab3",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/quoted_masks.py",
      "category": "STYLE",
      "line": 23,
      "description": "The alternation group in the regex is a capturing group though its captures are never used; a non-capturing group (?:...) would avoid unnecessary capturing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "dce1bbf0c1d3",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments.py",
      "category": "LOGIC_ERRORS",
      "line": 149,
      "description": "Using `max_chars or limits.max_attachment_text_chars` treats 0 as falsy and ignores an explicit `max_chars=0`, which may not be intended if 0 is a meaningful limit.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ea9f02509a03",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments.py",
      "category": "TYPE_ERRORS",
      "line": 149,
      "description": "`max_chars` passed to `extract_attachment_text` can be `None` if both inputs are `None`, contradicting the parameter's `int` type annotation and potentially breaking downstream use.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "750397e402aa",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments.py",
      "category": "LOGIC_ERRORS",
      "line": 132,
      "description": "Path validation allows `attachment_path == upload_dir`, permitting a directory to pass as a valid attachment, which can lead to attempts to process a directory as a file.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "58686d87c0e0",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments.py",
      "category": "EXCEPTION_HANDLING",
      "line": 126,
      "description": "Potential `AttributeError` from `config.directories.local_upload_dir` is not caught by the current exception handler (only TypeError/ValueError/FileNotFoundError are handled).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7d142b7d998c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments.py",
      "category": "EXCEPTION_HANDLING",
      "line": 145,
      "description": "Accessing `config.limits` (and its attributes) is not guarded; a missing attribute would raise `AttributeError` and is not handled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "31ef9850fa28",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments.py",
      "category": "EXCEPTION_HANDLING",
      "line": 101,
      "description": "Broad `except Exception` converts unexpected errors into `None`, which can mask non-I/O failures and make error propagation/handling by callers impossible (despite being logged).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1f5a3001d5fc",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments.py",
      "category": "SECURITY",
      "line": 134,
      "description": "Critical log message includes the resolved filesystem paths, which may disclose sensitive server filesystem details in logs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ac325c6b8ac1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments.py",
      "category": "SECURITY",
      "line": 163,
      "description": "Including `source_path` (full filesystem path) in returned metadata can leak internal filesystem structure to downstream systems/consumers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c3a5128c87f2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments.py",
      "category": "NULL_SAFETY",
      "line": 159,
      "description": "`get_text_preprocessor()` is assumed to return a valid object; if it returns `None` or an unexpected type, `.prepare_for_indexing` will raise at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "609be84682c9",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments.py",
      "category": "PERFORMANCE",
      "line": 92,
      "description": "CPU-bound text extraction is dispatched to the default thread pool via `asyncio.to_thread`, which can degrade performance under load and contend with the event loop if extraction is heavy (e.g., OCR).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "01129aac43e7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments.py",
      "category": "STYLE",
      "line": 13,
      "description": "Unused import: `Optional` is imported but not used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cb1431df1ad0",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/text_preprocessor.py",
      "category": "LOGIC_ERRORS",
      "line": null,
      "description": "No handling/validation for unexpected text_type values; values other than 'email' or 'attachment' silently skip type-specific cleaning while still being recorded in metadata, which can produce inconsistent processing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e64c5d2ff622",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/text_preprocessor.py",
      "category": "STYLE",
      "line": null,
      "description": "Documentation mismatch: class/process comments describe an order including whitespace normalization and control character stripping that differs from the implementation (control chars are stripped first; whitespace normalization is only applied for 'attachment'). This can mislead maintainers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ecaf2643dde7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/text_preprocessor.py",
      "category": "STYLE",
      "line": null,
      "description": "Unused imports/variables: logging/logger is defined but never used; typing.Optional is imported but unused.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e827b24cd83f",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/text_preprocessor.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "Unprotected configuration attribute access in _redact_pii: assumes get_config() returns an object with .pii.enabled; missing guards can raise AttributeError if configuration shape differs or keys are absent.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c7e4f8557104",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/text_preprocessor.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "Assumes attribute-style access on config (config.pii.enabled); if get_config() returns a dict-like structure rather than an object with attributes, this will fail at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7c22569bb9fd",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/text_preprocessor.py",
      "category": "TYPE_ERRORS",
      "line": null,
      "description": "No runtime type validation on inputs: prepare_for_indexing assumes 'text' is str and 'metadata' is a mapping; passing None or wrong types will cause TypeError in strip_control_chars, len(), or dict.copy().",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2167a70ddd23",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/text_preprocessor.py",
      "category": "EXCEPTION_HANDLING",
      "line": null,
      "description": "External calls (strip_control_chars, clean_email_text, re.sub, redact_pii) are not wrapped; any exception from these dependencies will bubble up and may disrupt ingestion without contextual logging or handling.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5e82a11e5d6d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/text_preprocessor.py",
      "category": "PERFORMANCE",
      "line": null,
      "description": "get_config() is called on every invocation of _redact_pii; if configuration loading is non-trivial, this introduces avoidable overhead in high-throughput preprocessing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f562034050c5",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/text_preprocessor.py",
      "category": "STYLE",
      "line": null,
      "description": "Comment 'PII redaction (placeholder)' is outdated/inaccurate given a real redaction step is implemented, leading to confusion about maturity of the feature.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ca715fcc7be7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments_log.py",
      "category": "SECURITY",
      "line": 54,
      "description": "Possible symlink traversal: only convo_dir is validated against base_dir; csv_path itself is not validated after resolution. If 'attachments' or 'attachments_log.csv' is a symlink, open() may read files outside the secure base directory.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "88062d73b716",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments_log.py",
      "category": "SECURITY",
      "line": 48,
      "description": "TOCTOU race between existence check and file open: p.exists() is checked before open(), allowing the target to be swapped (e.g., via symlink) between the check and the use.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "25369ff90165",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments_log.py",
      "category": "EXCEPTION_HANDLING",
      "line": 54,
      "description": "UnicodeDecodeError during file reading is not handled; try/except only catches OSError and csv.Error, so a decoding failure will propagate and crash the caller.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1da9a3b2ce99",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments_log.py",
      "category": "EXCEPTION_HANDLING",
      "line": 74,
      "description": "Errors during parsing are downgraded to a warning and the function returns potentially empty/partial results, which can mask ingestion failures without signaling the caller.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "94bd804513ec",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments_log.py",
      "category": "PERFORMANCE",
      "line": 71,
      "description": "Logging uses f-strings, incurring string formatting cost even when the log level is disabled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2acc9e555063",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments_log.py",
      "category": "PERFORMANCE",
      "line": 75,
      "description": "Warning log also uses an f-string, incurring formatting cost regardless of log level.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5ae8f5614b44",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/ingestion/attachments_log.py",
      "category": "TYPE_ERRORS",
      "line": 16,
      "description": "Return type annotation uses PEP 585 built-in generics (dict[str, ...]) which require Python 3.9+; importing this module on older Python versions will fail.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "68899115f5d0",
      "status": "resolved",
      "resolution": "runtime supports built-in generics",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/llm/client.py",
      "category": "EXCEPTION_HANDLING",
      "line": 14,
      "description": "Dynamic import of 'cortex.llm.runtime' at module import time is unguarded; if the runtime module is missing or fails to import, it will raise and prevent any import of this module.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9d514e97640e",
      "status": "resolved",
      "resolution": "runtime import deferred to call time",
      "validation_method": "import_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/llm/client.py",
      "category": "TYPE_ERRORS",
      "line": 22,
      "description": "Type annotation 'list[str]' requires Python 3.9+; on older Python versions this is a syntax error, creating a portability risk.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fd50e7e3af4c",
      "status": "resolved",
      "resolution": "runtime supports built-in generics",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/llm/client.py",
      "category": "TYPE_ERRORS",
      "line": 17,
      "description": "Module-level __getattr__ returns Any and forwards arbitrary attributes dynamically, leaving the public API effectively untyped and opaque to static type checkers and IDEs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b5616ba034d3",
      "status": "resolved",
      "resolution": "explicit typed wrappers replace dynamic getattr",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "backend/src/cortex/llm/client.py",
      "category": "STYLE",
      "line": 22,
      "description": "The proxy exposes the entire runtime module surface (including underscored/private names via __dir__), making the public API broad and potentially leaking internal implementation details.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "dccfdfed2b20",
      "status": "resolved",
      "resolution": "explicit exports replace dynamic proxy",
      "validation_method": "style_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/s3_check.py",
      "category": "EXCEPTION_HANDLING",
      "line": 40,
      "description": "sample_size is not validated; negative or non-integer values can cause random.sample to raise ValueError/TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2953ff8b8611",
      "status": "resolved",
      "resolution": "sample_size normalized",
      "validation_method": "validation_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/s3_check.py",
      "category": "EXCEPTION_HANDLING",
      "line": 24,
      "description": "S3SourceHandler() initialization may raise exceptions (e.g., credential/config errors) that are not handled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9b5517b4bf44",
      "status": "resolved",
      "resolution": "S3 handler init guarded",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/s3_check.py",
      "category": "EXCEPTION_HANDLING",
      "line": 29,
      "description": "handler.list_conversation_folders may raise I/O or network-related exceptions that are not handled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5eee2875e0f6",
      "status": "resolved",
      "resolution": "folder listing errors handled",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/s3_check.py",
      "category": "EXCEPTION_HANDLING",
      "line": 46,
      "description": "handler.list_files_in_folder may raise exceptions (e.g., network/S3 errors) that are not handled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fa1b047bf014",
      "status": "resolved",
      "resolution": "file listing errors handled",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/s3_check.py",
      "category": "TYPE_ERRORS",
      "line": 42,
      "description": "Variable annotated as dict[str, dict[str, list[str]]] but assigned a defaultdict; incompatible with the annotation under static type checkers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c444dab84ba9",
      "status": "resolved",
      "resolution": "runtime supports built-in generics",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/s3_check.py",
      "category": "TYPE_ERRORS",
      "line": 30,
      "description": "Assumes each item from list_conversation_folders has a .name attribute; if items are strings or differently shaped objects, this will raise AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0fbd75f31ab0",
      "status": "resolved",
      "resolution": "folder names normalized safely",
      "validation_method": "null_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/s3_check.py",
      "category": "LOGIC_ERRORS",
      "line": 51,
      "description": "Uses startswith for file checks, which can yield false positives (e.g., 'Conversation.txt.bak' satisfies 'Conversation.txt').",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1a900ea4a742",
      "status": "resolved",
      "resolution": "exact file presence checks used",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/s3_check.py",
      "category": "LOGIC_ERRORS",
      "line": 45,
      "description": "Path concatenation assumes folder_name lacks prefix and trailing slash; if folder.name already includes them, resulting prefix may be malformed (duplicated prefix or double slashes).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "50f6fc78c88b",
      "status": "resolved",
      "resolution": "folder prefixes normalized",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/s3_check.py",
      "category": "PERFORMANCE",
      "line": 40,
      "description": "Sorting the entire folder set before sampling is unnecessary overhead and increases time complexity.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a37761fb0d59",
      "status": "resolved",
      "resolution": "sampling avoids full sort",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/s3_check.py",
      "category": "PERFORMANCE",
      "line": 48,
      "description": "For each expected element, scans all keys with a startswith check (O(E*K) per folder), which may be inefficient for large key lists.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5fa7d9bb1079",
      "status": "resolved",
      "resolution": "key lookups use set membership",
      "validation_method": "perf_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/s3_check.py",
      "category": "STYLE",
      "line": 35,
      "description": "Inconsistent type for 'issues' across code paths: returns a plain dict when empty but a defaultdict when non-empty, which can surprise consumers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8c6e9300fd14",
      "status": "resolved",
      "resolution": "issues type is consistent",
      "validation_method": "style_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_backfill.py",
      "category": "EXCEPTION_HANDLING",
      "line": 22,
      "description": "sys.argv is reassigned and only restored after a successful call to backfill_main; if backfill_main raises, sys.argv remains modified (missing cleanup).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0d5e49ed3fbb",
      "status": "resolved",
      "resolution": "sys.argv mutation removed",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_backfill.py",
      "category": "EXCEPTION_HANDLING",
      "line": 34,
      "description": "Catching broad Exception swallows the traceback and detailed context, making debugging difficult; only the exception message is printed before exiting.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f9d22dedb5c5",
      "status": "resolved",
      "resolution": "traceback printed on failure",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_backfill.py",
      "category": "EXCEPTION_HANDLING",
      "line": 31,
      "description": "ImportError is caught and only the message is printed, which can mask nested import failures by losing the full traceback.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "925000172614",
      "status": "resolved",
      "resolution": "import errors include traceback",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_backfill.py",
      "category": "EXCEPTION_HANDLING",
      "line": 34,
      "description": "SystemExit from backfill_main is not caught (it derives from BaseException, not Exception), so it can terminate the process without restoring sys.argv.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "209af17a340a",
      "status": "resolved",
      "resolution": "SystemExit handled with argv cleanup",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_backfill.py",
      "category": "LOGIC_ERRORS",
      "line": 25,
      "description": "Truthiness checks for numeric arguments (limit, workers) mean a value of 0 is treated as not provided and will not be forwarded (also applies to line 27).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "62449f53d0f8",
      "status": "resolved",
      "resolution": "numeric args forwarded when zero",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_backfill.py",
      "category": "STYLE",
      "line": 22,
      "description": "Mutating global sys.argv to pass arguments to another module is brittle, side-effect prone, and not thread-safe.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5d2340b8d5bd",
      "status": "resolved",
      "resolution": "backfill uses explicit argv list",
      "validation_method": "style_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_backfill.py",
      "category": "STYLE",
      "line": 40,
      "description": "Type hint uses private argparse._SubParsersAction, coupling to a non-public API that may change between Python versions.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e3445b80e629",
      "status": "resolved",
      "resolution": "parser type hint avoids private API",
      "validation_method": "style_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_backfill.py",
      "category": "STYLE",
      "line": 32,
      "description": "Error messages are printed to stdout using print; errors should typically go to stderr (also applies to line 35).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1e7d54799e94",
      "status": "resolved",
      "resolution": "errors routed to stderr",
      "validation_method": "stderr_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_backfill.py",
      "category": "NULL_SAFETY",
      "line": 23,
      "description": "Assumes args has attributes tenant_id, limit, and workers; if backfill_summaries is invoked with a different parser configuration, AttributeError can occur (also applies to lines 25 and 27).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "86df5d59a72f",
      "status": "resolved",
      "resolution": "args accessed via getattr defaults",
      "validation_method": "null_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_pipeline.py",
      "category": "STYLE",
      "line": 14,
      "description": "Declared logger is never used (dead code).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1e953a7621d8",
      "status": "resolved",
      "resolution": "logger used for pipeline errors",
      "validation_method": "style_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_pipeline.py",
      "category": "LOGIC_ERRORS",
      "line": 35,
      "description": "Using logging.basicConfig inside this function can be a no-op if logging was configured earlier; the --verbose flag may not take effect, leading to surprising behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f81fde8a8990",
      "status": "resolved",
      "resolution": "logging config forced per run",
      "validation_method": "logging_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_pipeline.py",
      "category": "EXCEPTION_HANDLING",
      "line": 31,
      "description": "Lazy import of PipelineOrchestrator is unguarded; ImportError or other import-time errors will crash the CLI without a user-friendly message.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "427237becac1",
      "status": "resolved",
      "resolution": "import errors handled",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_pipeline.py",
      "category": "EXCEPTION_HANDLING",
      "line": 59,
      "description": "orchestrator.run(...) is unguarded; any exception raised will terminate the process and produce an unhandled stack trace.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9607949d637f",
      "status": "resolved",
      "resolution": "run errors handled",
      "validation_method": "exception_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_pipeline.py",
      "category": "LOGIC_ERRORS",
      "line": 48,
      "description": "UI states that --auto-embed is ignored in dry-run mode, but the code still passes auto_embed to the orchestrator (lines 51\u201356), creating a mismatch between messaging and actual behavior if the orchestrator does not itself ignore it.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5d296a51f49d",
      "status": "resolved",
      "resolution": "auto_embed disabled in dry-run",
      "validation_method": "logic_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_pipeline.py",
      "category": "LOGIC_ERRORS",
      "line": 21,
      "description": "No validation of 'concurrency' (and 'limit'); zero or negative values could cause downstream errors or undefined behavior in the orchestrator.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8ebdaab2cfc7",
      "status": "resolved",
      "resolution": "input validation added",
      "validation_method": "validation_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_pipeline.py",
      "category": "NULL_SAFETY",
      "line": 68,
      "description": "Assumes 'stats' is non-null and has attributes (duration_seconds, folders_found, folders_processed, folders_failed); if orchestrator.run returns None or a different shape, attribute access will raise.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6562cdd21c99",
      "status": "resolved",
      "resolution": "stats None guard added",
      "validation_method": "null_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_pipeline.py",
      "category": "TYPE_ERRORS",
      "line": 68,
      "description": "Formats stats.duration_seconds with '.2f', which will raise TypeError if the value is not a number.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "17cb6200db83",
      "status": "resolved",
      "resolution": "duration coerced safely",
      "validation_method": "typing_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_pipeline.py",
      "category": "TYPE_ERRORS",
      "line": 96,
      "description": "json.dumps(output) may fail if stats.errors_list contains non-JSON-serializable objects (e.g., Exception instances), since no conversion is performed.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4ea3fc4cf8b9",
      "status": "resolved",
      "resolution": "json serialization guarded",
      "validation_method": "serialization_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_pipeline.py",
      "category": "TYPE_ERRORS",
      "line": 20,
      "description": "Uses PEP 604 union type syntax (int | None) which requires Python 3.10+; this will be a syntax error on older supported Python versions, if any.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3ec5725f2fef",
      "status": "resolved",
      "resolution": "runtime supports PEP 604 unions",
      "validation_method": "runtime_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_embeddings.py",
      "category": "NULL_SAFETY",
      "line": 94,
      "description": "Unconditional access to config.embedding.model_name; if embedding config is missing or None, this will raise AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "20cbf983d530",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_embeddings.py",
      "category": "LOGIC_ERRORS",
      "line": 32,
      "description": "When no embedding configuration is found, the function prints an error and returns normally (exit code 0), which can incorrectly signal success to callers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "373003ad9007",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_embeddings.py",
      "category": "EXCEPTION_HANDLING",
      "line": 80,
      "description": "Overly broad except Exception captures all errors, obscuring the root cause and losing stack traces; it also mixes all failure modes into a generic message.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5a48b2f930d9",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_embeddings.py",
      "category": "EXCEPTION_HANDLING",
      "line": 116,
      "description": "Overly broad except Exception in backfill command swallows specific errors and exits without providing detailed diagnostics.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "eb7d0c872678",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_embeddings.py",
      "category": "EXCEPTION_HANDLING",
      "line": 81,
      "description": "Error messages are printed to stdout instead of stderr, which can interfere with scripting/piping and standard CLI conventions.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "25dffc1aa2d8",
      "status": "resolved",
      "resolution": "errors routed to stderr",
      "validation_method": "stderr_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_embeddings.py",
      "category": "EXCEPTION_HANDLING",
      "line": 113,
      "description": "ImportError message in backfill command is printed to stdout instead of stderr, mixing error output with standard output.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3c5d64ad6d43",
      "status": "resolved",
      "resolution": "errors routed to stderr",
      "validation_method": "stderr_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_embeddings.py",
      "category": "EXCEPTION_HANDLING",
      "line": 117,
      "description": "Generic error message in backfill command is printed to stdout instead of stderr, making error handling by callers harder.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "230bd513bedc",
      "status": "resolved",
      "resolution": "errors routed to stderr",
      "validation_method": "stderr_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_embeddings.py",
      "category": "TYPE_ERRORS",
      "line": 109,
      "description": "Assumes backfill_embeddings returns a dict; using result.get(...) will fail if it returns None or a non-mapping type.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "108968e1c1c1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_embeddings.py",
      "category": "LOGIC_ERRORS",
      "line": 149,
      "description": "No validation for --batch-size; zero or negative values are accepted and may cause downstream errors or undefined behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "deda03c4b14e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_embeddings.py",
      "category": "LOGIC_ERRORS",
      "line": 155,
      "description": "No validation for --limit; negative values are accepted and may cause unexpected behavior in backfill logic.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "bdfb4cf4c8c6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_embeddings.py",
      "category": "NULL_SAFETY",
      "line": 165,
      "description": "Default handler assumes args.embeddings_command exists; if invoked programmatically with an incomplete Namespace, this may raise AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "72a965616af0",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_draft.py",
      "category": "STYLE",
      "line": 2,
      "description": "from __future__ import annotations is placed inside the module docstring, making it a no-op and causing a confusing, non-descriptive docstring that includes code.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d01a15f3e129",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_draft.py",
      "category": "TYPE_ERRORS",
      "line": 2,
      "description": "Because the future import is inside the docstring, annotations are evaluated at runtime instead of being postponed, which can cause runtime name resolution issues if forward references are added later.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "eac88f40e08d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_draft.py",
      "category": "STYLE",
      "line": 17,
      "description": "The type annotation uses argparse._SubParsersAction, a private/internal API (prefixed with underscore), which couples the code to argparse internals.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "41be826e2192",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_draft.py",
      "category": "LOGIC_ERRORS",
      "line": 36,
      "description": "os.getenv provides a default URL, so the subsequent emptiness check only triggers when the environment variable is set to an empty string; the error message 'environment variable not set' is misleading and the guard will not run when the variable is truly unset.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "39e4953e097f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_draft.py",
      "category": "TYPE_ERRORS",
      "line": 57,
      "description": "Assumes res.json() returns a dict; calling .get on response_data will raise if the server returns a non-object JSON (e.g., list/string), leading to an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b2c9d592c5aa",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_draft.py",
      "category": "EXCEPTION_HANDLING",
      "line": 57,
      "description": "Potential JSON decoding errors from res.json() (e.g., invalid JSON) are not specifically handled and will fall into the generic catch-all, obscuring the root cause.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9398ff290bea",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_draft.py",
      "category": "EXCEPTION_HANDLING",
      "line": 77,
      "description": "A broad except Exception swallows unexpected errors and only logs to the console, which can hide programming errors and results in a successful process exit code despite failure.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "364e2bb9b22d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_draft.py",
      "category": "SECURITY",
      "line": 74,
      "description": "Server-controlled e.response.text is interpolated into a Rich-marked string without escaping, allowing markup/ANSI injection that can manipulate terminal output formatting.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2104d94d69c8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_draft.py",
      "category": "STYLE",
      "line": 63,
      "description": "Local variable name 'syntax' shadows the imported class 'Syntax' within the same scope, reducing readability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "db8fee6dae17",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/style.py",
      "category": "TYPE_ERRORS",
      "line": 18,
      "description": "Function signature annotates text as str, but the implementation explicitly accepts None and normalizes it; the annotation does not reflect the actual accepted input type.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "59998d88b9e8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/style.py",
      "category": "TYPE_ERRORS",
      "line": 25,
      "description": "In early-return branches (non-TTY or unknown color), the function returns the original text without coercion; if callers pass a non-str (e.g., int), the return value may not be a str, violating the return type annotation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f71f9f0e83a9",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/style.py",
      "category": "TYPE_ERRORS",
      "line": 28,
      "description": "Returning the unmodified text for unknown colors can also return a non-str if the input was not a string, conflicting with the declared return type.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cb606089c4be",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/style.py",
      "category": "EXCEPTION_HANDLING",
      "line": 24,
      "description": "sys.stdout.isatty() is called without guarding against potential exceptions (e.g., ValueError if the stream is closed, or TypeError if isatty exists but is not callable on a replaced stream).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b26cb435159f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/style.py",
      "category": "EXCEPTION_HANDLING",
      "line": 29,
      "description": "Accessing COLORS['reset'] assumes the key always exists; since COLORS is a mutable global, a KeyError could occur if it's modified at runtime and is not handled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c4d448f6c23e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/style.py",
      "category": "STYLE",
      "line": 20,
      "description": "Inline comments like 'P2 Fix' are ticket/priority markers and are not appropriate for long-term code documentation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "80b895b7e92a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/style.py",
      "category": "STYLE",
      "line": 19,
      "description": "Docstring does not document special behaviors (e.g., None is converted to empty string, unknown colors return unmodified text), leading to an incomplete contract.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0cb049ed2c5f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_s3_uploader.py",
      "category": "LOGIC_ERRORS",
      "line": 72,
      "description": "Lazy initialization of the shared S3 client is not thread-safe; multiple threads can observe _s3_client as None and race to create and assign clients when used with ThreadPoolExecutor.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c0ee2869db45",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_s3_uploader.py",
      "category": "LOGIC_ERRORS",
      "line": 125,
      "description": "S3 key construction assumes s3_prefix is already normalized (e.g., includes any necessary trailing delimiter); simple string concatenation may produce incorrect keys depending on the provided prefix.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "42047d0d9a3b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_s3_uploader.py",
      "category": "EXCEPTION_HANDLING",
      "line": 124,
      "description": "Path.relative_to(source_dir) will raise ValueError if any file is not under source_dir; this occurs during task list construction and is not caught, causing the whole upload to fail before any per-file error handling runs.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ded875e3c2c2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_s3_uploader.py",
      "category": "EXCEPTION_HANDLING",
      "line": 145,
      "description": "Broad except Exception swallows all unexpected errors and returns only a short message, losing stack traces and error types, which can hinder debugging and obscure underlying failures.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c46cfcd27561",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_s3_uploader.py",
      "category": "EXCEPTION_HANDLING",
      "line": 66,
      "description": "No explicit cleanup/closure of the boto3 S3 client; in long-lived processes this can leave connection pools open longer than necessary.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "828e4d8393f1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_s3_uploader.py",
      "category": "SECURITY",
      "line": 143,
      "description": "Raw exception messages are surfaced directly to callers; these can leak internal details (paths, endpoint URLs, request IDs) that may be sensitive in certain environments.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "18175e600700",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_s3_uploader.py",
      "category": "PERFORMANCE",
      "line": 132,
      "description": "Combining a ThreadPoolExecutor for per-file uploads with boto3's upload_file (which itself uses a thread pool for multipart uploads) can cause thread proliferation and high resource usage.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f27c2e7b2522",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_s3_uploader.py",
      "category": "PERFORMANCE",
      "line": 133,
      "description": "All upload tasks are submitted at once and tracked in memory; with very large file lists this can increase memory consumption unnecessarily.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "09a15d893ba4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_s3_uploader.py",
      "category": "STYLE",
      "line": 8,
      "description": "Module docstring claims features (e.g., progress tracking with ETA, detailed summary reporting) that are not implemented in the code, leading to misleading documentation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "add2d15fbcc2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_s3_uploader.py",
      "category": "STYLE",
      "line": 31,
      "description": "Logger is defined but never used, indicating dead code or missing logging where it might be expected.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a729267915e8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_s3_uploader.py",
      "category": "TYPE_ERRORS",
      "line": 111,
      "description": "Public API uses list[Path] and tuple[...] type hints which require Python 3.9+; if the package targets older Python versions, these annotations will cause runtime syntax errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a68dc72ce4e7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_schema.py",
      "category": "STYLE",
      "line": 10,
      "description": "Calling load_dotenv('.env') at import time introduces side effects on import and can unexpectedly alter environment variables for any importer.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e3381a6a759d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_schema.py",
      "category": "STYLE",
      "line": 19,
      "description": "Global logging configuration via logging.basicConfig at import time can interfere with application-wide logging settings.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b8a00825a8f0",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_schema.py",
      "category": "TYPE_ERRORS",
      "line": 27,
      "description": "Assumes args has attribute 'limit'; calling cmd_schema_check programmatically without argparse-populated attributes will raise AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1ab454ff8207",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_schema.py",
      "category": "PERFORMANCE",
      "line": 34,
      "description": "ORDER BY func.random() is notoriously expensive on large tables and may trigger a full scan and sort to randomize rows.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "641afd36fca8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_schema.py",
      "category": "PERFORMANCE",
      "line": 40,
      "description": "N+1 query pattern: for each conversation ID, a separate query is executed to fetch chunks, causing multiple round-trips.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "03e0e10b1f88",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_schema.py",
      "category": "PERFORMANCE",
      "line": 39,
      "description": "Accumulates all conversation texts in memory before processing; can lead to elevated memory usage with large limits or long conversations.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "82fd0d753a40",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_schema.py",
      "category": "STYLE",
      "line": 32,
      "description": "Magic string 'message_body' is duplicated in queries (also at line 46), making the code brittle to schema or constant changes.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d99b83ed5e5b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_schema.py",
      "category": "EXCEPTION_HANDLING",
      "line": 29,
      "description": "Database operations within the session context lack explicit error handling; any execution or connectivity error will terminate the command abruptly.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "199b6cc09759",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_schema.py",
      "category": "EXCEPTION_HANDLING",
      "line": 69,
      "description": "Catches broad Exception and logs only the message, swallowing errors and losing stack trace/context, which hinders debugging.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "92a6bf5d3cab",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_schema.py",
      "category": "LOGIC_ERRORS",
      "line": 62,
      "description": "Progress log uses the requested limit as the denominator, which is misleading when fewer conversations are actually returned.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f02a52de7061",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_rechunk.py",
      "category": "EXCEPTION_HANDLING",
      "line": 42,
      "description": "run_rechunk is called without any error handling; any exception raised will bubble up and crash the CLI, skipping the summary output.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "92e47abe3616",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_rechunk.py",
      "category": "TYPE_ERRORS",
      "line": 30,
      "description": "Type annotation uses built-in generics dict[str, int], which requires Python 3.9+; without from __future__ import annotations this is incompatible with Python 3.8 and earlier.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2d777876d9c0",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_rechunk.py",
      "category": "NULL_SAFETY",
      "line": 54,
      "description": "Assumes results is a mapping; if run_rechunk returns None or a non-mapping, results.items() will raise an exception.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b326699ca1d5",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_rechunk.py",
      "category": "LOGIC_ERRORS",
      "line": 31,
      "description": "Defaulting total to 0 when it may be unknown leads to progress updates like 'Processed X/0' and can cause completed > total inconsistencies when updating at line 37.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "46d6f58bc6fd",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_rechunk.py",
      "category": "STYLE",
      "line": 27,
      "description": "Redundant initialization of results to an empty dict before immediately reassigning it inside the context manager.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "befdcefa367a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_rechunk.py",
      "category": "TYPE_ERRORS",
      "line": 34,
      "description": "Progress update assumes res['total'] and res['processed'] are integers; if non-numeric values are passed via the callback, rich.progress.update may raise a TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "448b88a4d338",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/api_client.py",
      "category": "LOGIC_ERRORS",
      "line": 43,
      "description": "Using a leading slash in the endpoint (\"/answer\") with httpx.Client(base_url=...) causes the base_url path (e.g., \"/api/v1\") to be discarded, likely resulting in requests to the wrong URL.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "83d3a52cfe4f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/api_client.py",
      "category": "LOGIC_ERRORS",
      "line": 48,
      "description": "Docstring claims get_api_client returns a singleton, but it creates a new ApiClient instance on each call; behavior contradicts the documentation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d31215f8e545",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/api_client.py",
      "category": "EXCEPTION_HANDLING",
      "line": 34,
      "description": "response.json() is not guarded; non-JSON or empty responses with 2xx status will raise a JSON decoding exception that is not caught.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "0b354599caca",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/api_client.py",
      "category": "EXCEPTION_HANDLING",
      "line": 26,
      "description": "httpx.Client is created but never closed; the class provides no cleanup, leading to potential resource leaks (sockets/file descriptors).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4c033f631e68",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/api_client.py",
      "category": "PERFORMANCE",
      "line": 49,
      "description": "get_api_client returns a new ApiClient (and thus a new httpx.Client) each call, preventing connection reuse and, combined with missing cleanup, may lead to connection pool proliferation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c7b994777e4b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/api_client.py",
      "category": "SECURITY",
      "line": 14,
      "description": "Default base URL uses HTTP (not HTTPS). If an Authorization header is set, credentials may be sent in cleartext by default, which is insecure.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9899b7294073",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/api_client.py",
      "category": "TYPE_ERRORS",
      "line": 29,
      "description": "post() is annotated to return dict[str, Any], but response.json() can return non-dict JSON (e.g., list or primitive), making the return type potentially incorrect.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1b294db97ec4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/api_client.py",
      "category": "TYPE_ERRORS",
      "line": 34,
      "description": "Use of \"# type: ignore\" on response.json() masks potential type issues instead of reflecting the actual possible return types.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "99bc41de4856",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_config_helpers.py",
      "category": "STYLE",
      "line": 9,
      "description": "Module-level variable '_config' is initialized but never used (dead code).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "57218a3f4552",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_config_helpers.py",
      "category": "PERFORMANCE",
      "line": 9,
      "description": "Eagerly calling get_config() at import time may be expensive and slows module import unnecessarily.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4906316646d2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_config_helpers.py",
      "category": "EXCEPTION_HANDLING",
      "line": 9,
      "description": "Calling get_config() at import time can raise exceptions (e.g., due to missing environment/files), which would break import of this helper module without handling.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "41e7f4b19d45",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_config_helpers.py",
      "category": "LOGIC_ERRORS",
      "line": 72,
      "description": "Section existence is determined by truthiness of the attribute; valid but falsey values (e.g., '', 0, [], False) will be treated as missing and trigger an erroneous 'Section not found' message.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "4d73f6467fc0",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_config_helpers.py",
      "category": "LOGIC_ERRORS",
      "line": 77,
      "description": "When a section attribute exists but lacks 'model_dump', the function produces no output for that section, leading to silent, confusing behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b259fcbb4c28",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_config_helpers.py",
      "category": "TYPE_ERRORS",
      "line": 35,
      "description": "Assumes 'config' has a 'model_dump()' method (Pydantic v2); if 'config' is a different type or version, this will raise AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "96880ebda151",
      "status": "resolved",
      "resolution": "config None guard added",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_config_helpers.py",
      "category": "NULL_SAFETY",
      "line": 35,
      "description": "No guard against 'config' being None before calling 'model_dump()', risking AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9bb423025aa9",
      "status": "resolved",
      "resolution": "config None guard added",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_config_helpers.py",
      "category": "LOGIC_ERRORS",
      "line": 37,
      "description": "_print_json_config checks 'section' against raw model_dump keys without using the human-to-internal mapping used elsewhere, likely causing 'Section not found' for valid human-readable section names.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2946e1c68819",
      "status": "resolved",
      "resolution": "config None guard added",
      "validation_method": "guard_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_config_helpers.py",
      "category": "NULL_SAFETY",
      "line": 92,
      "description": "Unprotected nested attribute access in _print_summary_sections (e.g., config.core.env, config.embedding.model_name) can raise AttributeError if any intermediate attribute is None or missing.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2350bfa2e78d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_config_helpers.py",
      "category": "LOGIC_ERRORS",
      "line": 19,
      "description": "If the INDEX_DIR environment variable is set to an empty string, Path('') resolves to the current working directory, likely not the intended index directory.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "1717baa2f0e6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/_config_helpers.py",
      "category": "STYLE",
      "line": 40,
      "description": "Error messages are printed to stdout instead of stderr, which is non-idiomatic for CLI tools.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "48773d40238f",
      "status": "resolved",
      "resolution": "errors routed to stderr",
      "validation_method": "stderr_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_test.py",
      "category": "EXCEPTION_HANDLING",
      "line": 49,
      "description": "Catching FileNotFoundError to report 'pytest not found' is incorrect for 'python -m pytest'; missing pytest will cause a non-zero exit (CalledProcessError), not FileNotFoundError, leading to misleading messaging.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5894e4a04039",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_test.py",
      "category": "STYLE",
      "line": 49,
      "description": "The FileNotFoundError branch is effectively dead/unreachable in normal scenarios since sys.executable will exist; this makes the error message path misleading and unused.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "58dfd705b69a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_test.py",
      "category": "LOGIC_ERRORS",
      "line": 46,
      "description": "On pytest failure, the code exits with status 1 regardless of pytest's actual exit code, losing granular return codes that callers may rely on.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3aab950eb6fb",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_test.py",
      "category": "NULL_SAFETY",
      "line": 42,
      "description": "Unguarded access to args.pytest_args; if run_tests is invoked outside the argparse setup or without that attribute, it can raise AttributeError/TypeError (e.g., if None) during list expansion.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "812cfd180369",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_test.py",
      "category": "EXCEPTION_HANDLING",
      "line": 43,
      "description": "KeyboardInterrupt during test execution is not handled, which will surface a stack trace instead of a clean CLI exit.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "67de3910b6d8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_test.py",
      "category": "TYPE_ERRORS",
      "line": 9,
      "description": "Parameter subparsers is typed as Any, reducing type safety for a public API; a more specific type (e.g., argparse._SubParsersAction) would prevent misuse.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5ee5c4ed9af6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_login.py",
      "category": "SECURITY",
      "line": 32,
      "description": "Accepting the password via command-line flags exposes credentials in shell history and process lists.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d6d0e2f7190d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_login.py",
      "category": "SECURITY",
      "line": 39,
      "description": "Default host uses HTTP, causing credentials and tokens to be sent in cleartext by default.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "68e2dbfe3b76",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_login.py",
      "category": "SECURITY",
      "line": 56,
      "description": "Access token is printed to stdout, risking leakage via logs, terminal history, or screen capture.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f3ada130c7ed",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_login.py",
      "category": "SECURITY",
      "line": 59,
      "description": "Printing raw server response text on authentication failure may disclose sensitive server details or untrusted content to the terminal.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "345479e1c691",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_login.py",
      "category": "EXCEPTION_HANDLING",
      "line": 54,
      "description": "Potential unhandled JSON decoding error if the response body is not valid JSON.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d2b4e6fda292",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_login.py",
      "category": "EXCEPTION_HANDLING",
      "line": 56,
      "description": "Potential KeyError if 'access_token' is missing from the response JSON.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8e0c7498f447",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_login.py",
      "category": "EXCEPTION_HANDLING",
      "line": 57,
      "description": "Errors are only printed and not translated into a non-zero process exit code, leading to successful exit on failure.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a4a88ea8d318",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_login.py",
      "category": "LOGIC_ERRORS",
      "line": 4,
      "description": "Documentation and help text claim the JWT is stored locally, but the implementation only prints the token and does not store it.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6ec811b67696",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_login.py",
      "category": "LOGIC_ERRORS",
      "line": 50,
      "description": "URL construction via simple string concatenation can result in double slashes if 'host' ends with a trailing slash.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "50adc6438b73",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_login.py",
      "category": "STYLE",
      "line": 14,
      "description": "Type hint uses argparse._SubParsersAction, a private/internal type that is not part of the public API and may change across versions.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7c376cfcbea7",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_queue.py",
      "category": "EXCEPTION_HANDLING",
      "line": 16,
      "description": "Potential unhandled exceptions from get_queue() (e.g., connection/configuration errors) can terminate the CLI without a user-friendly message.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7308c1a7bf5f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_queue.py",
      "category": "NULL_SAFETY",
      "line": 17,
      "description": "Assumes q is non-null; if get_queue() returns None, calling get_queue_stats() will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fe602ed6e983",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_queue.py",
      "category": "NULL_SAFETY",
      "line": 23,
      "description": "Assumes stats is a mapping; if get_queue_stats() returns None or a non-mapping, stats.items() will raise a TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d12b9407efa0",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_queue.py",
      "category": "TYPE_ERRORS",
      "line": 24,
      "description": "Assumes keys in stats are strings; calling replace/title on non-string keys will raise an AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "10615c14a574",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_queue.py",
      "category": "LOGIC_ERRORS",
      "line": 36,
      "description": "Subparsers for 'queue' are not required and no default handler is set; invoking 'queue' without a subcommand results in no action and no clear feedback.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "582d3c77cb79",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_queue.py",
      "category": "STYLE",
      "line": 14,
      "description": "Unused parameter 'args' in cmd_queue_stats; keeping unused parameters can reduce clarity.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "eb19a47acd14",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_queue.py",
      "category": "TYPE_ERRORS",
      "line": 29,
      "description": "setup_queue_parser uses a very broad type (Any) for subparsers; missing precise typing for a public function parameter makes misuse harder to detect.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "696b4b629b06",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_safety.py",
      "category": "LOGIC_ERRORS",
      "line": 13,
      "description": "Assumes a fixed directory depth with Path(__file__).resolve().parents[3]; can raise IndexError at import time if the path has fewer parents.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "86297b40222a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_safety.py",
      "category": "SECURITY",
      "line": 15,
      "description": "Modifying sys.path to add a computed project path can enable importing unintended code if that location is user-controlled or compromised, weakening import isolation.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e22344f497de",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_safety.py",
      "category": "EXCEPTION_HANDLING",
      "line": 18,
      "description": "Import of cortex.safety.grounding is unguarded; if the path injection fails or the module is missing, ImportError will crash at import time without a user-friendly message.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e7e032069c97",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_safety.py",
      "category": "EXCEPTION_HANDLING",
      "line": 28,
      "description": "Printing Unicode glyphs (e.g., '\u25b6', '\u23f3', '\u2713', '\u2717') may raise UnicodeEncodeError on terminals with incompatible encodings; these prints occur before the try/except, causing an unhandled crash.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b07fe9c162af",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_safety.py",
      "category": "STYLE",
      "line": 29,
      "description": "Always appends an ellipsis ('...') to the answer preview even when the answer is shorter than 80 characters, leading to misleading output.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "dd2d2e79d49c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_safety.py",
      "category": "STYLE",
      "line": 31,
      "description": "Missing space after the colon in 'LLM Mode:' results in awkward formatting (e.g., 'LLM Mode:Enabled').",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "97785496079a",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_safety.py",
      "category": "TYPE_ERRORS",
      "line": 53,
      "description": "Assumes result.confidence is a numeric value when formatting with ':.2%'; if None or non-numeric, this will raise a TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3add3e136032",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_safety.py",
      "category": "TYPE_ERRORS",
      "line": 54,
      "description": "Assumes result.grounding_ratio is a numeric value when formatting with ':.2%'; if None or non-numeric, this will raise a TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "81cd43b82cec",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_safety.py",
      "category": "EXCEPTION_HANDLING",
      "line": 63,
      "description": "Catches broad Exception and only prints str(e), which swallows stack traces and context, hindering diagnostics for unexpected failures.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "cfb9a718a382",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_safety.py",
      "category": "STYLE",
      "line": 72,
      "description": "Type hint uses private argparse._SubParsersAction, tying the code to an internal API that may change across Python versions.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "9b2d5346a619",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_grounding.py",
      "category": "STYLE",
      "line": 13,
      "description": "Unused import 'ClaimAnalysis'; the symbol is imported but never referenced in this file.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "208cec19536b",
      "status": "resolved",
      "resolution": "unused import removed",
      "validation_method": "ruff_f401",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_grounding.py",
      "category": "EXCEPTION_HANDLING",
      "line": 11,
      "description": "Catching ImportError around the top-level import can mask real errors raised during module import execution (e.g., ImportError thrown inside cortex.safety.grounding), leading to hard-to-diagnose failures.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "33e11534a962",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_grounding.py",
      "category": "SECURITY",
      "line": 22,
      "description": "Modifying sys.path at runtime to a computed repository-relative path can cause unexpected modules to be imported if the path contains untrusted code; this widens the import surface and may introduce code execution risks.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8218c0355b8c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_grounding.py",
      "category": "STYLE",
      "line": 30,
      "description": "Type annotation uses a private argparse type (argparse._SubParsersAction), which is not part of the public API and may change across Python versions.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "011da8a2a8d3",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_grounding.py",
      "category": "TYPE_ERRORS",
      "line": 37,
      "description": "Using 'required=True' with add_subparsers relies on Python/argparse versions that support it; on older versions this can raise a TypeError, reducing compatibility.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8b70b72c9e0f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_grounding.py",
      "category": "TYPE_ERRORS",
      "line": 79,
      "description": "Formats 'result.confidence' with ':.2f' assuming it is a number; if None or a non-numeric type is returned, this will raise a TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8788a3290010",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_grounding.py",
      "category": "TYPE_ERRORS",
      "line": 80,
      "description": "Formats 'result.grounding_ratio' with ':.2f' assuming it is a number; if None or a non-numeric type is returned, this will raise a TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "603aa85c8952",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_grounding.py",
      "category": "NULL_SAFETY",
      "line": 82,
      "description": "Accesses 'result.claim_analyses' and iterates without validating its type; if it is None or not iterable, this will raise at runtime.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a4561b071bb1",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_grounding.py",
      "category": "NULL_SAFETY",
      "line": 91,
      "description": "Assumes each item in 'result.claim_analyses' has attributes 'is_supported', 'claim', 'confidence', and 'supporting_fact'; missing attributes or None values can cause AttributeError/TypeError during table construction.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "d813fdd26190",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_grounding.py",
      "category": "EXCEPTION_HANDLING",
      "line": 108,
      "description": "Overly broad 'except Exception' swallows all errors and only prints the exception message, discarding stack traces and making debugging difficult.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "846884d48c7f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_grounding.py",
      "category": "EXCEPTION_HANDLING",
      "line": 104,
      "description": "Catching ImportError in the runtime logic block may misclassify errors arising from internal imports within 'tool_check_grounding' as missing dependencies, obscuring the true cause.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "73746405876d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_maintenance.py",
      "category": "NULL_SAFETY",
      "line": 17,
      "description": "Unconditional access to args.dry_run may raise AttributeError if the attribute is missing (e.g., when resolve_entities is called programmatically without the CLI parser).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "bdb22b0cfb80",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_maintenance.py",
      "category": "EXCEPTION_HANDLING",
      "line": 26,
      "description": "ImportError is caught for the entire try block, which can misclassify ImportError raised later (e.g., during resolver.run) as a failure to load the worker, producing a misleading error message.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "c4d45f6a2e80",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_maintenance.py",
      "category": "EXCEPTION_HANDLING",
      "line": 31,
      "description": "Overly broad except Exception catches all runtime errors, potentially masking programming errors and always exiting, reducing debuggability outside of printed traceback.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3185e5a441e0",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_maintenance.py",
      "category": "LOGIC_ERRORS",
      "line": 79,
      "description": "Unreachable code: multiple returns after a definitive return 0 in _default_maintenance_handler; the two subsequent return None statements will never execute.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "de0d3ad7a87d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_maintenance.py",
      "category": "STYLE",
      "line": 39,
      "description": "Dead code: _run_maintenance_resolve wrapper is defined but never used.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "20b02aa0c170",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_maintenance.py",
      "category": "TYPE_ERRORS",
      "line": 71,
      "description": "Inconsistent command handler return types: _default_maintenance_handler returns int while resolve_entities returns None; callers expecting a uniform signature may encounter type inconsistencies.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "76153c819df8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_maintenance.py",
      "category": "TYPE_ERRORS",
      "line": 45,
      "description": "Type annotation uses private argparse type 'argparse._SubParsersAction'; reliance on private types can be brittle and may not be recognized across versions/tools.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "11156c47820f",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_audit.py",
      "category": "EXCEPTION_HANDLING",
      "line": 31,
      "description": "datetime.fromisoformat(args.since) will raise ValueError on invalid or unsupported ISO8601 strings (e.g., timestamps with a trailing 'Z'), which is unhandled and will crash the CLI.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "fa0833c547a4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_audit.py",
      "category": "LOGIC_ERRORS",
      "line": 31,
      "description": "Naive timezone handling for --since: fromisoformat returns naive datetimes when no offset is provided; if the backend expects UTC or aware datetimes, results may be incorrect or inconsistent.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "656c0913fcd3",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_audit.py",
      "category": "PERFORMANCE",
      "line": 21,
      "description": "No upper bound or validation on --limit; very large values could trigger excessive data retrieval and memory usage depending on get_audit_log_cli behavior.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "bc9e9440cadb",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_audit.py",
      "category": "STYLE",
      "line": 14,
      "description": "Type annotation uses argparse._SubParsersAction, a private argparse API, which can reduce portability and future compatibility.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3936bcd7e5f8",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_audit.py",
      "category": "EXCEPTION_HANDLING",
      "line": 32,
      "description": "External call to get_audit_log_cli has no error handling; network/API or I/O errors will bubble up and likely produce an unhelpful stack trace for users.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b629e9af7eb0",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_graph.py",
      "category": "EXCEPTION_HANDLING",
      "line": 32,
      "description": "Broad 'except Exception' handler swallows all runtime errors and prints only the message, hiding stack traces and specific error types, which impedes debugging and observability.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a73a7b237184",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_graph.py",
      "category": "EXCEPTION_HANDLING",
      "line": 30,
      "description": "Error output is written to stdout rather than stderr, which can corrupt expected CLI output streams and break scripting/pipelines that rely on stderr for errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a14b05e7461e",
      "status": "resolved",
      "resolution": "errors routed to stderr",
      "validation_method": "stderr_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_graph.py",
      "category": "EXCEPTION_HANDLING",
      "line": 33,
      "description": "Generic error messages are printed to stdout instead of stderr, leading to the same stream-misuse issue for non-import exceptions.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "dfc5576fb57e",
      "status": "resolved",
      "resolution": "errors routed to stderr",
      "validation_method": "stderr_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_graph.py",
      "category": "LOGIC_ERRORS",
      "line": 64,
      "description": "No validation for '--sample-size' allows zero or negative values, which can cause downstream logic errors or undefined behavior in schema discovery.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3d441f5156ea",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_graph.py",
      "category": "STYLE",
      "line": 17,
      "description": "Duplicated default values for 'tenant_id' and 'sample_size' appear both in argparse defaults and in getattr fallbacks, increasing maintenance drift risk.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5fdadff0f15b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_graph.py",
      "category": "EXCEPTION_HANDLING",
      "line": 23,
      "description": "Printing Unicode symbols ('\u23f3', '\u2713') can raise UnicodeEncodeError on terminals without UTF-8 encoding, potentially causing unexpected termination.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "bc6e415eb952",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_graph.py",
      "category": "LOGIC_ERRORS",
      "line": 72,
      "description": "When invoked as 'graph' with no subcommand, the handler prints help but does not signal an error (non-zero exit), which can mislead automation expecting a parsing failure.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "7a3a831fb9fc",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_search.py",
      "category": "EXCEPTION_HANDLING",
      "line": 184,
      "description": "In the generic Exception handler, the JSON-output branch does not exit with a non-zero status, leading to a successful (0) exit code on error, which is inconsistent with other error paths and can mislead callers.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "e7ed4c90bc16",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_search.py",
      "category": "EXCEPTION_HANDLING",
      "line": 174,
      "description": "Catching json.JSONDecodeError when parsing e.response.json() may not handle httpx's JSON parsing failures (which can raise ValueError), causing unexpected fallthrough to the generic exception handler.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5a559765839d",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_search.py",
      "category": "EXCEPTION_HANDLING",
      "line": 173,
      "description": "Assumes the error response body is a JSON object by calling .get('detail'); if the JSON is not a dict (e.g., list or string), this raises AttributeError, which is not specifically handled.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2b51afc333fd",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_search.py",
      "category": "TYPE_ERRORS",
      "line": 104,
      "description": "Formats fusion_score/vector_score/lexical_score with numeric format specifiers (:.3f) without ensuring they are numbers; non-numeric values from the API would raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "898e85272120",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_search.py",
      "category": "TYPE_ERRORS",
      "line": 89,
      "description": "Slices content[:200] without guaranteeing content is a string; if the API returns a non-string (e.g., dict), slicing can raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "6c617dada0e4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_search.py",
      "category": "TYPE_ERRORS",
      "line": 91,
      "description": "Slices highlights[0][:200] assuming the first highlight is a string; non-string elements (or None) would raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a6a8cb7c7352",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_search.py",
      "category": "TYPE_ERRORS",
      "line": 119,
      "description": "Formats query_time_ms with .2f assuming a numeric value; if the API returns a string or non-numeric type, this will raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3edc7dbe29c4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_search.py",
      "category": "TYPE_ERRORS",
      "line": 84,
      "description": "Assumes data['results'] is a list and performs slicing results[:top_k]; if results is not a list (e.g., dict or None), this can raise TypeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5b552cce6eed",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_search.py",
      "category": "LOGIC_ERRORS",
      "line": 83,
      "description": "Displays 'Found {len(results)} result(s)' but only prints up to top_k items, potentially misleading users when there are more results than shown.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "5d3945fd47f0",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_search.py",
      "category": "STYLE",
      "line": 22,
      "description": "Uses argparse._SubParsersAction (a private type) in type hints; relying on private attributes is discouraged and may break with library updates.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "a181500f82ad",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_index.py",
      "category": "EXCEPTION_HANDLING",
      "line": 62,
      "description": "Catches all exceptions with a broad except, which can mask programming errors (including KeyboardInterrupt) and makes debugging difficult.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "564dd8382e48",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_index.py",
      "category": "EXCEPTION_HANDLING",
      "line": 63,
      "description": "Error messages are printed to stdout instead of stderr, which is inappropriate for CLI error reporting.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ebe2d292536b",
      "status": "resolved",
      "resolution": "errors routed to stderr",
      "validation_method": "stderr_check",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_index.py",
      "category": "NULL_SAFETY",
      "line": 30,
      "description": "Assumes get_index_info returns a mapping; calling info.get(...) will raise if info is None or not a dict.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "987d76464f57",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_index.py",
      "category": "NULL_SAFETY",
      "line": 31,
      "description": "If info['metadata'] is present but not a dict (and not the string \"unknown\"), subsequent metadata.get(...) calls will raise AttributeError.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "20246c51f201",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_index.py",
      "category": "NULL_SAFETY",
      "line": 48,
      "description": "Assumes info['dimensions'] is a dict; dimensions.get(...) will raise if the value is None or not a mapping.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "47f1d4f49cb6",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_index.py",
      "category": "STYLE",
      "line": 39,
      "description": "Inconsistent fallbacks for metadata fields: dimensions/actual_dimensions/num_documents default to None and are printed as the string 'None', which is user-unfriendly.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "bd4f960feb4e",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/cmd_index.py",
      "category": "STYLE",
      "line": 31,
      "description": "Uses a magic string sentinel ('unknown') for metadata state instead of a structured or explicit indicator, which can be brittle.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "b7e34775e005",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/indexing/utils.py",
      "category": "LOGIC_ERRORS",
      "line": 8,
      "description": "scrub_json_string removes the literal text sequence \"\\u0000\" rather than the actual null character (U+0000). This will fail to remove real null characters in parsed Python strings and may incorrectly strip legitimate backslash-u text.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "69ba02267b17",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/indexing/utils.py",
      "category": "LOGIC_ERRORS",
      "line": 17,
      "description": "Dict keys are not scrubbed; only values are processed. Null characters present in JSON object keys will be left intact, contradicting the stated goal of removing null characters from the JSON data.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2d1d33d72e18",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/operations/rechunk.py",
      "category": "LOGIC_ERRORS",
      "line": 38,
      "description": "Oversized detection uses character length (func.length) while re-chunking uses a token-based max_tokens, creating a units mismatch that can misclassify chunks as oversized or not.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "30a25aa492eb",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/operations/rechunk.py",
      "category": "LOGIC_ERRORS",
      "line": 79,
      "description": "chunks_deleted is incremented for each processed chunk even during dry_run and before a successful commit, leading to misleading counts.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "8a6f0e0b2716",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/operations/rechunk.py",
      "category": "LOGIC_ERRORS",
      "line": 90,
      "description": "new_chunks_created reflects the number of models produced (total_new) even in dry_run or if a later error causes a rollback, so it may report creations that never persisted.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2eed71d37007",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/operations/rechunk.py",
      "category": "LOGIC_ERRORS",
      "line": 78,
      "description": "Original chunk is deleted unconditionally (when not dry_run) even if chunk_text returns no replacements, risking data loss.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "57d01683a63c",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/operations/rechunk.py",
      "category": "NULL_SAFETY",
      "line": 68,
      "description": "Potential TypeError when computing char_start/char_end if bad_chunk.char_start is None (None + int).",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "f2667c8b2575",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/operations/rechunk.py",
      "category": "EXCEPTION_HANDLING",
      "line": 99,
      "description": "Re-raising with 'raise e' discards the original traceback; this hampers debugging and loses stack context.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ecd1959545d4",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/operations/rechunk.py",
      "category": "EXCEPTION_HANDLING",
      "line": 96,
      "description": "Error logging omits exc_info, so stack traces are not captured in logs, making post-mortem analysis difficult.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "234a3492fc4b",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/operations/rechunk.py",
      "category": "EXCEPTION_HANDLING",
      "line": 82,
      "description": "Exceptions from progress_callback are not isolated; a callback failure aborts the entire operation and triggers rollback.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "47154e2356e5",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/operations/rechunk.py",
      "category": "PERFORMANCE",
      "line": 42,
      "description": "Loads all oversized chunks into memory via .all(), which can cause high memory usage for large datasets; no batching/pagination.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "38ea0253e8d2",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/operations/rechunk.py",
      "category": "PERFORMANCE",
      "line": 38,
      "description": "Applying func.length to the text column prevents index usage and can force a full table scan on large tables.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "2d8843f0fa96",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/operations/rechunk.py",
      "category": "STYLE",
      "line": 54,
      "description": "Magic number 200 used for overlap_tokens without explanation or configuration, reducing readability and flexibility.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "ac14efbc3842",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/operations/rechunk.py",
      "category": "LOGIC_ERRORS",
      "line": 39,
      "description": "Truthiness check for tenant_id treats empty string as falsy, unintentionally skipping tenant scoping if an empty string is provided.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "42bdc14f56f9",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    },
    {
      "file": "cli/src/cortex_cli/operations/rechunk.py",
      "category": "LOGIC_ERRORS",
      "line": 67,
      "description": "All newly created chunks reuse bad_chunk.position, which may violate ordering/uniqueness expectations for position fields and lead to ambiguous ordering or constraint errors.",
      "language": "Python",
      "found_by": "openai-gpt-5",
      "issue_id": "3c517e477139",
      "status": "open",
      "resolution": null,
      "validation_method": "manual_review_required",
      "validated_at": "2025-12-31T04:46:10.132365"
    }
  ],
  "resolution_summary": {
    "validated_at": "2025-12-31T04:46:10.132365",
    "total_issues": 902,
    "resolved": 276,
    "open": 626
  }
}